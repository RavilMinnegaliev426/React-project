{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\n\nvar _dec, _class, _class2, _temp;\n\nimport React from 'react';\nimport isEqual from 'lodash.isequal';\nimport warning from 'warning';\nimport cn from 'classnames';\nimport { Link } from \"../../Link\";\nimport { locale } from \"../../../lib/locale/decorators\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { EditIcon } from \"../../../internal/icons/16px\";\nimport { LocaleContext } from \"../../../lib/locale\";\nimport { FiasLocaleHelper } from \"../locale\";\nimport { FiasExtraFields } from \"../types\";\nimport { FiasModal } from \"../FiasModal\";\nimport { FiasForm } from \"../Form/FiasForm\";\nimport { FiasAPI } from \"../api/FiasAPI\";\nimport { FiasAddress } from \"../models/FiasAddress\";\nimport { FiasLogger } from \"../logger/FiasLogger\";\nimport { jsStyles } from \"../Fias.styles\";\n\nfunction deepMerge(dst) {\n  for (var _len = arguments.length, src = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    src[_key - 1] = arguments[_key];\n  }\n\n  src.forEach(function (obj) {\n    for (var k in obj) {\n      if (dst[k] != null && typeof obj[k] === 'object') {\n        dst[k] = deepMerge(dst[k], obj[k]);\n      } else {\n        dst[k] = obj[k];\n      }\n    }\n  });\n  return dst;\n}\n/**\r\n   * @deprecated Контур-специфичный компонент, будет удален в 3.0.0, перенесен в `@skbkontur/react-ui-addons` смотри [миграцию](https://github.com/skbkontur/retail-ui/blob/master/packages/react-ui/MIGRATION.md)\r\n   */\n\n\nexport var Fias = (_dec = locale('Fias', FiasLocaleHelper), _dec(_class = (_temp = _class2 = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Fias, _React$Component);\n\n  function Fias(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.state = {\n      opened: false,\n      address: new FiasAddress(),\n      locale: FiasLocaleHelper.get(),\n      fieldsSettings: _this.fieldsSettings\n    };\n    _this.theme = void 0;\n    _this.api = _this.props.api || new FiasAPI(_this.props.baseUrl, _this.props.version);\n    _this.form = null;\n    _this.locale = void 0;\n\n    _this.componentDidMount = function () {\n      _this.updateLocale();\n\n      _this.init();\n    };\n\n    _this.componentDidUpdate = function (prevProps, prevState) {\n      if (!isEqual(prevProps.value, _this.props.value)) {\n        _this.updateAddress();\n      }\n\n      if (!isEqual(prevState.locale, _this.locale)) {\n        _this.updateLocale(_this.locale);\n      }\n\n      if (!isEqual(prevProps.fieldsSettings, _this.props.fieldsSettings)) {\n        _this.updateFieldsSettings();\n      }\n    };\n\n    _this.init = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var address;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _this.updateAddress();\n\n            case 2:\n              address = _context.sent;\n\n              if (_this.props.onInit) {\n                _this.props.onInit(address.getValue(_this.isFieldVisible(FiasExtraFields.postalcode)));\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    _this.updateAddress = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var address;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return FiasAddress.getAddress(_this.api, _this.props.value, _this.state.fieldsSettings);\n\n            case 2:\n              address = _context2.sent;\n\n              _this.setState({\n                address: address\n              });\n\n              return _context2.abrupt(\"return\", address);\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    _this.updateLocale = function (nextLocale) {\n      if (nextLocale === void 0) {\n        nextLocale = FiasLocaleHelper.get();\n      }\n\n      _this.setState({\n        locale: nextLocale\n      });\n    };\n\n    _this.updateFieldsSettings = function () {\n      _this.setState({\n        fieldsSettings: _this.fieldsSettings\n      });\n    };\n\n    _this.handleOpen = function () {\n      _this.setState({\n        opened: true\n      });\n    };\n\n    _this.handleClose = function () {\n      _this.setState({\n        opened: false\n      });\n\n      var onClose = _this.props.onClose;\n\n      if (onClose) {\n        onClose();\n      }\n    };\n\n    _this.handleSave = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var address;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!_this.form) {\n                _context3.next = 7;\n                break;\n              }\n\n              _context3.next = 3;\n              return _this.form.submit();\n\n            case 3:\n              address = _context3.sent;\n\n              if (!(address.hasErrors && _this.props.allowNotVerified === false)) {\n                _context3.next = 6;\n                break;\n              }\n\n              return _context3.abrupt(\"return\");\n\n            case 6:\n              _this.handleChange(address);\n\n            case 7:\n              _this.handleClose();\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    _this.handleChange = function (address) {\n      if (_this.props.onValueChange) {\n        _this.props.onValueChange(address.getValue(_this.isFieldVisible(FiasExtraFields.postalcode)));\n      }\n    };\n\n    _this.refForm = function (element) {\n      _this.form = element;\n    };\n\n    warning(true, \"Fias has been deprecated, use Fias from @skbkontur/react-ui-addons instead, see [migration](https://github.com/skbkontur/retail-ui/blob/master/packages/react-ui/MIGRATION.md)\");\n\n    if (!props.baseUrl && !props.api) {\n      FiasLogger.log(FiasLogger.warnings.baseUrlOrApiIsRequired);\n    }\n\n    return _this;\n  }\n\n  var _proto = Fias.prototype;\n\n  _proto.isFieldVisible = function isFieldVisible(field) {\n    return FiasAddress.isFieldVisible(field, this.state.fieldsSettings);\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var _cn;\n\n    var _this$props = this.props,\n        showAddressText = _this$props.showAddressText,\n        label = _this$props.label,\n        icon = _this$props.icon,\n        error = _this$props.error,\n        warning = _this$props.warning,\n        feedback = _this$props.feedback;\n    var _this$state = this.state,\n        opened = _this$state.opened,\n        address = _this$state.address;\n    var linkText = label || (address.isEmpty ? this.state.locale.addressFill : this.state.locale.addressEdit);\n    var validation = (error || warning) && feedback ? React.createElement(\"span\", {\n      className: cn((_cn = {}, _cn[jsStyles.error(this.theme)] = Boolean(error), _cn[jsStyles.warning(this.theme)] = Boolean(warning), _cn))\n    }, feedback) : null;\n    return React.createElement(LocaleContext.Provider, {\n      value: {\n        locale: {\n          Fias: this.state.locale\n        }\n      }\n    }, React.createElement(\"div\", null, showAddressText && React.createElement(\"span\", null, address.getFullText(this.isFieldVisible(FiasExtraFields.postalcode))), !this.props.readonly && React.createElement(\"div\", null, React.createElement(Link, {\n      icon: icon,\n      onClick: this.handleOpen\n    }, linkText)), validation, opened && this.renderModal()));\n  };\n\n  _proto.renderModal = function renderModal() {\n    var _this$state2 = this.state,\n        address = _this$state2.address,\n        fieldsSettings = _this$state2.fieldsSettings;\n    var _this$props2 = this.props,\n        search = _this$props2.search,\n        limit = _this$props2.limit,\n        formValidation = _this$props2.formValidation,\n        countrySelector = _this$props2.countrySelector;\n    return React.createElement(FiasModal, {\n      onClose: this.handleClose,\n      onSave: this.handleSave\n    }, React.createElement(FiasForm, {\n      ref: this.refForm,\n      address: address,\n      api: this.api,\n      search: search,\n      limit: limit,\n      validationLevel: formValidation,\n      fieldsSettings: fieldsSettings,\n      countrySelector: countrySelector\n    }));\n  };\n\n  _createClass(Fias, [{\n    key: \"fieldsSettings\",\n    get: function get() {\n      var _deepMerge;\n\n      var _this$props3 = this.props,\n          userSettings = _this$props3.fieldsSettings,\n          countrySelector = _this$props3.countrySelector; // TODO: implement deepMerge with clone\n\n      var defaultSettings = FiasAddress.ALL_FIELDS.reduce(function (settings, field) {\n        var _extends2;\n\n        return _extends({}, settings, (_extends2 = {}, _extends2[field] = {\n          visible: true\n        }, _extends2));\n      }, {});\n      return deepMerge(defaultSettings, (_deepMerge = {}, _deepMerge[FiasExtraFields.postalcode] = {\n        visible: Boolean(countrySelector)\n      }, _deepMerge), userSettings);\n    }\n  }]);\n\n  return Fias;\n}(React.Component), _class2.__KONTUR_REACT_UI__ = 'Fias', _class2.defaultProps = {\n  showAddressText: true,\n  error: false,\n  warning: false,\n  readonly: false,\n  search: false,\n  icon: React.createElement(EditIcon, null),\n  allowNotVerified: true,\n  fieldsSettings: {},\n  countrySelector: false\n}, _temp)) || _class);","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/components/Fias/Fias/Fias.js"],"names":["_extends","_regeneratorRuntime","_asyncToGenerator","_createClass","_inheritsLoose","_dec","_class","_class2","_temp","React","isEqual","warning","cn","Link","locale","ThemeContext","EditIcon","LocaleContext","FiasLocaleHelper","FiasExtraFields","FiasModal","FiasForm","FiasAPI","FiasAddress","FiasLogger","jsStyles","deepMerge","dst","_len","arguments","length","src","Array","_key","forEach","obj","k","Fias","_React$Component","props","_this","call","state","opened","address","get","fieldsSettings","theme","api","baseUrl","version","form","componentDidMount","updateLocale","init","componentDidUpdate","prevProps","prevState","value","updateAddress","updateFieldsSettings","mark","_callee","wrap","_callee$","_context","prev","next","sent","onInit","getValue","isFieldVisible","postalcode","stop","_callee2","_callee2$","_context2","getAddress","setState","abrupt","nextLocale","handleOpen","handleClose","onClose","handleSave","_callee3","_callee3$","_context3","submit","hasErrors","allowNotVerified","handleChange","onValueChange","refForm","element","log","warnings","baseUrlOrApiIsRequired","_proto","prototype","field","render","_this2","createElement","Consumer","renderMain","_cn","_this$props","showAddressText","label","icon","error","feedback","_this$state","linkText","isEmpty","addressFill","addressEdit","validation","className","Boolean","Provider","getFullText","readonly","onClick","renderModal","_this$state2","_this$props2","search","limit","formValidation","countrySelector","onSave","ref","validationLevel","key","_deepMerge","_this$props3","userSettings","defaultSettings","ALL_FIELDS","reduce","settings","_extends2","visible","Component","__KONTUR_REACT_UI__","defaultProps"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\n\nvar _dec, _class, _class2, _temp;\n\nimport React from 'react';\nimport isEqual from 'lodash.isequal';\nimport warning from 'warning';\nimport cn from 'classnames';\nimport { Link } from \"../../Link\";\nimport { locale } from \"../../../lib/locale/decorators\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { EditIcon } from \"../../../internal/icons/16px\";\nimport { LocaleContext } from \"../../../lib/locale\";\nimport { FiasLocaleHelper } from \"../locale\";\nimport { FiasExtraFields } from \"../types\";\nimport { FiasModal } from \"../FiasModal\";\nimport { FiasForm } from \"../Form/FiasForm\";\nimport { FiasAPI } from \"../api/FiasAPI\";\nimport { FiasAddress } from \"../models/FiasAddress\";\nimport { FiasLogger } from \"../logger/FiasLogger\";\nimport { jsStyles } from \"../Fias.styles\";\n\nfunction deepMerge(dst) {\n  for (var _len = arguments.length, src = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    src[_key - 1] = arguments[_key];\n  }\n\n  src.forEach(function (obj) {\n    for (var k in obj) {\n      if (dst[k] != null && typeof obj[k] === 'object') {\n        dst[k] = deepMerge(dst[k], obj[k]);\n      } else {\n        dst[k] = obj[k];\n      }\n    }\n  });\n  return dst;\n}\n/**\r\n   * @deprecated Контур-специфичный компонент, будет удален в 3.0.0, перенесен в `@skbkontur/react-ui-addons` смотри [миграцию](https://github.com/skbkontur/retail-ui/blob/master/packages/react-ui/MIGRATION.md)\r\n   */\n\n\nexport var Fias = (_dec = locale('Fias', FiasLocaleHelper), _dec(_class = (_temp = _class2 =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(Fias, _React$Component);\n\n  function Fias(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.state = {\n      opened: false,\n      address: new FiasAddress(),\n      locale: FiasLocaleHelper.get(),\n      fieldsSettings: _this.fieldsSettings\n    };\n    _this.theme = void 0;\n    _this.api = _this.props.api || new FiasAPI(_this.props.baseUrl, _this.props.version);\n    _this.form = null;\n    _this.locale = void 0;\n\n    _this.componentDidMount = function () {\n      _this.updateLocale();\n\n      _this.init();\n    };\n\n    _this.componentDidUpdate = function (prevProps, prevState) {\n      if (!isEqual(prevProps.value, _this.props.value)) {\n        _this.updateAddress();\n      }\n\n      if (!isEqual(prevState.locale, _this.locale)) {\n        _this.updateLocale(_this.locale);\n      }\n\n      if (!isEqual(prevProps.fieldsSettings, _this.props.fieldsSettings)) {\n        _this.updateFieldsSettings();\n      }\n    };\n\n    _this.init =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var address;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _this.updateAddress();\n\n            case 2:\n              address = _context.sent;\n\n              if (_this.props.onInit) {\n                _this.props.onInit(address.getValue(_this.isFieldVisible(FiasExtraFields.postalcode)));\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    _this.updateAddress =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var address;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return FiasAddress.getAddress(_this.api, _this.props.value, _this.state.fieldsSettings);\n\n            case 2:\n              address = _context2.sent;\n\n              _this.setState({\n                address: address\n              });\n\n              return _context2.abrupt(\"return\", address);\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    _this.updateLocale = function (nextLocale) {\n      if (nextLocale === void 0) {\n        nextLocale = FiasLocaleHelper.get();\n      }\n\n      _this.setState({\n        locale: nextLocale\n      });\n    };\n\n    _this.updateFieldsSettings = function () {\n      _this.setState({\n        fieldsSettings: _this.fieldsSettings\n      });\n    };\n\n    _this.handleOpen = function () {\n      _this.setState({\n        opened: true\n      });\n    };\n\n    _this.handleClose = function () {\n      _this.setState({\n        opened: false\n      });\n\n      var onClose = _this.props.onClose;\n\n      if (onClose) {\n        onClose();\n      }\n    };\n\n    _this.handleSave =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      var address;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!_this.form) {\n                _context3.next = 7;\n                break;\n              }\n\n              _context3.next = 3;\n              return _this.form.submit();\n\n            case 3:\n              address = _context3.sent;\n\n              if (!(address.hasErrors && _this.props.allowNotVerified === false)) {\n                _context3.next = 6;\n                break;\n              }\n\n              return _context3.abrupt(\"return\");\n\n            case 6:\n              _this.handleChange(address);\n\n            case 7:\n              _this.handleClose();\n\n            case 8:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    _this.handleChange = function (address) {\n      if (_this.props.onValueChange) {\n        _this.props.onValueChange(address.getValue(_this.isFieldVisible(FiasExtraFields.postalcode)));\n      }\n    };\n\n    _this.refForm = function (element) {\n      _this.form = element;\n    };\n\n    warning(true, \"Fias has been deprecated, use Fias from @skbkontur/react-ui-addons instead, see [migration](https://github.com/skbkontur/retail-ui/blob/master/packages/react-ui/MIGRATION.md)\");\n\n    if (!props.baseUrl && !props.api) {\n      FiasLogger.log(FiasLogger.warnings.baseUrlOrApiIsRequired);\n    }\n\n    return _this;\n  }\n\n  var _proto = Fias.prototype;\n\n  _proto.isFieldVisible = function isFieldVisible(field) {\n    return FiasAddress.isFieldVisible(field, this.state.fieldsSettings);\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var _cn;\n\n    var _this$props = this.props,\n        showAddressText = _this$props.showAddressText,\n        label = _this$props.label,\n        icon = _this$props.icon,\n        error = _this$props.error,\n        warning = _this$props.warning,\n        feedback = _this$props.feedback;\n    var _this$state = this.state,\n        opened = _this$state.opened,\n        address = _this$state.address;\n    var linkText = label || (address.isEmpty ? this.state.locale.addressFill : this.state.locale.addressEdit);\n    var validation = (error || warning) && feedback ? React.createElement(\"span\", {\n      className: cn((_cn = {}, _cn[jsStyles.error(this.theme)] = Boolean(error), _cn[jsStyles.warning(this.theme)] = Boolean(warning), _cn))\n    }, feedback) : null;\n    return React.createElement(LocaleContext.Provider, {\n      value: {\n        locale: {\n          Fias: this.state.locale\n        }\n      }\n    }, React.createElement(\"div\", null, showAddressText && React.createElement(\"span\", null, address.getFullText(this.isFieldVisible(FiasExtraFields.postalcode))), !this.props.readonly && React.createElement(\"div\", null, React.createElement(Link, {\n      icon: icon,\n      onClick: this.handleOpen\n    }, linkText)), validation, opened && this.renderModal()));\n  };\n\n  _proto.renderModal = function renderModal() {\n    var _this$state2 = this.state,\n        address = _this$state2.address,\n        fieldsSettings = _this$state2.fieldsSettings;\n    var _this$props2 = this.props,\n        search = _this$props2.search,\n        limit = _this$props2.limit,\n        formValidation = _this$props2.formValidation,\n        countrySelector = _this$props2.countrySelector;\n    return React.createElement(FiasModal, {\n      onClose: this.handleClose,\n      onSave: this.handleSave\n    }, React.createElement(FiasForm, {\n      ref: this.refForm,\n      address: address,\n      api: this.api,\n      search: search,\n      limit: limit,\n      validationLevel: formValidation,\n      fieldsSettings: fieldsSettings,\n      countrySelector: countrySelector\n    }));\n  };\n\n  _createClass(Fias, [{\n    key: \"fieldsSettings\",\n    get: function get() {\n      var _deepMerge;\n\n      var _this$props3 = this.props,\n          userSettings = _this$props3.fieldsSettings,\n          countrySelector = _this$props3.countrySelector; // TODO: implement deepMerge with clone\n\n      var defaultSettings = FiasAddress.ALL_FIELDS.reduce(function (settings, field) {\n        var _extends2;\n\n        return _extends({}, settings, (_extends2 = {}, _extends2[field] = {\n          visible: true\n        }, _extends2));\n      }, {});\n      return deepMerge(defaultSettings, (_deepMerge = {}, _deepMerge[FiasExtraFields.postalcode] = {\n        visible: Boolean(countrySelector)\n      }, _deepMerge), userSettings);\n    }\n  }]);\n\n  return Fias;\n}(React.Component), _class2.__KONTUR_REACT_UI__ = 'Fias', _class2.defaultProps = {\n  showAddressText: true,\n  error: false,\n  warning: false,\n  readonly: false,\n  search: false,\n  icon: React.createElement(EditIcon, null),\n  allowNotVerified: true,\n  fieldsSettings: {},\n  countrySelector: false\n}, _temp)) || _class);"]},"metadata":{},"sourceType":"module"}