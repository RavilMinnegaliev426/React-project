{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport warning from 'warning';\nimport { Input } from \"../../Input\";\nimport { MAX_SAFE_DIGITS } from \"../constants\";\nimport { SelectionHelper } from \"../SelectionHelper\";\nimport { CurrencyHelper } from \"../CurrencyHelper\";\nimport { CurrencyInputHelper } from \"../CurrencyInputHelper\";\nimport { CURRENCY_INPUT_ACTIONS, extractAction } from \"../CurrencyInputKeyboardActions\";\n/**\r\n                                                                                         * Поле для денежных сумм (и других числовых значений).\r\n                                                                                         * Принимает любые свойства `Input`.\r\n                                                                                         *\r\n                                                                                         * Максимальная длина числа - **15 цифр** (с десятичным разделителем в любом месте).\r\n                                                                                         * <br/>\r\n                                                                                         * Если `fractionDigits=15`, то в целой части допускается **0**.\r\n                                                                                         */\n\nexport var CurrencyInput = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(CurrencyInput, _React$Component);\n\n  function CurrencyInput() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = _extends({}, _this.getState(_this.props.value, _this.props.fractionDigits, _this.props.hideTrailingZeros), {\n      focused: false\n    });\n    _this.input = void 0;\n    _this.tempSelectionForOnChange = SelectionHelper.fromPosition(0);\n\n    _this.focus = function () {\n      if (_this.input) {\n        _this.input.focus();\n      }\n    };\n\n    _this.blur = function () {\n      if (_this.input) {\n        _this.input.blur();\n      }\n    };\n\n    _this.handleMouseUp = function (event) {\n      var selection = getInputSelection(event.target);\n      var normilized = CurrencyInputHelper.normalizeSelection(_this.state.formatted, selection);\n\n      _this.setState({\n        selection: normilized\n      });\n    };\n\n    _this.handleKeyDown = function (event) {\n      var selection = _this.getSelection(event.target);\n\n      _this.tempSelectionForOnChange = selection;\n\n      if (_this.props.onKeyDown) {\n        _this.props.onKeyDown(event);\n\n        if (event.defaultPrevented) {\n          return;\n        }\n      }\n\n      var action = extractAction(event);\n\n      if (action === CURRENCY_INPUT_ACTIONS.Ignore) {\n        return;\n      }\n\n      if (action !== CURRENCY_INPUT_ACTIONS.Unknown) {\n        event.preventDefault();\n      }\n\n      switch (action) {\n        case CURRENCY_INPUT_ACTIONS.Submit:\n          {\n            if (_this.props.onSubmit) {\n              _this.props.onSubmit();\n            }\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.Backspace:\n          {\n            _this.inputValue(CurrencyInputHelper.moveCursor(_this.state.formatted, selection, -1), selection.end, '');\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.Delete:\n          {\n            _this.inputValue(selection.start, CurrencyInputHelper.moveCursor(_this.state.formatted, selection, +1), '');\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.MoveCursorLeft:\n          {\n            _this.moveCursor(selection, -1);\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.MoveCursorRight:\n          {\n            _this.moveCursor(selection, +1);\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.Home:\n          {\n            _this.setState({\n              selection: SelectionHelper.fromPosition(0)\n            });\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.End:\n          {\n            var end = _this.state.formatted.length;\n\n            _this.setState({\n              selection: SelectionHelper.fromPosition(end)\n            });\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.ExtendSelectionLeft:\n          {\n            _this.extendSelection(selection, -1);\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.ExtendSelectionRight:\n          {\n            _this.extendSelection(selection, +1);\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.FullSelection:\n          {\n            _this.setState({\n              selection: SelectionHelper.forward(0, _this.state.formatted.length)\n            });\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.ExtendSelectionToStart:\n          {\n            _this.setState({\n              selection: SelectionHelper.backward(0, selection.start)\n            });\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.ExtendSelectionToEnd:\n          {\n            var inputEnd = _this.state.formatted.length;\n\n            _this.setState({\n              selection: SelectionHelper.forward(selection.start, inputEnd)\n            });\n\n            return;\n          }\n      }\n    };\n\n    _this.getSelection = function (input) {\n      var selection = getInputSelection(input);\n      return {\n        start: selection.start,\n        end: selection.end,\n        direction: _this.state.selection.direction\n      };\n    };\n\n    _this.moveCursor = function (selection, step) {\n      var position = CurrencyInputHelper.moveCursor(_this.state.formatted, selection, step);\n\n      _this.setState({\n        selection: SelectionHelper.fromPosition(position)\n      });\n    };\n\n    _this.extendSelection = function (selection, step) {\n      var extended = CurrencyInputHelper.extendSelection(_this.state.formatted, selection, step);\n\n      _this.setState({\n        selection: extended\n      });\n    };\n\n    _this.inputValue = function (start, end, value) {\n      var result = CurrencyInputHelper.safeInsert(_this.state.formatted, start, end, value, {\n        integerDigits: _this.props.integerDigits,\n        fractionDigits: _this.props.fractionDigits,\n        unsigned: !_this.props.signed\n      });\n\n      if (result) {\n        var formatted = result.value;\n        var selection = SelectionHelper.fromPosition(result.position);\n\n        _this.setState({\n          formatted: formatted,\n          selection: selection\n        }, function () {\n          var parsedValue = CurrencyHelper.parse(formatted);\n\n          if (_this.props.value !== parsedValue) {\n            _this.props.onValueChange(parsedValue);\n          }\n        });\n\n        return true;\n      }\n\n      if (_this.input) {\n        _this.input.blink();\n      }\n\n      return false;\n    };\n\n    _this.getOnChangeDelta = function (value) {\n      var selection = _this.tempSelectionForOnChange;\n      var oldValue = _this.state.formatted;\n\n      if (selection.start !== selection.end) {\n        return value.substring(selection.start, value.length - (oldValue.length - selection.end));\n      } else if (value.length > oldValue.length) {\n        return value.substr(selection.start, value.length - oldValue.length);\n      }\n\n      return null;\n    };\n\n    _this.handleValueChange = function (value) {\n      var selection = _this.tempSelectionForOnChange;\n\n      var delta = _this.getOnChangeDelta(value);\n\n      if (delta != null && !_this.inputValue(selection.start, selection.end, delta)) {\n        _this.setState({\n          selection: selection\n        });\n      }\n    };\n\n    _this.handlePaste = function (event) {\n      var data = event.clipboardData.getData('text');\n\n      var selection = _this.getSelection(event.target);\n\n      _this.inputValue(selection.start, selection.end, data);\n\n      event.preventDefault();\n    };\n\n    _this.handleCopy = function (event) {\n      var selection = _this.getSelection(event.target);\n\n      if (selection.start !== selection.end) {\n        var substring = _this.state.formatted.substring(selection.start, selection.end);\n\n        var data = CurrencyHelper.formatForClipboard(substring);\n        event.clipboardData.setData('text', data);\n      }\n\n      event.preventDefault();\n    };\n\n    _this.handleCut = function (event) {\n      var selection = _this.getSelection(event.target);\n\n      if (selection.start !== selection.end) {\n        var substring = _this.state.formatted.substring(selection.start, selection.end);\n\n        var data = CurrencyHelper.formatForClipboard(substring);\n        event.clipboardData.setData('text', data);\n\n        _this.inputValue(selection.start, selection.end, '');\n      }\n\n      event.preventDefault();\n    };\n\n    _this.handleFocus = function (event) {\n      var _event$target = event.target,\n          selectionStart = _event$target.selectionStart,\n          selectionEnd = _event$target.selectionEnd,\n          selectionDirection = _event$target.selectionDirection;\n      var valueLenght = event.target.value.length;\n      var selection = {\n        start: selectionStart !== selectionEnd ? selectionStart || 0 : selectionStart || valueLenght,\n        end: selectionEnd !== selectionStart ? selectionEnd || 0 : selectionEnd || valueLenght,\n        direction: selectionDirection || 'none'\n      };\n\n      _this.setState({\n        focused: true,\n        selection: selection\n      });\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus(event);\n      }\n    };\n\n    _this.handleBlur = function (event) {\n      var value = CurrencyHelper.parse(_this.state.formatted);\n\n      _this.setState(_extends({}, _this.getState(value, _this.props.fractionDigits, _this.props.hideTrailingZeros), {\n        focused: false\n      }));\n\n      if (_this.props.onBlur) {\n        _this.props.onBlur(event);\n      }\n    };\n\n    _this.refInput = function (element) {\n      _this.input = element;\n    };\n\n    return _this;\n  }\n\n  var _proto = CurrencyInput.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var _this$props = this.props,\n        maxLength = _this$props.maxLength,\n        integerDigits = _this$props.integerDigits,\n        fractionDigits = _this$props.fractionDigits;\n    warning(maxLength === undefined, \"[CurrencyInput]: Prop 'maxLength' has been deprecated. See 'integerDigits' and 'fractionDigits'\");\n    warning((integerDigits || 0) + (fractionDigits || 0) <= MAX_SAFE_DIGITS, \"[CurrencyInput]: Sum of 'integerDigits' and 'fractionDigits' exceeds \" + MAX_SAFE_DIGITS + \".\" + \"\\nSee https://tech.skbkontur.ru/react-ui/#/CurrencyInput?id=why15\");\n  };\n\n  _proto.UNSAFE_componentWillReceiveProps = function UNSAFE_componentWillReceiveProps(nextProps) {\n    var value = nextProps.value,\n        fractionDigits = nextProps.fractionDigits,\n        hideTrailingZeros = nextProps.hideTrailingZeros;\n\n    if (value !== CurrencyHelper.parse(this.state.formatted) || fractionDigits !== this.props.fractionDigits) {\n      var state = this.getState(value, fractionDigits, hideTrailingZeros);\n      this.setState(state);\n    }\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate() {\n    if (this.state.focused && this.input) {\n      var _this$state$selection = this.state.selection,\n          start = _this$state$selection.start,\n          end = _this$state$selection.end;\n      this.input.setSelectionRange(start, end);\n    }\n  };\n\n  _proto.render = function render() {\n    var _this$props2 = this.props,\n        fractionDigits = _this$props2.fractionDigits,\n        signed = _this$props2.signed,\n        onSubmit = _this$props2.onSubmit,\n        integerDigits = _this$props2.integerDigits,\n        hideTrailingZeros = _this$props2.hideTrailingZeros,\n        rest = _objectWithoutPropertiesLoose(_this$props2, [\"fractionDigits\", \"signed\", \"onSubmit\", \"integerDigits\", \"hideTrailingZeros\"]);\n\n    var placeholder = this.props.placeholder == null ? CurrencyHelper.format(0, {\n      fractionDigits: fractionDigits,\n      hideTrailingZeros: hideTrailingZeros\n    }) : this.props.placeholder;\n    return React.createElement(Input, _extends({}, rest, {\n      value: this.state.formatted,\n      onBlur: this.handleBlur,\n      onFocus: this.handleFocus,\n      onMouseUp: this.handleMouseUp,\n      onKeyDown: this.handleKeyDown,\n      onValueChange: this.handleValueChange,\n      onPaste: this.handlePaste,\n      onCopy: this.handleCopy,\n      onCut: this.handleCut,\n      onMouseEnter: this.props.onMouseEnter,\n      onMouseLeave: this.props.onMouseLeave,\n      onMouseOver: this.props.onMouseOver,\n      ref: this.refInput,\n      placeholder: this.state.focused ? '' : placeholder\n    }));\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.getState = function getState(value, fractionDigits, hideTrailingZeros) {\n    return {\n      formatted: CurrencyHelper.format(value, {\n        fractionDigits: fractionDigits,\n        hideTrailingZeros: hideTrailingZeros\n      }),\n      selection: SelectionHelper.fromPosition(0)\n    };\n  };\n\n  return CurrencyInput;\n}(React.Component);\nCurrencyInput.__KONTUR_REACT_UI__ = 'CurrencyInput';\nCurrencyInput.propTypes = {\n  align: PropTypes.oneOf(['left', 'center', 'right']),\n  autoFocus: PropTypes.bool,\n  borderless: PropTypes.bool,\n  disabled: PropTypes.bool,\n  error: PropTypes.bool,\n  fractionDigits: PropTypes.number,\n  hideTrailingZeros: PropTypes.bool,\n  leftIcon: PropTypes.element,\n  placeholder: PropTypes.string,\n  signed: PropTypes.bool,\n  size: PropTypes.oneOf(['small', 'medium', 'large']),\n  value: PropTypes.number,\n  warning: PropTypes.bool,\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  onBlur: PropTypes.func,\n  onValueChange: PropTypes.func.isRequired,\n  onFocus: PropTypes.func,\n  onMouseEnter: PropTypes.func,\n  onMouseLeave: PropTypes.func,\n  onMouseOver: PropTypes.func,\n  onSubmit: PropTypes.func\n};\nCurrencyInput.defaultProps = {\n  align: 'right',\n  fractionDigits: 2,\n  hideTrailingZeros: false,\n  value: null\n};\n\nfunction getInputSelection(input) {\n  if (!(input instanceof HTMLInputElement)) {\n    throw new Error('input is not HTMLInputElement');\n  }\n\n  return {\n    start: input.selectionStart,\n    end: input.selectionEnd,\n    direction: input.selectionDirection\n  };\n}","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/components/CurrencyInput/CurrencyInput/CurrencyInput.js"],"names":["_objectWithoutPropertiesLoose","_extends","_inheritsLoose","React","PropTypes","warning","Input","MAX_SAFE_DIGITS","SelectionHelper","CurrencyHelper","CurrencyInputHelper","CURRENCY_INPUT_ACTIONS","extractAction","CurrencyInput","_React$Component","_this","_len","arguments","length","args","Array","_key","call","apply","concat","state","getState","props","value","fractionDigits","hideTrailingZeros","focused","input","tempSelectionForOnChange","fromPosition","focus","blur","handleMouseUp","event","selection","getInputSelection","target","normilized","normalizeSelection","formatted","setState","handleKeyDown","getSelection","onKeyDown","defaultPrevented","action","Ignore","Unknown","preventDefault","Submit","onSubmit","Backspace","inputValue","moveCursor","end","Delete","start","MoveCursorLeft","MoveCursorRight","Home","End","ExtendSelectionLeft","extendSelection","ExtendSelectionRight","FullSelection","forward","ExtendSelectionToStart","backward","ExtendSelectionToEnd","inputEnd","direction","step","position","extended","result","safeInsert","integerDigits","unsigned","signed","parsedValue","parse","onValueChange","blink","getOnChangeDelta","oldValue","substring","substr","handleValueChange","delta","handlePaste","data","clipboardData","getData","handleCopy","formatForClipboard","setData","handleCut","handleFocus","_event$target","selectionStart","selectionEnd","selectionDirection","valueLenght","onFocus","handleBlur","onBlur","refInput","element","_proto","prototype","componentDidMount","_this$props","maxLength","undefined","UNSAFE_componentWillReceiveProps","nextProps","componentDidUpdate","_this$state$selection","setSelectionRange","render","_this$props2","rest","placeholder","format","createElement","onMouseUp","onPaste","onCopy","onCut","onMouseEnter","onMouseLeave","onMouseOver","ref","Component","__KONTUR_REACT_UI__","propTypes","align","oneOf","autoFocus","bool","borderless","disabled","error","number","leftIcon","string","size","width","oneOfType","func","isRequired","defaultProps","HTMLInputElement","Error"],"mappings":"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","sourcesContent":["import _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport warning from 'warning';\nimport { Input } from \"../../Input\";\nimport { MAX_SAFE_DIGITS } from \"../constants\";\nimport { SelectionHelper } from \"../SelectionHelper\";\nimport { CurrencyHelper } from \"../CurrencyHelper\";\nimport { CurrencyInputHelper } from \"../CurrencyInputHelper\";\nimport { CURRENCY_INPUT_ACTIONS, extractAction } from \"../CurrencyInputKeyboardActions\";\n/**\r\n                                                                                         * Поле для денежных сумм (и других числовых значений).\r\n                                                                                         * Принимает любые свойства `Input`.\r\n                                                                                         *\r\n                                                                                         * Максимальная длина числа - **15 цифр** (с десятичным разделителем в любом месте).\r\n                                                                                         * <br/>\r\n                                                                                         * Если `fractionDigits=15`, то в целой части допускается **0**.\r\n                                                                                         */\n\nexport var CurrencyInput =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(CurrencyInput, _React$Component);\n\n  function CurrencyInput() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = _extends({}, _this.getState(_this.props.value, _this.props.fractionDigits, _this.props.hideTrailingZeros), {\n      focused: false\n    });\n    _this.input = void 0;\n    _this.tempSelectionForOnChange = SelectionHelper.fromPosition(0);\n\n    _this.focus = function () {\n      if (_this.input) {\n        _this.input.focus();\n      }\n    };\n\n    _this.blur = function () {\n      if (_this.input) {\n        _this.input.blur();\n      }\n    };\n\n    _this.handleMouseUp = function (event) {\n      var selection = getInputSelection(event.target);\n      var normilized = CurrencyInputHelper.normalizeSelection(_this.state.formatted, selection);\n\n      _this.setState({\n        selection: normilized\n      });\n    };\n\n    _this.handleKeyDown = function (event) {\n      var selection = _this.getSelection(event.target);\n\n      _this.tempSelectionForOnChange = selection;\n\n      if (_this.props.onKeyDown) {\n        _this.props.onKeyDown(event);\n\n        if (event.defaultPrevented) {\n          return;\n        }\n      }\n\n      var action = extractAction(event);\n\n      if (action === CURRENCY_INPUT_ACTIONS.Ignore) {\n        return;\n      }\n\n      if (action !== CURRENCY_INPUT_ACTIONS.Unknown) {\n        event.preventDefault();\n      }\n\n      switch (action) {\n        case CURRENCY_INPUT_ACTIONS.Submit:\n          {\n            if (_this.props.onSubmit) {\n              _this.props.onSubmit();\n            }\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.Backspace:\n          {\n            _this.inputValue(CurrencyInputHelper.moveCursor(_this.state.formatted, selection, -1), selection.end, '');\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.Delete:\n          {\n            _this.inputValue(selection.start, CurrencyInputHelper.moveCursor(_this.state.formatted, selection, +1), '');\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.MoveCursorLeft:\n          {\n            _this.moveCursor(selection, -1);\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.MoveCursorRight:\n          {\n            _this.moveCursor(selection, +1);\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.Home:\n          {\n            _this.setState({\n              selection: SelectionHelper.fromPosition(0)\n            });\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.End:\n          {\n            var end = _this.state.formatted.length;\n\n            _this.setState({\n              selection: SelectionHelper.fromPosition(end)\n            });\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.ExtendSelectionLeft:\n          {\n            _this.extendSelection(selection, -1);\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.ExtendSelectionRight:\n          {\n            _this.extendSelection(selection, +1);\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.FullSelection:\n          {\n            _this.setState({\n              selection: SelectionHelper.forward(0, _this.state.formatted.length)\n            });\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.ExtendSelectionToStart:\n          {\n            _this.setState({\n              selection: SelectionHelper.backward(0, selection.start)\n            });\n\n            return;\n          }\n\n        case CURRENCY_INPUT_ACTIONS.ExtendSelectionToEnd:\n          {\n            var inputEnd = _this.state.formatted.length;\n\n            _this.setState({\n              selection: SelectionHelper.forward(selection.start, inputEnd)\n            });\n\n            return;\n          }\n      }\n    };\n\n    _this.getSelection = function (input) {\n      var selection = getInputSelection(input);\n      return {\n        start: selection.start,\n        end: selection.end,\n        direction: _this.state.selection.direction\n      };\n    };\n\n    _this.moveCursor = function (selection, step) {\n      var position = CurrencyInputHelper.moveCursor(_this.state.formatted, selection, step);\n\n      _this.setState({\n        selection: SelectionHelper.fromPosition(position)\n      });\n    };\n\n    _this.extendSelection = function (selection, step) {\n      var extended = CurrencyInputHelper.extendSelection(_this.state.formatted, selection, step);\n\n      _this.setState({\n        selection: extended\n      });\n    };\n\n    _this.inputValue = function (start, end, value) {\n      var result = CurrencyInputHelper.safeInsert(_this.state.formatted, start, end, value, {\n        integerDigits: _this.props.integerDigits,\n        fractionDigits: _this.props.fractionDigits,\n        unsigned: !_this.props.signed\n      });\n\n      if (result) {\n        var formatted = result.value;\n        var selection = SelectionHelper.fromPosition(result.position);\n\n        _this.setState({\n          formatted: formatted,\n          selection: selection\n        }, function () {\n          var parsedValue = CurrencyHelper.parse(formatted);\n\n          if (_this.props.value !== parsedValue) {\n            _this.props.onValueChange(parsedValue);\n          }\n        });\n\n        return true;\n      }\n\n      if (_this.input) {\n        _this.input.blink();\n      }\n\n      return false;\n    };\n\n    _this.getOnChangeDelta = function (value) {\n      var selection = _this.tempSelectionForOnChange;\n      var oldValue = _this.state.formatted;\n\n      if (selection.start !== selection.end) {\n        return value.substring(selection.start, value.length - (oldValue.length - selection.end));\n      } else if (value.length > oldValue.length) {\n        return value.substr(selection.start, value.length - oldValue.length);\n      }\n\n      return null;\n    };\n\n    _this.handleValueChange = function (value) {\n      var selection = _this.tempSelectionForOnChange;\n\n      var delta = _this.getOnChangeDelta(value);\n\n      if (delta != null && !_this.inputValue(selection.start, selection.end, delta)) {\n        _this.setState({\n          selection: selection\n        });\n      }\n    };\n\n    _this.handlePaste = function (event) {\n      var data = event.clipboardData.getData('text');\n\n      var selection = _this.getSelection(event.target);\n\n      _this.inputValue(selection.start, selection.end, data);\n\n      event.preventDefault();\n    };\n\n    _this.handleCopy = function (event) {\n      var selection = _this.getSelection(event.target);\n\n      if (selection.start !== selection.end) {\n        var substring = _this.state.formatted.substring(selection.start, selection.end);\n\n        var data = CurrencyHelper.formatForClipboard(substring);\n        event.clipboardData.setData('text', data);\n      }\n\n      event.preventDefault();\n    };\n\n    _this.handleCut = function (event) {\n      var selection = _this.getSelection(event.target);\n\n      if (selection.start !== selection.end) {\n        var substring = _this.state.formatted.substring(selection.start, selection.end);\n\n        var data = CurrencyHelper.formatForClipboard(substring);\n        event.clipboardData.setData('text', data);\n\n        _this.inputValue(selection.start, selection.end, '');\n      }\n\n      event.preventDefault();\n    };\n\n    _this.handleFocus = function (event) {\n      var _event$target = event.target,\n          selectionStart = _event$target.selectionStart,\n          selectionEnd = _event$target.selectionEnd,\n          selectionDirection = _event$target.selectionDirection;\n      var valueLenght = event.target.value.length;\n      var selection = {\n        start: selectionStart !== selectionEnd ? selectionStart || 0 : selectionStart || valueLenght,\n        end: selectionEnd !== selectionStart ? selectionEnd || 0 : selectionEnd || valueLenght,\n        direction: selectionDirection || 'none'\n      };\n\n      _this.setState({\n        focused: true,\n        selection: selection\n      });\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus(event);\n      }\n    };\n\n    _this.handleBlur = function (event) {\n      var value = CurrencyHelper.parse(_this.state.formatted);\n\n      _this.setState(_extends({}, _this.getState(value, _this.props.fractionDigits, _this.props.hideTrailingZeros), {\n        focused: false\n      }));\n\n      if (_this.props.onBlur) {\n        _this.props.onBlur(event);\n      }\n    };\n\n    _this.refInput = function (element) {\n      _this.input = element;\n    };\n\n    return _this;\n  }\n\n  var _proto = CurrencyInput.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    var _this$props = this.props,\n        maxLength = _this$props.maxLength,\n        integerDigits = _this$props.integerDigits,\n        fractionDigits = _this$props.fractionDigits;\n    warning(maxLength === undefined, \"[CurrencyInput]: Prop 'maxLength' has been deprecated. See 'integerDigits' and 'fractionDigits'\");\n    warning((integerDigits || 0) + (fractionDigits || 0) <= MAX_SAFE_DIGITS, \"[CurrencyInput]: Sum of 'integerDigits' and 'fractionDigits' exceeds \" + MAX_SAFE_DIGITS + \".\" + \"\\nSee https://tech.skbkontur.ru/react-ui/#/CurrencyInput?id=why15\");\n  };\n\n  _proto.UNSAFE_componentWillReceiveProps = function UNSAFE_componentWillReceiveProps(nextProps) {\n    var value = nextProps.value,\n        fractionDigits = nextProps.fractionDigits,\n        hideTrailingZeros = nextProps.hideTrailingZeros;\n\n    if (value !== CurrencyHelper.parse(this.state.formatted) || fractionDigits !== this.props.fractionDigits) {\n      var state = this.getState(value, fractionDigits, hideTrailingZeros);\n      this.setState(state);\n    }\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate() {\n    if (this.state.focused && this.input) {\n      var _this$state$selection = this.state.selection,\n          start = _this$state$selection.start,\n          end = _this$state$selection.end;\n      this.input.setSelectionRange(start, end);\n    }\n  };\n\n  _proto.render = function render() {\n    var _this$props2 = this.props,\n        fractionDigits = _this$props2.fractionDigits,\n        signed = _this$props2.signed,\n        onSubmit = _this$props2.onSubmit,\n        integerDigits = _this$props2.integerDigits,\n        hideTrailingZeros = _this$props2.hideTrailingZeros,\n        rest = _objectWithoutPropertiesLoose(_this$props2, [\"fractionDigits\", \"signed\", \"onSubmit\", \"integerDigits\", \"hideTrailingZeros\"]);\n\n    var placeholder = this.props.placeholder == null ? CurrencyHelper.format(0, {\n      fractionDigits: fractionDigits,\n      hideTrailingZeros: hideTrailingZeros\n    }) : this.props.placeholder;\n    return React.createElement(Input, _extends({}, rest, {\n      value: this.state.formatted,\n      onBlur: this.handleBlur,\n      onFocus: this.handleFocus,\n      onMouseUp: this.handleMouseUp,\n      onKeyDown: this.handleKeyDown,\n      onValueChange: this.handleValueChange,\n      onPaste: this.handlePaste,\n      onCopy: this.handleCopy,\n      onCut: this.handleCut,\n      onMouseEnter: this.props.onMouseEnter,\n      onMouseLeave: this.props.onMouseLeave,\n      onMouseOver: this.props.onMouseOver,\n      ref: this.refInput,\n      placeholder: this.state.focused ? '' : placeholder\n    }));\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.getState = function getState(value, fractionDigits, hideTrailingZeros) {\n    return {\n      formatted: CurrencyHelper.format(value, {\n        fractionDigits: fractionDigits,\n        hideTrailingZeros: hideTrailingZeros\n      }),\n      selection: SelectionHelper.fromPosition(0)\n    };\n  };\n\n  return CurrencyInput;\n}(React.Component);\nCurrencyInput.__KONTUR_REACT_UI__ = 'CurrencyInput';\nCurrencyInput.propTypes = {\n  align: PropTypes.oneOf(['left', 'center', 'right']),\n  autoFocus: PropTypes.bool,\n  borderless: PropTypes.bool,\n  disabled: PropTypes.bool,\n  error: PropTypes.bool,\n  fractionDigits: PropTypes.number,\n  hideTrailingZeros: PropTypes.bool,\n  leftIcon: PropTypes.element,\n  placeholder: PropTypes.string,\n  signed: PropTypes.bool,\n  size: PropTypes.oneOf(['small', 'medium', 'large']),\n  value: PropTypes.number,\n  warning: PropTypes.bool,\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  onBlur: PropTypes.func,\n  onValueChange: PropTypes.func.isRequired,\n  onFocus: PropTypes.func,\n  onMouseEnter: PropTypes.func,\n  onMouseLeave: PropTypes.func,\n  onMouseOver: PropTypes.func,\n  onSubmit: PropTypes.func\n};\nCurrencyInput.defaultProps = {\n  align: 'right',\n  fractionDigits: 2,\n  hideTrailingZeros: false,\n  value: null\n};\n\nfunction getInputSelection(input) {\n  if (!(input instanceof HTMLInputElement)) {\n    throw new Error('input is not HTMLInputElement');\n  }\n\n  return {\n    start: input.selectionStart,\n    end: input.selectionEnd,\n    direction: input.selectionDirection\n  };\n}"]},"metadata":{},"sourceType":"module"}