{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { findDOMNode } from 'react-dom';\nimport { isKeyArrowDown, isKeyArrowUp, isKeyEnter, isKeyEscape } from \"../../../lib/events/keyboard/identifiers\";\nimport { Input } from \"../../Input\";\nimport { DropdownContainer } from \"../../../internal/DropdownContainer\";\nimport { Menu } from \"../../../internal/Menu\";\nimport { MenuItem } from \"../../MenuItem\";\nimport { RenderLayer } from \"../../../internal/RenderLayer\";\nimport { createPropsGetter } from \"../../../lib/createPropsGetter\";\nimport { fixClickFocusIE } from \"../../../lib/events/fixClickFocusIE\";\n\nfunction match(pattern, items) {\n  if (!pattern || !items) {\n    return Promise.resolve([]);\n  }\n\n  pattern = pattern.toLowerCase();\n  var filteredItems = items.filter(function (item) {\n    return item.toLowerCase().includes(pattern);\n  });\n  return Promise.resolve(filteredItems);\n}\n\nfunction renderItem(item) {\n  return item;\n}\n/**\r\n   * Стандартный инпут с подсказками.\r\n   *\r\n   * Все свойства передаются во внутренний *Input*.\r\n   */\n\n\nexport var Autocomplete = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Autocomplete, _React$Component);\n\n  function Autocomplete() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      items: null,\n      selected: -1\n    };\n    _this.opened = false;\n    _this.input = null;\n    _this.menu = void 0;\n    _this.focused = false;\n    _this.requestId = 0;\n    _this.getProps = createPropsGetter(Autocomplete.defaultProps);\n\n    _this.handleValueChange = function (value) {\n      _this.opened = true;\n\n      _this.fireChange(value);\n    };\n\n    _this.handleFocus = function (event) {\n      if (_this.focused) {\n        return;\n      }\n\n      _this.focused = true;\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus(event);\n      }\n    };\n\n    _this.handleBlur = function () {\n      if (!_this.focused) {\n        return;\n      }\n\n      _this.focused = false;\n      _this.opened = false;\n\n      _this.setState({\n        items: null\n      });\n\n      if (_this.input) {\n        _this.input.blur();\n      }\n\n      if (_this.props.onBlur) {\n        _this.props.onBlur();\n      }\n    };\n\n    _this.handleClickOutside = function (e) {\n      fixClickFocusIE(e);\n\n      _this.handleBlur();\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (_this.props.onKeyDown) {\n        _this.props.onKeyDown(e);\n      }\n\n      switch (true) {\n        case isKeyEscape(e):\n          e.preventDefault();\n\n          _this.setState({\n            items: null\n          });\n\n          return;\n\n        case isKeyArrowUp(e):\n          e.preventDefault();\n\n          if (_this.menu) {\n            _this.menu.up();\n          }\n\n          return;\n\n        case isKeyArrowDown(e):\n          e.preventDefault();\n\n          if (_this.menu) {\n            _this.menu.down();\n          }\n\n          return;\n\n        case isKeyEnter(e):\n          e.preventDefault(); // To prevent form submission.\n\n          if (_this.menu) {\n            _this.menu.enter(e);\n          }\n\n          return;\n      }\n    };\n\n    _this.getAnchor = function () {\n      return findDOMNode(_assertThisInitialized(_this));\n    };\n\n    _this.refInput = function (el) {\n      _this.input = el;\n    };\n\n    _this.refMenu = function (menu) {\n      _this.menu = menu;\n    };\n\n    return _this;\n  }\n\n  var _proto = Autocomplete.prototype;\n  /**\r\n   * @public\r\n   */\n\n  _proto.focus = function focus() {\n    if (this.input) {\n      this.input.focus();\n    }\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.blur = function blur() {\n    this.handleBlur();\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (prevProps.value !== this.props.value) {\n      this.updateItems(this.props.value || '');\n    }\n  };\n\n  _proto.render = function render() {\n    var _this$props = this.props,\n        onValueChange = _this$props.onValueChange,\n        onKeyDown = _this$props.onKeyDown,\n        onFocus = _this$props.onFocus,\n        onBlur = _this$props.onBlur,\n        _renderItem = _this$props.renderItem,\n        disablePortal = _this$props.disablePortal,\n        hasShadow = _this$props.hasShadow,\n        menuAlign = _this$props.menuAlign,\n        menuMaxHeight = _this$props.menuMaxHeight,\n        preventWindowScroll = _this$props.preventWindowScroll,\n        source = _this$props.source,\n        rest = _objectWithoutPropertiesLoose(_this$props, [\"onValueChange\", \"onKeyDown\", \"onFocus\", \"onBlur\", \"renderItem\", \"disablePortal\", \"hasShadow\", \"menuAlign\", \"menuMaxHeight\", \"preventWindowScroll\", \"source\"]);\n\n    var inputProps = _extends({}, rest, {\n      onValueChange: this.handleValueChange,\n      onKeyDown: this.handleKeyDown,\n      onFocus: this.handleFocus,\n      ref: this.refInput\n    });\n\n    return React.createElement(RenderLayer, {\n      onFocusOutside: this.handleBlur,\n      onClickOutside: this.handleClickOutside\n    }, React.createElement(\"span\", {\n      style: {\n        display: 'inline-block'\n      }\n    }, React.createElement(Input, inputProps), this.renderMenu()));\n  };\n\n  _proto.renderMenu = function renderMenu() {\n    var _this2 = this;\n\n    var items = this.state.items;\n    var menuProps = {\n      ref: this.refMenu,\n      maxHeight: this.props.menuMaxHeight,\n      hasShadow: this.props.hasShadow,\n      width: this.props.menuWidth || this.props.width,\n      preventWindowScroll: this.props.preventWindowScroll\n    };\n\n    if (!items || items.length === 0) {\n      return null;\n    }\n\n    return React.createElement(DropdownContainer, {\n      offsetY: 1,\n      getParent: this.getAnchor,\n      align: this.props.menuAlign,\n      disablePortal: this.props.disablePortal\n    }, React.createElement(Menu, menuProps, items.map(function (item, i) {\n      return React.createElement(MenuItem, {\n        onClick: _this2.handleMenuItemClick(i),\n        key: i\n      }, _this2.getProps().renderItem(item));\n    })));\n  };\n\n  _proto.handleMenuItemClick = function handleMenuItemClick(i) {\n    var _this3 = this;\n\n    return function (event) {\n      return _this3.handleItemClick(event, i);\n    };\n  };\n\n  _proto.handleItemClick = function handleItemClick(event, index) {\n    if (event.button) {\n      return;\n    }\n\n    event.preventDefault();\n    this.choose(index);\n  };\n\n  _proto.choose = function choose(index) {\n    if (!this.state.items) {\n      return;\n    }\n\n    var value = this.state.items[index];\n    this.opened = false;\n    this.setState({\n      selected: -1,\n      items: null\n    });\n    this.fireChange(value);\n    this.blur();\n  };\n\n  _proto.updateItems = function updateItems(value) {\n    var _this4 = this;\n\n    if (!this.opened) {\n      return;\n    }\n\n    var pattern = value.trim();\n    var source = this.props.source;\n\n    if (!source) {\n      return;\n    }\n\n    var promise;\n    var expectingId = this.requestId += 1;\n\n    if (typeof source === 'function') {\n      promise = source(pattern);\n    } else {\n      promise = match(pattern, source);\n    }\n\n    promise.then(function (items) {\n      if (_this4.opened && expectingId === _this4.requestId) {\n        _this4.setState({\n          items: items,\n          selected: -1\n        });\n      }\n    });\n  };\n\n  _proto.fireChange = function fireChange(value) {\n    if (this.props.onValueChange) {\n      this.props.onValueChange(value);\n    }\n  };\n\n  return Autocomplete;\n}(React.Component);\nAutocomplete.__KONTUR_REACT_UI__ = 'Autocomplete';\nAutocomplete.propTypes = {\n  /**\r\n   * Функция для отрисовки элемента в выпадающем списке. Единственный аргумент\r\n   * — *item*.\r\n   */\n  renderItem: PropTypes.func,\n\n  /**\r\n   * Если передан массив, то совпадения ищутся по этому массиву.\r\n   *\r\n   * Если передается функция, то она должна возвращать thenable, который\r\n   * резолвится уже отфильтрованным массивом. Возвращенный thenable может\r\n   * иметь метод cancel, который будет вызван при отмене поиска (пользователь\r\n   * изменил строку поиска, автокомплит потерял фокус).\r\n   * ```\r\n   * function(pattern) {\r\n   *   return service.findAll(pattern);\r\n   * }\r\n   * ```\r\n   */\n  source: PropTypes.oneOfType([PropTypes.array, PropTypes.func])\n};\nAutocomplete.defaultProps = {\n  renderItem: renderItem,\n  size: 'small',\n  disablePortal: false,\n  hasShadow: true,\n  menuMaxHeight: 300,\n  menuAlign: 'left',\n  preventWindowScroll: true\n};","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/components/Autocomplete/Autocomplete/Autocomplete.js"],"names":["_extends","_objectWithoutPropertiesLoose","_assertThisInitialized","_inheritsLoose","React","PropTypes","findDOMNode","isKeyArrowDown","isKeyArrowUp","isKeyEnter","isKeyEscape","Input","DropdownContainer","Menu","MenuItem","RenderLayer","createPropsGetter","fixClickFocusIE","match","pattern","items","Promise","resolve","toLowerCase","filteredItems","filter","item","includes","renderItem","Autocomplete","_React$Component","_this","_len","arguments","length","args","Array","_key","call","apply","concat","state","selected","opened","input","menu","focused","requestId","getProps","defaultProps","handleValueChange","value","fireChange","handleFocus","event","props","onFocus","handleBlur","setState","blur","onBlur","handleClickOutside","e","handleKeyDown","onKeyDown","preventDefault","up","down","enter","getAnchor","refInput","el","refMenu","_proto","prototype","focus","componentDidUpdate","prevProps","updateItems","render","_this$props","onValueChange","_renderItem","disablePortal","hasShadow","menuAlign","menuMaxHeight","preventWindowScroll","source","rest","inputProps","ref","createElement","onFocusOutside","onClickOutside","style","display","renderMenu","_this2","menuProps","maxHeight","width","menuWidth","offsetY","getParent","align","map","i","onClick","handleMenuItemClick","key","_this3","handleItemClick","index","button","choose","_this4","trim","promise","expectingId","then","Component","__KONTUR_REACT_UI__","propTypes","func","oneOfType","array","size"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { findDOMNode } from 'react-dom';\nimport { isKeyArrowDown, isKeyArrowUp, isKeyEnter, isKeyEscape } from \"../../../lib/events/keyboard/identifiers\";\nimport { Input } from \"../../Input\";\nimport { DropdownContainer } from \"../../../internal/DropdownContainer\";\nimport { Menu } from \"../../../internal/Menu\";\nimport { MenuItem } from \"../../MenuItem\";\nimport { RenderLayer } from \"../../../internal/RenderLayer\";\nimport { createPropsGetter } from \"../../../lib/createPropsGetter\";\nimport { fixClickFocusIE } from \"../../../lib/events/fixClickFocusIE\";\n\nfunction match(pattern, items) {\n  if (!pattern || !items) {\n    return Promise.resolve([]);\n  }\n\n  pattern = pattern.toLowerCase();\n  var filteredItems = items.filter(function (item) {\n    return item.toLowerCase().includes(pattern);\n  });\n  return Promise.resolve(filteredItems);\n}\n\nfunction renderItem(item) {\n  return item;\n}\n/**\r\n   * Стандартный инпут с подсказками.\r\n   *\r\n   * Все свойства передаются во внутренний *Input*.\r\n   */\n\n\nexport var Autocomplete =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(Autocomplete, _React$Component);\n\n  function Autocomplete() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      items: null,\n      selected: -1\n    };\n    _this.opened = false;\n    _this.input = null;\n    _this.menu = void 0;\n    _this.focused = false;\n    _this.requestId = 0;\n    _this.getProps = createPropsGetter(Autocomplete.defaultProps);\n\n    _this.handleValueChange = function (value) {\n      _this.opened = true;\n\n      _this.fireChange(value);\n    };\n\n    _this.handleFocus = function (event) {\n      if (_this.focused) {\n        return;\n      }\n\n      _this.focused = true;\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus(event);\n      }\n    };\n\n    _this.handleBlur = function () {\n      if (!_this.focused) {\n        return;\n      }\n\n      _this.focused = false;\n      _this.opened = false;\n\n      _this.setState({\n        items: null\n      });\n\n      if (_this.input) {\n        _this.input.blur();\n      }\n\n      if (_this.props.onBlur) {\n        _this.props.onBlur();\n      }\n    };\n\n    _this.handleClickOutside = function (e) {\n      fixClickFocusIE(e);\n\n      _this.handleBlur();\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (_this.props.onKeyDown) {\n        _this.props.onKeyDown(e);\n      }\n\n      switch (true) {\n        case isKeyEscape(e):\n          e.preventDefault();\n\n          _this.setState({\n            items: null\n          });\n\n          return;\n\n        case isKeyArrowUp(e):\n          e.preventDefault();\n\n          if (_this.menu) {\n            _this.menu.up();\n          }\n\n          return;\n\n        case isKeyArrowDown(e):\n          e.preventDefault();\n\n          if (_this.menu) {\n            _this.menu.down();\n          }\n\n          return;\n\n        case isKeyEnter(e):\n          e.preventDefault(); // To prevent form submission.\n\n          if (_this.menu) {\n            _this.menu.enter(e);\n          }\n\n          return;\n      }\n    };\n\n    _this.getAnchor = function () {\n      return findDOMNode(_assertThisInitialized(_this));\n    };\n\n    _this.refInput = function (el) {\n      _this.input = el;\n    };\n\n    _this.refMenu = function (menu) {\n      _this.menu = menu;\n    };\n\n    return _this;\n  }\n\n  var _proto = Autocomplete.prototype;\n  /**\r\n   * @public\r\n   */\n\n  _proto.focus = function focus() {\n    if (this.input) {\n      this.input.focus();\n    }\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.blur = function blur() {\n    this.handleBlur();\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (prevProps.value !== this.props.value) {\n      this.updateItems(this.props.value || '');\n    }\n  };\n\n  _proto.render = function render() {\n    var _this$props = this.props,\n        onValueChange = _this$props.onValueChange,\n        onKeyDown = _this$props.onKeyDown,\n        onFocus = _this$props.onFocus,\n        onBlur = _this$props.onBlur,\n        _renderItem = _this$props.renderItem,\n        disablePortal = _this$props.disablePortal,\n        hasShadow = _this$props.hasShadow,\n        menuAlign = _this$props.menuAlign,\n        menuMaxHeight = _this$props.menuMaxHeight,\n        preventWindowScroll = _this$props.preventWindowScroll,\n        source = _this$props.source,\n        rest = _objectWithoutPropertiesLoose(_this$props, [\"onValueChange\", \"onKeyDown\", \"onFocus\", \"onBlur\", \"renderItem\", \"disablePortal\", \"hasShadow\", \"menuAlign\", \"menuMaxHeight\", \"preventWindowScroll\", \"source\"]);\n\n    var inputProps = _extends({}, rest, {\n      onValueChange: this.handleValueChange,\n      onKeyDown: this.handleKeyDown,\n      onFocus: this.handleFocus,\n      ref: this.refInput\n    });\n\n    return React.createElement(RenderLayer, {\n      onFocusOutside: this.handleBlur,\n      onClickOutside: this.handleClickOutside\n    }, React.createElement(\"span\", {\n      style: {\n        display: 'inline-block'\n      }\n    }, React.createElement(Input, inputProps), this.renderMenu()));\n  };\n\n  _proto.renderMenu = function renderMenu() {\n    var _this2 = this;\n\n    var items = this.state.items;\n    var menuProps = {\n      ref: this.refMenu,\n      maxHeight: this.props.menuMaxHeight,\n      hasShadow: this.props.hasShadow,\n      width: this.props.menuWidth || this.props.width,\n      preventWindowScroll: this.props.preventWindowScroll\n    };\n\n    if (!items || items.length === 0) {\n      return null;\n    }\n\n    return React.createElement(DropdownContainer, {\n      offsetY: 1,\n      getParent: this.getAnchor,\n      align: this.props.menuAlign,\n      disablePortal: this.props.disablePortal\n    }, React.createElement(Menu, menuProps, items.map(function (item, i) {\n      return React.createElement(MenuItem, {\n        onClick: _this2.handleMenuItemClick(i),\n        key: i\n      }, _this2.getProps().renderItem(item));\n    })));\n  };\n\n  _proto.handleMenuItemClick = function handleMenuItemClick(i) {\n    var _this3 = this;\n\n    return function (event) {\n      return _this3.handleItemClick(event, i);\n    };\n  };\n\n  _proto.handleItemClick = function handleItemClick(event, index) {\n    if (event.button) {\n      return;\n    }\n\n    event.preventDefault();\n    this.choose(index);\n  };\n\n  _proto.choose = function choose(index) {\n    if (!this.state.items) {\n      return;\n    }\n\n    var value = this.state.items[index];\n    this.opened = false;\n    this.setState({\n      selected: -1,\n      items: null\n    });\n    this.fireChange(value);\n    this.blur();\n  };\n\n  _proto.updateItems = function updateItems(value) {\n    var _this4 = this;\n\n    if (!this.opened) {\n      return;\n    }\n\n    var pattern = value.trim();\n    var source = this.props.source;\n\n    if (!source) {\n      return;\n    }\n\n    var promise;\n    var expectingId = this.requestId += 1;\n\n    if (typeof source === 'function') {\n      promise = source(pattern);\n    } else {\n      promise = match(pattern, source);\n    }\n\n    promise.then(function (items) {\n      if (_this4.opened && expectingId === _this4.requestId) {\n        _this4.setState({\n          items: items,\n          selected: -1\n        });\n      }\n    });\n  };\n\n  _proto.fireChange = function fireChange(value) {\n    if (this.props.onValueChange) {\n      this.props.onValueChange(value);\n    }\n  };\n\n  return Autocomplete;\n}(React.Component);\nAutocomplete.__KONTUR_REACT_UI__ = 'Autocomplete';\nAutocomplete.propTypes = {\n  /**\r\n   * Функция для отрисовки элемента в выпадающем списке. Единственный аргумент\r\n   * — *item*.\r\n   */\n  renderItem: PropTypes.func,\n\n  /**\r\n   * Если передан массив, то совпадения ищутся по этому массиву.\r\n   *\r\n   * Если передается функция, то она должна возвращать thenable, который\r\n   * резолвится уже отфильтрованным массивом. Возвращенный thenable может\r\n   * иметь метод cancel, который будет вызван при отмене поиска (пользователь\r\n   * изменил строку поиска, автокомплит потерял фокус).\r\n   * ```\r\n   * function(pattern) {\r\n   *   return service.findAll(pattern);\r\n   * }\r\n   * ```\r\n   */\n  source: PropTypes.oneOfType([PropTypes.array, PropTypes.func])\n};\nAutocomplete.defaultProps = {\n  renderItem: renderItem,\n  size: 'small',\n  disablePortal: false,\n  hasShadow: true,\n  menuMaxHeight: 300,\n  menuAlign: 'left',\n  preventWindowScroll: true\n};"]},"metadata":{},"sourceType":"module"}