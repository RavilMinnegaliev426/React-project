{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { Transition } from 'react-transition-group';\nimport raf from 'raf';\nimport warning from 'warning';\nimport cn from 'classnames';\nimport * as LayoutEvents from \"../../../lib/LayoutEvents\";\nimport { ZIndex } from \"../../ZIndex\";\nimport { RenderContainer } from \"../../RenderContainer\";\nimport { isFunction, isIE11, isEdge } from \"../../../lib/utils\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { safePropTypesInstanceOf } from \"../../../lib/SSRSafe\";\nimport { PopupPin } from \"../PopupPin\";\nimport { PopupHelper } from \"../PopupHelper\";\nimport { jsStyles } from \"../Popup.styles\";\nvar POPUP_BORDER_DEFAULT_COLOR = 'transparent';\nvar TRANSITION_TIMEOUT = {\n  enter: 0,\n  exit: 200\n};\nvar DUMMY_LOCATION = {\n  position: 'top left',\n  coordinates: {\n    top: -9999,\n    left: -9999\n  }\n};\nexport var PopupPositions = ['top left', 'top center', 'top right', 'right top', 'right middle', 'right bottom', 'bottom right', 'bottom center', 'bottom left', 'left bottom', 'left middle', 'left top'];\nexport var Popup = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Popup, _React$Component);\n\n  function Popup() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      location: _this.props.opened ? DUMMY_LOCATION : null\n    };\n    _this.theme = void 0;\n    _this.layoutEventsToken = void 0;\n    _this.locationUpdateId = null;\n    _this.lastPopupElement = void 0;\n    _this.anchorElement = null;\n    _this.anchorInstance = void 0;\n\n    _this.refAnchorElement = function (instance) {\n      _this.anchorInstance = instance;\n\n      var element = _this.extractElement(instance);\n\n      _this.updateAnchorElement(element);\n\n      _this.anchorElement = element;\n    };\n\n    _this.handleMouseEnter = function (event) {\n      if (_this.props.onMouseEnter) {\n        _this.props.onMouseEnter(event);\n      }\n    };\n\n    _this.handleMouseLeave = function (event) {\n      if (_this.props.onMouseLeave) {\n        _this.props.onMouseLeave(event);\n      }\n    };\n\n    _this.handleClick = function (event) {\n      if (_this.props.onClick) {\n        _this.props.onClick(event);\n      }\n    };\n\n    _this.handleFocus = function (event) {\n      if (_this.props.onFocus) {\n        _this.props.onFocus(event);\n      }\n    };\n\n    _this.handleBlur = function (event) {\n      if (_this.props.onBlur) {\n        _this.props.onBlur(event);\n      }\n    };\n\n    _this.resetLocation = function () {\n      _this.cancelDelayedUpdateLocation();\n\n      _this.setState({\n        location: null\n      });\n    };\n\n    _this.refPopupElement = function (zIndex) {\n      if (zIndex) {\n        _this.lastPopupElement = zIndex && findDOMNode(zIndex);\n      }\n    };\n\n    _this.handleLayoutEvent = function () {\n      if (!_this.state.location) {\n        return;\n      }\n\n      if (_this.anchorInstance) {\n        _this.updateAnchorElement(_this.extractElement(_this.anchorInstance));\n      }\n\n      _this.updateLocation();\n    };\n\n    _this.updateLocation = function () {\n      var popupElement = _this.lastPopupElement;\n\n      if (!popupElement) {\n        return;\n      }\n\n      var location = _this.getLocation(popupElement, _this.state.location);\n\n      if (!_this.locationEquals(_this.state.location, location)) {\n        _this.setState({\n          location: location\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  var _proto = Popup.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.updateLocation();\n    this.layoutEventsToken = LayoutEvents.addListener(this.handleLayoutEvent);\n  };\n\n  _proto.UNSAFE_componentWillReceiveProps = function UNSAFE_componentWillReceiveProps(nextProps) {\n    /**\r\n     * Delaying updateLocation to ensure it happens after props update\r\n     */\n    if (nextProps.opened) {\n      if (!this.state.location) {\n        this.setState({\n          location: DUMMY_LOCATION\n        });\n      }\n\n      this.delayUpdateLocation();\n    }\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n    var hadNoLocation = prevState.location === DUMMY_LOCATION;\n    var hasLocation = this.state.location !== DUMMY_LOCATION;\n\n    if (hadNoLocation && hasLocation && this.props.onOpen) {\n      this.props.onOpen();\n    }\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    this.cancelDelayedUpdateLocation();\n    this.removeEventListeners(this.anchorElement);\n\n    if (this.layoutEventsToken) {\n      this.layoutEventsToken.remove();\n      this.layoutEventsToken = null;\n    }\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var location = this.state.location;\n    var _this$props = this.props,\n        anchorElement = _this$props.anchorElement,\n        useWrapper = _this$props.useWrapper;\n    var child = null;\n\n    if (anchorElement instanceof HTMLElement) {\n      this.updateAnchorElement(anchorElement);\n    } else if (React.isValidElement(anchorElement)) {\n      child = useWrapper ? React.createElement(\"span\", null, anchorElement) : anchorElement;\n    } else {\n      child = React.createElement(\"span\", null, anchorElement);\n    }\n\n    return React.createElement(RenderContainer, {\n      anchor: child,\n      ref: child ? this.refAnchorElement : undefined\n    }, location && this.renderContent(location));\n  };\n\n  _proto.extractElement = function extractElement(instance) {\n    if (!instance) {\n      return null;\n    }\n\n    var element = findDOMNode(instance);\n    return element instanceof HTMLElement ? element : null;\n  };\n\n  _proto.updateAnchorElement = function updateAnchorElement(element) {\n    var anchorElement = this.anchorElement;\n\n    if (element !== anchorElement) {\n      this.removeEventListeners(anchorElement);\n      this.anchorElement = element;\n      this.addEventListeners(element);\n    }\n  };\n\n  _proto.addEventListeners = function addEventListeners(element) {\n    if (element && element instanceof HTMLElement) {\n      element.addEventListener('mouseenter', this.handleMouseEnter);\n      element.addEventListener('mouseleave', this.handleMouseLeave);\n      element.addEventListener('click', this.handleClick);\n      element.addEventListener('focusin', this.handleFocus);\n      element.addEventListener('focusout', this.handleBlur);\n    }\n  };\n\n  _proto.removeEventListeners = function removeEventListeners(element) {\n    if (element && element instanceof HTMLElement) {\n      element.removeEventListener('mouseenter', this.handleMouseEnter);\n      element.removeEventListener('mouseleave', this.handleMouseLeave);\n      element.removeEventListener('click', this.handleClick);\n      element.removeEventListener('focusin', this.handleFocus);\n      element.removeEventListener('focusout', this.handleBlur);\n    }\n  };\n\n  _proto.renderContent = function renderContent(location) {\n    var _this3 = this;\n\n    var _this$props2 = this.props,\n        backgroundColor = _this$props2.backgroundColor,\n        disableAnimations = _this$props2.disableAnimations,\n        maxWidth = _this$props2.maxWidth,\n        hasShadow = _this$props2.hasShadow,\n        ignoreHover = _this$props2.ignoreHover,\n        opened = _this$props2.opened;\n    var children = this.renderChildren();\n\n    var _PopupHelper$getPosit = PopupHelper.getPositionObject(location.position),\n        direction = _PopupHelper$getPosit.direction;\n\n    var rootStyle = _extends({}, location.coordinates, {\n      maxWidth: maxWidth\n    });\n\n    return React.createElement(Transition, {\n      timeout: TRANSITION_TIMEOUT,\n      appear: !disableAnimations,\n      \"in\": Boolean(opened && children),\n      mountOnEnter: true,\n      unmountOnExit: true,\n      enter: !disableAnimations,\n      exit: !disableAnimations,\n      onExited: this.resetLocation\n    }, function (state) {\n      var _extends2, _ref;\n\n      return React.createElement(ZIndex, {\n        ref: _this3.refPopupElement,\n        priority: 'Popup',\n        className: cn(_extends((_extends2 = {}, _extends2[jsStyles.popup(_this3.theme)] = true, _extends2[jsStyles.shadow(_this3.theme)] = hasShadow, _extends2[jsStyles.shadowFallback(_this3.theme)] = hasShadow && (isIE11 || isEdge), _extends2[jsStyles.popupIgnoreHover()] = ignoreHover, _extends2), disableAnimations ? {} : (_ref = {}, _ref[jsStyles[\"transition-enter-\" + direction](_this3.theme)] = true, _ref[jsStyles.transitionEnter()] = state === 'entering', _ref[jsStyles.transitionEnterActive()] = state === 'entered', _ref[jsStyles.transitionExit()] = state === 'exiting', _ref))),\n        style: rootStyle,\n        onMouseEnter: _this3.handleMouseEnter,\n        onMouseLeave: _this3.handleMouseLeave\n      }, React.createElement(\"div\", {\n        className: jsStyles.content(_this3.theme),\n        \"data-tid\": 'PopupContent'\n      }, React.createElement(\"div\", {\n        className: jsStyles.contentInner(_this3.theme),\n        style: {\n          backgroundColor: backgroundColor\n        },\n        \"data-tid\": 'PopupContentInner'\n      }, children)), _this3.renderPin(location.position));\n    });\n  };\n\n  _proto.renderChildren = function renderChildren() {\n    return isFunction(this.props.children) ? this.props.children() : this.props.children;\n  };\n\n  _proto.renderPin = function renderPin(position) {\n    /**\r\n     * Box-shadow does not appear under the pin. Borders are used instead.\r\n     * In non-ie browsers drop-shadow filter is used. It is applying\r\n     * shadow to the pin too.\r\n     */\n    var isDefaultBorderColor = this.theme.popupBorderColor === POPUP_BORDER_DEFAULT_COLOR;\n    var pinBorder = isIE11 && isDefaultBorderColor ? 'rgba(0, 0, 0, 0.09)' : this.theme.popupBorderColor;\n    var _this$props3 = this.props,\n        pinSize = _this$props3.pinSize,\n        pinOffset = _this$props3.pinOffset,\n        hasShadow = _this$props3.hasShadow,\n        backgroundColor = _this$props3.backgroundColor,\n        borderColor = _this$props3.borderColor;\n    return this.props.hasPin && React.createElement(PopupPin, {\n      popupElement: this.lastPopupElement,\n      popupPosition: position,\n      size: pinSize,\n      offset: pinOffset,\n      borderWidth: hasShadow ? 1 : 0,\n      backgroundColor: backgroundColor || this.theme.popupBackground,\n      borderColor: borderColor || pinBorder\n    });\n  };\n\n  _proto.delayUpdateLocation = function delayUpdateLocation() {\n    this.cancelDelayedUpdateLocation();\n    this.locationUpdateId = raf(this.updateLocation);\n  };\n\n  _proto.cancelDelayedUpdateLocation = function cancelDelayedUpdateLocation() {\n    if (this.locationUpdateId) {\n      raf.cancel(this.locationUpdateId);\n      this.locationUpdateId = null;\n    }\n  };\n\n  _proto.locationEquals = function locationEquals(x, y) {\n    if (x === y) {\n      return true;\n    }\n\n    if (x == null || y == null) {\n      return false;\n    }\n\n    return x.coordinates.left === y.coordinates.left && x.coordinates.top === y.coordinates.top && x.position === y.position;\n  };\n\n  _proto.getLocation = function getLocation(popupElement, location) {\n    var positions = this.props.positions;\n    var anchorElement = this.anchorElement;\n    warning(anchorElement && anchorElement instanceof HTMLElement, 'Anchor element is not defined or not instance of HTMLElement');\n\n    if (!(anchorElement && anchorElement instanceof HTMLElement)) {\n      return location;\n    }\n\n    var anchorRect = PopupHelper.getElementAbsoluteRect(anchorElement);\n    var popupRect = PopupHelper.getElementAbsoluteRect(popupElement);\n    var position;\n    var coordinates;\n\n    if (location && location !== DUMMY_LOCATION && location.position) {\n      position = location.position;\n      coordinates = this.getCoordinates(anchorRect, popupRect, position);\n      var isFullyVisible = PopupHelper.isFullyVisible(coordinates, popupRect);\n      var canBecomeVisible = !isFullyVisible && PopupHelper.canBecomeFullyVisible(position, coordinates);\n\n      if (isFullyVisible || canBecomeVisible) {\n        return {\n          coordinates: coordinates,\n          position: position\n        };\n      }\n    }\n\n    for (var _iterator = positions, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n      if (_isArray) {\n        if (_i >= _iterator.length) break;\n        position = _iterator[_i++];\n      } else {\n        _i = _iterator.next();\n        if (_i.done) break;\n        position = _i.value;\n      }\n\n      coordinates = this.getCoordinates(anchorRect, popupRect, position);\n\n      if (PopupHelper.isFullyVisible(coordinates, popupRect)) {\n        return {\n          coordinates: coordinates,\n          position: position\n        };\n      }\n    }\n\n    position = positions[0];\n    coordinates = this.getCoordinates(anchorRect, popupRect, position);\n    return {\n      coordinates: coordinates,\n      position: position\n    };\n  };\n\n  _proto.getPinnedPopupOffset = function getPinnedPopupOffset(anchorRect, position) {\n    if (!this.props.hasPin || /center|middle/.test(position.align)) {\n      return 0;\n    }\n\n    var anchorSize = /top|bottom/.test(position.direction) ? anchorRect.width : anchorRect.height;\n    var _this$props4 = this.props,\n        pinOffset = _this$props4.pinOffset,\n        pinSize = _this$props4.pinSize;\n    return Math.max(0, pinOffset + pinSize - anchorSize / 2);\n  };\n\n  _proto.getCoordinates = function getCoordinates(anchorRect, popupRect, positionName) {\n    var margin = this.props.margin;\n    var position = PopupHelper.getPositionObject(positionName);\n    var popupOffset = this.props.popupOffset + this.getPinnedPopupOffset(anchorRect, position);\n\n    switch (position.direction) {\n      case 'top':\n        return {\n          top: anchorRect.top - popupRect.height - margin,\n          left: this.getHorizontalPosition(anchorRect, popupRect, position.align, popupOffset)\n        };\n\n      case 'bottom':\n        return {\n          top: anchorRect.top + anchorRect.height + margin,\n          left: this.getHorizontalPosition(anchorRect, popupRect, position.align, popupOffset)\n        };\n\n      case 'left':\n        return {\n          top: this.getVerticalPosition(anchorRect, popupRect, position.align, popupOffset),\n          left: anchorRect.left - popupRect.width - margin\n        };\n\n      case 'right':\n        return {\n          top: this.getVerticalPosition(anchorRect, popupRect, position.align, popupOffset),\n          left: anchorRect.left + anchorRect.width + margin\n        };\n\n      default:\n        throw new Error(\"Unexpected direction '\" + position.direction + \"'\");\n    }\n  };\n\n  _proto.getHorizontalPosition = function getHorizontalPosition(anchorRect, popupRect, align, popupOffset) {\n    switch (align) {\n      case 'left':\n        return anchorRect.left - popupOffset;\n\n      case 'center':\n        return anchorRect.left - (popupRect.width - anchorRect.width) / 2;\n\n      case 'right':\n        return anchorRect.left - (popupRect.width - anchorRect.width) + popupOffset;\n\n      default:\n        throw new Error(\"Unexpected align '\" + align + \"'\");\n    }\n  };\n\n  _proto.getVerticalPosition = function getVerticalPosition(anchorRect, popupRect, align, popupOffset) {\n    switch (align) {\n      case 'top':\n        return anchorRect.top - popupOffset;\n\n      case 'middle':\n        return anchorRect.top - (popupRect.height - anchorRect.height) / 2;\n\n      case 'bottom':\n        return anchorRect.top - (popupRect.height - anchorRect.height) + popupOffset;\n\n      default:\n        throw new Error(\"Unexpected align '\" + align + \"'\");\n    }\n  };\n\n  return Popup;\n}(React.Component);\nPopup.__KONTUR_REACT_UI__ = 'Popup';\nPopup.propTypes = {\n  /**\r\n   * Ссылка (ref) на элемент или React компонент, для которого рисуется попап\r\n   */\n  anchorElement: PropTypes.oneOfType([safePropTypesInstanceOf(function () {\n    return HTMLElement;\n  }), PropTypes.node]).isRequired,\n\n  /**\r\n   * Фон попапа и пина\r\n   */\n  backgroundColor: PropTypes.string,\n  children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /**\r\n   * Показывать ли пин\r\n   */\n  hasPin: PropTypes.bool,\n\n  /**\r\n   * Применять ли box-shadow на попапе. При false отключает границу на пине\r\n   */\n  hasShadow: PropTypes.bool,\n\n  /**\r\n   * Отступ попапа от элемента\r\n   */\n  margin: PropTypes.number,\n\n  /**\r\n   * Показан или скрыт попап\r\n   */\n  opened: PropTypes.bool,\n\n  /**\r\n   * Смещение пина от края попапа. Край задаётся в пропе position вторым словом\r\n   */\n  pinOffset: PropTypes.number,\n\n  /**\r\n   * Сторона пина без учёта границы.\r\n   * Пин представляет собой равносторонний треугольник, высота от попапа\r\n   * до \"носика\" пина будет соответствовать формуле (size* √3)/2\r\n   */\n  pinSize: PropTypes.number,\n\n  /**\r\n   * смещение попапа относительно родительского элемента\r\n   */\n  popupOffset: PropTypes.number,\n\n  /**\r\n   * С какой стороны показывать попап и край попапа,\r\n   * на котором будет отображаться пин\r\n   */\n  positions: PropTypes.array,\n\n  /**\r\n   * Игнорировать ли события hover/click\r\n   */\n  ignoreHover: PropTypes.bool\n};\nPopup.defaultProps = {\n  margin: 10,\n  popupOffset: 0,\n  pinSize: 8,\n  pinOffset: 16,\n  hasPin: false,\n  hasShadow: false,\n  disableAnimations: Boolean(process.env.enableReactTesting),\n  useWrapper: false,\n  ignoreHover: false\n};","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/internal/Popup/Popup/Popup.js"],"names":["_extends","_inheritsLoose","React","findDOMNode","PropTypes","Transition","raf","warning","cn","LayoutEvents","ZIndex","RenderContainer","isFunction","isIE11","isEdge","ThemeContext","safePropTypesInstanceOf","PopupPin","PopupHelper","jsStyles","POPUP_BORDER_DEFAULT_COLOR","TRANSITION_TIMEOUT","enter","exit","DUMMY_LOCATION","position","coordinates","top","left","PopupPositions","Popup","_React$Component","_this","_len","arguments","length","args","Array","_key","call","apply","concat","state","location","props","opened","theme","layoutEventsToken","locationUpdateId","lastPopupElement","anchorElement","anchorInstance","refAnchorElement","instance","element","extractElement","updateAnchorElement","handleMouseEnter","event","onMouseEnter","handleMouseLeave","onMouseLeave","handleClick","onClick","handleFocus","onFocus","handleBlur","onBlur","resetLocation","cancelDelayedUpdateLocation","setState","refPopupElement","zIndex","handleLayoutEvent","updateLocation","popupElement","getLocation","locationEquals","_proto","prototype","componentDidMount","addListener","UNSAFE_componentWillReceiveProps","nextProps","delayUpdateLocation","componentDidUpdate","prevProps","prevState","hadNoLocation","hasLocation","onOpen","componentWillUnmount","removeEventListeners","remove","render","_this2","createElement","Consumer","renderMain","_this$props","useWrapper","child","HTMLElement","isValidElement","anchor","ref","undefined","renderContent","addEventListeners","addEventListener","removeEventListener","_this3","_this$props2","backgroundColor","disableAnimations","maxWidth","hasShadow","ignoreHover","children","renderChildren","_PopupHelper$getPosit","getPositionObject","direction","rootStyle","timeout","appear","Boolean","mountOnEnter","unmountOnExit","onExited","_extends2","_ref","priority","className","popup","shadow","shadowFallback","popupIgnoreHover","transitionEnter","transitionEnterActive","transitionExit","style","content","contentInner","renderPin","isDefaultBorderColor","popupBorderColor","pinBorder","_this$props3","pinSize","pinOffset","borderColor","hasPin","popupPosition","size","offset","borderWidth","popupBackground","cancel","x","y","positions","anchorRect","getElementAbsoluteRect","popupRect","getCoordinates","isFullyVisible","canBecomeVisible","canBecomeFullyVisible","_iterator","_isArray","isArray","_i","Symbol","iterator","next","done","value","getPinnedPopupOffset","test","align","anchorSize","width","height","_this$props4","Math","max","positionName","margin","popupOffset","getHorizontalPosition","getVerticalPosition","Error","Component","__KONTUR_REACT_UI__","propTypes","oneOfType","node","isRequired","string","func","bool","number","array","defaultProps","process","env","enableReactTesting"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport { Transition } from 'react-transition-group';\nimport raf from 'raf';\nimport warning from 'warning';\nimport cn from 'classnames';\nimport * as LayoutEvents from \"../../../lib/LayoutEvents\";\nimport { ZIndex } from \"../../ZIndex\";\nimport { RenderContainer } from \"../../RenderContainer\";\nimport { isFunction, isIE11, isEdge } from \"../../../lib/utils\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { safePropTypesInstanceOf } from \"../../../lib/SSRSafe\";\nimport { PopupPin } from \"../PopupPin\";\nimport { PopupHelper } from \"../PopupHelper\";\nimport { jsStyles } from \"../Popup.styles\";\nvar POPUP_BORDER_DEFAULT_COLOR = 'transparent';\nvar TRANSITION_TIMEOUT = {\n  enter: 0,\n  exit: 200\n};\nvar DUMMY_LOCATION = {\n  position: 'top left',\n  coordinates: {\n    top: -9999,\n    left: -9999\n  }\n};\nexport var PopupPositions = ['top left', 'top center', 'top right', 'right top', 'right middle', 'right bottom', 'bottom right', 'bottom center', 'bottom left', 'left bottom', 'left middle', 'left top'];\nexport var Popup =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(Popup, _React$Component);\n\n  function Popup() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      location: _this.props.opened ? DUMMY_LOCATION : null\n    };\n    _this.theme = void 0;\n    _this.layoutEventsToken = void 0;\n    _this.locationUpdateId = null;\n    _this.lastPopupElement = void 0;\n    _this.anchorElement = null;\n    _this.anchorInstance = void 0;\n\n    _this.refAnchorElement = function (instance) {\n      _this.anchorInstance = instance;\n\n      var element = _this.extractElement(instance);\n\n      _this.updateAnchorElement(element);\n\n      _this.anchorElement = element;\n    };\n\n    _this.handleMouseEnter = function (event) {\n      if (_this.props.onMouseEnter) {\n        _this.props.onMouseEnter(event);\n      }\n    };\n\n    _this.handleMouseLeave = function (event) {\n      if (_this.props.onMouseLeave) {\n        _this.props.onMouseLeave(event);\n      }\n    };\n\n    _this.handleClick = function (event) {\n      if (_this.props.onClick) {\n        _this.props.onClick(event);\n      }\n    };\n\n    _this.handleFocus = function (event) {\n      if (_this.props.onFocus) {\n        _this.props.onFocus(event);\n      }\n    };\n\n    _this.handleBlur = function (event) {\n      if (_this.props.onBlur) {\n        _this.props.onBlur(event);\n      }\n    };\n\n    _this.resetLocation = function () {\n      _this.cancelDelayedUpdateLocation();\n\n      _this.setState({\n        location: null\n      });\n    };\n\n    _this.refPopupElement = function (zIndex) {\n      if (zIndex) {\n        _this.lastPopupElement = zIndex && findDOMNode(zIndex);\n      }\n    };\n\n    _this.handleLayoutEvent = function () {\n      if (!_this.state.location) {\n        return;\n      }\n\n      if (_this.anchorInstance) {\n        _this.updateAnchorElement(_this.extractElement(_this.anchorInstance));\n      }\n\n      _this.updateLocation();\n    };\n\n    _this.updateLocation = function () {\n      var popupElement = _this.lastPopupElement;\n\n      if (!popupElement) {\n        return;\n      }\n\n      var location = _this.getLocation(popupElement, _this.state.location);\n\n      if (!_this.locationEquals(_this.state.location, location)) {\n        _this.setState({\n          location: location\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  var _proto = Popup.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.updateLocation();\n    this.layoutEventsToken = LayoutEvents.addListener(this.handleLayoutEvent);\n  };\n\n  _proto.UNSAFE_componentWillReceiveProps = function UNSAFE_componentWillReceiveProps(nextProps) {\n    /**\r\n     * Delaying updateLocation to ensure it happens after props update\r\n     */\n    if (nextProps.opened) {\n      if (!this.state.location) {\n        this.setState({\n          location: DUMMY_LOCATION\n        });\n      }\n\n      this.delayUpdateLocation();\n    }\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n    var hadNoLocation = prevState.location === DUMMY_LOCATION;\n    var hasLocation = this.state.location !== DUMMY_LOCATION;\n\n    if (hadNoLocation && hasLocation && this.props.onOpen) {\n      this.props.onOpen();\n    }\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    this.cancelDelayedUpdateLocation();\n    this.removeEventListeners(this.anchorElement);\n\n    if (this.layoutEventsToken) {\n      this.layoutEventsToken.remove();\n      this.layoutEventsToken = null;\n    }\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var location = this.state.location;\n    var _this$props = this.props,\n        anchorElement = _this$props.anchorElement,\n        useWrapper = _this$props.useWrapper;\n    var child = null;\n\n    if (anchorElement instanceof HTMLElement) {\n      this.updateAnchorElement(anchorElement);\n    } else if (React.isValidElement(anchorElement)) {\n      child = useWrapper ? React.createElement(\"span\", null, anchorElement) : anchorElement;\n    } else {\n      child = React.createElement(\"span\", null, anchorElement);\n    }\n\n    return React.createElement(RenderContainer, {\n      anchor: child,\n      ref: child ? this.refAnchorElement : undefined\n    }, location && this.renderContent(location));\n  };\n\n  _proto.extractElement = function extractElement(instance) {\n    if (!instance) {\n      return null;\n    }\n\n    var element = findDOMNode(instance);\n    return element instanceof HTMLElement ? element : null;\n  };\n\n  _proto.updateAnchorElement = function updateAnchorElement(element) {\n    var anchorElement = this.anchorElement;\n\n    if (element !== anchorElement) {\n      this.removeEventListeners(anchorElement);\n      this.anchorElement = element;\n      this.addEventListeners(element);\n    }\n  };\n\n  _proto.addEventListeners = function addEventListeners(element) {\n    if (element && element instanceof HTMLElement) {\n      element.addEventListener('mouseenter', this.handleMouseEnter);\n      element.addEventListener('mouseleave', this.handleMouseLeave);\n      element.addEventListener('click', this.handleClick);\n      element.addEventListener('focusin', this.handleFocus);\n      element.addEventListener('focusout', this.handleBlur);\n    }\n  };\n\n  _proto.removeEventListeners = function removeEventListeners(element) {\n    if (element && element instanceof HTMLElement) {\n      element.removeEventListener('mouseenter', this.handleMouseEnter);\n      element.removeEventListener('mouseleave', this.handleMouseLeave);\n      element.removeEventListener('click', this.handleClick);\n      element.removeEventListener('focusin', this.handleFocus);\n      element.removeEventListener('focusout', this.handleBlur);\n    }\n  };\n\n  _proto.renderContent = function renderContent(location) {\n    var _this3 = this;\n\n    var _this$props2 = this.props,\n        backgroundColor = _this$props2.backgroundColor,\n        disableAnimations = _this$props2.disableAnimations,\n        maxWidth = _this$props2.maxWidth,\n        hasShadow = _this$props2.hasShadow,\n        ignoreHover = _this$props2.ignoreHover,\n        opened = _this$props2.opened;\n    var children = this.renderChildren();\n\n    var _PopupHelper$getPosit = PopupHelper.getPositionObject(location.position),\n        direction = _PopupHelper$getPosit.direction;\n\n    var rootStyle = _extends({}, location.coordinates, {\n      maxWidth: maxWidth\n    });\n\n    return React.createElement(Transition, {\n      timeout: TRANSITION_TIMEOUT,\n      appear: !disableAnimations,\n      \"in\": Boolean(opened && children),\n      mountOnEnter: true,\n      unmountOnExit: true,\n      enter: !disableAnimations,\n      exit: !disableAnimations,\n      onExited: this.resetLocation\n    }, function (state) {\n      var _extends2, _ref;\n\n      return React.createElement(ZIndex, {\n        ref: _this3.refPopupElement,\n        priority: 'Popup',\n        className: cn(_extends((_extends2 = {}, _extends2[jsStyles.popup(_this3.theme)] = true, _extends2[jsStyles.shadow(_this3.theme)] = hasShadow, _extends2[jsStyles.shadowFallback(_this3.theme)] = hasShadow && (isIE11 || isEdge), _extends2[jsStyles.popupIgnoreHover()] = ignoreHover, _extends2), disableAnimations ? {} : (_ref = {}, _ref[jsStyles[\"transition-enter-\" + direction](_this3.theme)] = true, _ref[jsStyles.transitionEnter()] = state === 'entering', _ref[jsStyles.transitionEnterActive()] = state === 'entered', _ref[jsStyles.transitionExit()] = state === 'exiting', _ref))),\n        style: rootStyle,\n        onMouseEnter: _this3.handleMouseEnter,\n        onMouseLeave: _this3.handleMouseLeave\n      }, React.createElement(\"div\", {\n        className: jsStyles.content(_this3.theme),\n        \"data-tid\": 'PopupContent'\n      }, React.createElement(\"div\", {\n        className: jsStyles.contentInner(_this3.theme),\n        style: {\n          backgroundColor: backgroundColor\n        },\n        \"data-tid\": 'PopupContentInner'\n      }, children)), _this3.renderPin(location.position));\n    });\n  };\n\n  _proto.renderChildren = function renderChildren() {\n    return isFunction(this.props.children) ? this.props.children() : this.props.children;\n  };\n\n  _proto.renderPin = function renderPin(position) {\n    /**\r\n     * Box-shadow does not appear under the pin. Borders are used instead.\r\n     * In non-ie browsers drop-shadow filter is used. It is applying\r\n     * shadow to the pin too.\r\n     */\n    var isDefaultBorderColor = this.theme.popupBorderColor === POPUP_BORDER_DEFAULT_COLOR;\n    var pinBorder = isIE11 && isDefaultBorderColor ? 'rgba(0, 0, 0, 0.09)' : this.theme.popupBorderColor;\n    var _this$props3 = this.props,\n        pinSize = _this$props3.pinSize,\n        pinOffset = _this$props3.pinOffset,\n        hasShadow = _this$props3.hasShadow,\n        backgroundColor = _this$props3.backgroundColor,\n        borderColor = _this$props3.borderColor;\n    return this.props.hasPin && React.createElement(PopupPin, {\n      popupElement: this.lastPopupElement,\n      popupPosition: position,\n      size: pinSize,\n      offset: pinOffset,\n      borderWidth: hasShadow ? 1 : 0,\n      backgroundColor: backgroundColor || this.theme.popupBackground,\n      borderColor: borderColor || pinBorder\n    });\n  };\n\n  _proto.delayUpdateLocation = function delayUpdateLocation() {\n    this.cancelDelayedUpdateLocation();\n    this.locationUpdateId = raf(this.updateLocation);\n  };\n\n  _proto.cancelDelayedUpdateLocation = function cancelDelayedUpdateLocation() {\n    if (this.locationUpdateId) {\n      raf.cancel(this.locationUpdateId);\n      this.locationUpdateId = null;\n    }\n  };\n\n  _proto.locationEquals = function locationEquals(x, y) {\n    if (x === y) {\n      return true;\n    }\n\n    if (x == null || y == null) {\n      return false;\n    }\n\n    return x.coordinates.left === y.coordinates.left && x.coordinates.top === y.coordinates.top && x.position === y.position;\n  };\n\n  _proto.getLocation = function getLocation(popupElement, location) {\n    var positions = this.props.positions;\n    var anchorElement = this.anchorElement;\n    warning(anchorElement && anchorElement instanceof HTMLElement, 'Anchor element is not defined or not instance of HTMLElement');\n\n    if (!(anchorElement && anchorElement instanceof HTMLElement)) {\n      return location;\n    }\n\n    var anchorRect = PopupHelper.getElementAbsoluteRect(anchorElement);\n    var popupRect = PopupHelper.getElementAbsoluteRect(popupElement);\n    var position;\n    var coordinates;\n\n    if (location && location !== DUMMY_LOCATION && location.position) {\n      position = location.position;\n      coordinates = this.getCoordinates(anchorRect, popupRect, position);\n      var isFullyVisible = PopupHelper.isFullyVisible(coordinates, popupRect);\n      var canBecomeVisible = !isFullyVisible && PopupHelper.canBecomeFullyVisible(position, coordinates);\n\n      if (isFullyVisible || canBecomeVisible) {\n        return {\n          coordinates: coordinates,\n          position: position\n        };\n      }\n    }\n\n    for (var _iterator = positions, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n      if (_isArray) {\n        if (_i >= _iterator.length) break;\n        position = _iterator[_i++];\n      } else {\n        _i = _iterator.next();\n        if (_i.done) break;\n        position = _i.value;\n      }\n\n      coordinates = this.getCoordinates(anchorRect, popupRect, position);\n\n      if (PopupHelper.isFullyVisible(coordinates, popupRect)) {\n        return {\n          coordinates: coordinates,\n          position: position\n        };\n      }\n    }\n\n    position = positions[0];\n    coordinates = this.getCoordinates(anchorRect, popupRect, position);\n    return {\n      coordinates: coordinates,\n      position: position\n    };\n  };\n\n  _proto.getPinnedPopupOffset = function getPinnedPopupOffset(anchorRect, position) {\n    if (!this.props.hasPin || /center|middle/.test(position.align)) {\n      return 0;\n    }\n\n    var anchorSize = /top|bottom/.test(position.direction) ? anchorRect.width : anchorRect.height;\n    var _this$props4 = this.props,\n        pinOffset = _this$props4.pinOffset,\n        pinSize = _this$props4.pinSize;\n    return Math.max(0, pinOffset + pinSize - anchorSize / 2);\n  };\n\n  _proto.getCoordinates = function getCoordinates(anchorRect, popupRect, positionName) {\n    var margin = this.props.margin;\n    var position = PopupHelper.getPositionObject(positionName);\n    var popupOffset = this.props.popupOffset + this.getPinnedPopupOffset(anchorRect, position);\n\n    switch (position.direction) {\n      case 'top':\n        return {\n          top: anchorRect.top - popupRect.height - margin,\n          left: this.getHorizontalPosition(anchorRect, popupRect, position.align, popupOffset)\n        };\n\n      case 'bottom':\n        return {\n          top: anchorRect.top + anchorRect.height + margin,\n          left: this.getHorizontalPosition(anchorRect, popupRect, position.align, popupOffset)\n        };\n\n      case 'left':\n        return {\n          top: this.getVerticalPosition(anchorRect, popupRect, position.align, popupOffset),\n          left: anchorRect.left - popupRect.width - margin\n        };\n\n      case 'right':\n        return {\n          top: this.getVerticalPosition(anchorRect, popupRect, position.align, popupOffset),\n          left: anchorRect.left + anchorRect.width + margin\n        };\n\n      default:\n        throw new Error(\"Unexpected direction '\" + position.direction + \"'\");\n    }\n  };\n\n  _proto.getHorizontalPosition = function getHorizontalPosition(anchorRect, popupRect, align, popupOffset) {\n    switch (align) {\n      case 'left':\n        return anchorRect.left - popupOffset;\n\n      case 'center':\n        return anchorRect.left - (popupRect.width - anchorRect.width) / 2;\n\n      case 'right':\n        return anchorRect.left - (popupRect.width - anchorRect.width) + popupOffset;\n\n      default:\n        throw new Error(\"Unexpected align '\" + align + \"'\");\n    }\n  };\n\n  _proto.getVerticalPosition = function getVerticalPosition(anchorRect, popupRect, align, popupOffset) {\n    switch (align) {\n      case 'top':\n        return anchorRect.top - popupOffset;\n\n      case 'middle':\n        return anchorRect.top - (popupRect.height - anchorRect.height) / 2;\n\n      case 'bottom':\n        return anchorRect.top - (popupRect.height - anchorRect.height) + popupOffset;\n\n      default:\n        throw new Error(\"Unexpected align '\" + align + \"'\");\n    }\n  };\n\n  return Popup;\n}(React.Component);\nPopup.__KONTUR_REACT_UI__ = 'Popup';\nPopup.propTypes = {\n  /**\r\n   * Ссылка (ref) на элемент или React компонент, для которого рисуется попап\r\n   */\n  anchorElement: PropTypes.oneOfType([safePropTypesInstanceOf(function () {\n    return HTMLElement;\n  }), PropTypes.node]).isRequired,\n\n  /**\r\n   * Фон попапа и пина\r\n   */\n  backgroundColor: PropTypes.string,\n  children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n\n  /**\r\n   * Показывать ли пин\r\n   */\n  hasPin: PropTypes.bool,\n\n  /**\r\n   * Применять ли box-shadow на попапе. При false отключает границу на пине\r\n   */\n  hasShadow: PropTypes.bool,\n\n  /**\r\n   * Отступ попапа от элемента\r\n   */\n  margin: PropTypes.number,\n\n  /**\r\n   * Показан или скрыт попап\r\n   */\n  opened: PropTypes.bool,\n\n  /**\r\n   * Смещение пина от края попапа. Край задаётся в пропе position вторым словом\r\n   */\n  pinOffset: PropTypes.number,\n\n  /**\r\n   * Сторона пина без учёта границы.\r\n   * Пин представляет собой равносторонний треугольник, высота от попапа\r\n   * до \"носика\" пина будет соответствовать формуле (size* √3)/2\r\n   */\n  pinSize: PropTypes.number,\n\n  /**\r\n   * смещение попапа относительно родительского элемента\r\n   */\n  popupOffset: PropTypes.number,\n\n  /**\r\n   * С какой стороны показывать попап и край попапа,\r\n   * на котором будет отображаться пин\r\n   */\n  positions: PropTypes.array,\n\n  /**\r\n   * Игнорировать ли события hover/click\r\n   */\n  ignoreHover: PropTypes.bool\n};\nPopup.defaultProps = {\n  margin: 10,\n  popupOffset: 0,\n  pinSize: 8,\n  pinOffset: 16,\n  hasPin: false,\n  hasShadow: false,\n  disableAnimations: Boolean(process.env.enableReactTesting),\n  useWrapper: false,\n  ignoreHover: false\n};"]},"metadata":{},"sourceType":"module"}