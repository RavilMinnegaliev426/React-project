{"ast":null,"code":"import ReactDOM from 'react-dom';\nimport debounce from 'lodash.debounce';\nimport { isFirefox } from \"../utils\";\nvar handlers = [];\n\nfunction addHandleEvent() {\n  /**\r\n                            * Firefox do not supports 'focusin' event.\r\n                            * Focus events bubbles multiple time\r\n                            * without possibilty to cancell bubbling.\r\n                            * Using debounce to capture only first focus event\r\n                            * Mozilla Firefix\r\n                            *   ¯\\_(ツ)_/¯\r\n                            */\n  document.body.addEventListener(isFirefox ? 'focus' : 'focusin', isFirefox ? debounce(handleNativeFocus, 0, {\n    leading: true,\n    trailing: false\n  }) : handleNativeFocus, isFirefox);\n}\n\nif (typeof document !== 'undefined') {\n  if (document.readyState === 'complete') {\n    addHandleEvent();\n  } else {\n    window.addEventListener('load', addHandleEvent);\n  }\n}\n\nfunction handleNativeFocus(event) {\n  // FIXME: not safe casting\n  var target = event.target || event.srcElement;\n  handlers.forEach(function (handler) {\n    var elements = handler.elements;\n\n    if (typeof elements === 'function') {\n      elements = elements();\n    }\n\n    if (elements.some(containsTargetOrRenderContainer(target))) {\n      return;\n    }\n\n    ReactDOM.unstable_batchedUpdates(function () {\n      return handler.callback(event);\n    });\n  });\n}\n\nexport function containsTargetOrRenderContainer(target) {\n  return function (element) {\n    if (!element) {\n      return false;\n    }\n\n    if (element.contains(target)) {\n      return true;\n    }\n\n    var container = findRenderContainer(target, element);\n    return !!container && element.contains(container);\n  };\n}\n/**\r\n   * Searches RenderContainer placed in \"rootNode\" for \"node\"\r\n   */\n\nfunction findRenderContainer(node, rootNode, container) {\n  var currentNode = node.parentNode;\n\n  if (!currentNode || node === rootNode || currentNode === rootNode || currentNode === document.body || currentNode === document.documentElement || !(currentNode instanceof Element)) {\n    return container ? container : null;\n  }\n\n  var newContainerId = currentNode.getAttribute('data-rendered-container-id');\n\n  if (newContainerId) {\n    var nextNode = document.querySelector(\"[data-render-container-id~=\\\"\" + newContainerId + \"\\\"]\");\n\n    if (!nextNode) {\n      throw Error(\"Origin node for container with id \" + newContainerId + \" was not found\");\n    }\n\n    return findRenderContainer(nextNode, rootNode, nextNode);\n  }\n\n  return findRenderContainer(currentNode, rootNode, container);\n}\n\nexport function listen(elements, callback) {\n  var handler = {\n    elements: elements,\n    callback: callback\n  };\n  handlers.push(handler);\n  return {\n    remove: function remove() {\n      var index = handlers.indexOf(handler);\n\n      if (index > -1) {\n        handlers.splice(index, 1);\n      }\n    }\n  };\n}","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/lib/listenFocusOutside/listenFocusOutside.js"],"names":["ReactDOM","debounce","isFirefox","handlers","addHandleEvent","document","body","addEventListener","handleNativeFocus","leading","trailing","readyState","window","event","target","srcElement","forEach","handler","elements","some","containsTargetOrRenderContainer","unstable_batchedUpdates","callback","element","contains","container","findRenderContainer","node","rootNode","currentNode","parentNode","documentElement","Element","newContainerId","getAttribute","nextNode","querySelector","Error","listen","push","remove","index","indexOf","splice"],"mappings":"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","sourcesContent":["import ReactDOM from 'react-dom';\nimport debounce from 'lodash.debounce';\nimport { isFirefox } from \"../utils\";\nvar handlers = [];\n\nfunction addHandleEvent() {\n  /**\r\n                            * Firefox do not supports 'focusin' event.\r\n                            * Focus events bubbles multiple time\r\n                            * without possibilty to cancell bubbling.\r\n                            * Using debounce to capture only first focus event\r\n                            * Mozilla Firefix\r\n                            *   ¯\\_(ツ)_/¯\r\n                            */\n  document.body.addEventListener(isFirefox ? 'focus' : 'focusin', isFirefox ? debounce(handleNativeFocus, 0, {\n    leading: true,\n    trailing: false\n  }) : handleNativeFocus, isFirefox);\n}\n\nif (typeof document !== 'undefined') {\n  if (document.readyState === 'complete') {\n    addHandleEvent();\n  } else {\n    window.addEventListener('load', addHandleEvent);\n  }\n}\n\nfunction handleNativeFocus(event) {\n  // FIXME: not safe casting\n  var target = event.target || event.srcElement;\n  handlers.forEach(function (handler) {\n    var elements = handler.elements;\n\n    if (typeof elements === 'function') {\n      elements = elements();\n    }\n\n    if (elements.some(containsTargetOrRenderContainer(target))) {\n      return;\n    }\n\n    ReactDOM.unstable_batchedUpdates(function () {\n      return handler.callback(event);\n    });\n  });\n}\n\nexport function containsTargetOrRenderContainer(target) {\n  return function (element) {\n    if (!element) {\n      return false;\n    }\n\n    if (element.contains(target)) {\n      return true;\n    }\n\n    var container = findRenderContainer(target, element);\n    return !!container && element.contains(container);\n  };\n}\n/**\r\n   * Searches RenderContainer placed in \"rootNode\" for \"node\"\r\n   */\n\nfunction findRenderContainer(node, rootNode, container) {\n  var currentNode = node.parentNode;\n\n  if (!currentNode || node === rootNode || currentNode === rootNode || currentNode === document.body || currentNode === document.documentElement || !(currentNode instanceof Element)) {\n    return container ? container : null;\n  }\n\n  var newContainerId = currentNode.getAttribute('data-rendered-container-id');\n\n  if (newContainerId) {\n    var nextNode = document.querySelector(\"[data-render-container-id~=\\\"\" + newContainerId + \"\\\"]\");\n\n    if (!nextNode) {\n      throw Error(\"Origin node for container with id \" + newContainerId + \" was not found\");\n    }\n\n    return findRenderContainer(nextNode, rootNode, nextNode);\n  }\n\n  return findRenderContainer(currentNode, rootNode, container);\n}\n\nexport function listen(elements, callback) {\n  var handler = {\n    elements: elements,\n    callback: callback\n  };\n  handlers.push(handler);\n  return {\n    remove: function remove() {\n      var index = handlers.indexOf(handler);\n\n      if (index > -1) {\n        handlers.splice(index, 1);\n      }\n    }\n  };\n}"]},"metadata":{},"sourceType":"module"}