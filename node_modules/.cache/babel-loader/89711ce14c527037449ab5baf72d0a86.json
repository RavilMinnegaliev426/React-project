{"ast":null,"code":"import _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport { isKeyArrowVertical, isKeyEnter, isKeyEscape, isKeySpace, someKeys } from \"../../../lib/events/keyboard/identifiers\";\nimport { InternalMenu } from \"../../InternalMenu\";\nimport { Popup } from \"../../Popup\";\nimport { RenderLayer } from \"../../RenderLayer\";\nimport { PopupMenuPositions } from \"../PopupMenuPositions\";\nimport { isValidPositions } from \"../validatePositions\";\nimport { jsStyles } from \"../PopupMenu.styles\";\nexport var PopupMenuType = {\n  Dropdown: 'dropdown',\n  Tooltip: 'tooltip'\n};\nexport var PopupMenu = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(PopupMenu, _React$Component);\n\n  function PopupMenu() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      menuVisible: false,\n      firstItemShouldBeSelected: false\n    };\n    _this.captionWrapper = null;\n    _this.savedFocusableElement = null;\n    _this.menu = null;\n\n    _this.open = function () {\n      return _this.showMenu();\n    };\n\n    _this.close = function () {\n      return _this.hideMenu();\n    };\n\n    _this.refInternalMenu = function (element) {\n      return _this.menu = element;\n    };\n\n    _this.handleOpen = function () {\n      if (_this.menu) {\n        _this.menu.focus();\n      }\n    };\n\n    _this.renderCaption = function () {\n      if (typeof _this.props.caption === 'function') {\n        var caption = _this.props.caption({\n          opened: _this.state.menuVisible,\n          openMenu: _this.showMenu,\n          closeMenu: _this.hideMenu,\n          toggleMenu: _this.toggleMenu\n        });\n\n        return React.createElement(\"span\", {\n          \"data-tid\": \"PopupMenu__caption\",\n          className: jsStyles.caption(),\n          ref: function ref(element) {\n            return _this.captionWrapper = element;\n          }\n        }, caption);\n      }\n\n      return React.createElement(\"span\", {\n        \"data-tid\": \"PopupMenu__caption\",\n        onClick: _this.handleCaptionClick,\n        onKeyDown: _this.handleCaptionKeyDown,\n        ref: function ref(element) {\n          return _this.captionWrapper = element;\n        },\n        className: jsStyles.caption()\n      }, _this.props.caption);\n    };\n\n    _this.hideMenuWithoutFocusing = function () {\n      return _this.hideMenu();\n    };\n\n    _this.showMenu = function (firstItemShouldBeSelected) {\n      _this.saveFocus();\n\n      _this.setState({\n        menuVisible: true,\n        firstItemShouldBeSelected: firstItemShouldBeSelected\n      }, function () {\n        _this.handleChangeMenuVisible(false);\n      });\n    };\n\n    _this.hideMenu = function (restoreFocus) {\n      _this.setState({\n        menuVisible: false,\n        firstItemShouldBeSelected: false\n      }, function () {\n        _this.handleChangeMenuVisible(!!restoreFocus);\n      });\n    };\n\n    _this.toggleMenu = function () {\n      _this.state.menuVisible ? _this.hideMenu() : _this.showMenu();\n    };\n\n    _this.handleCaptionClick = function () {\n      _this.toggleMenu();\n    };\n\n    _this.handleCaptionKeyDown = function (e) {\n      if (someKeys(isKeyEnter, isKeySpace, isKeyArrowVertical)(e)) {\n        e.preventDefault();\n\n        _this.showMenu(true);\n      }\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (isKeyEscape(e)) {\n        var _restoreFocus = true;\n\n        _this.hideMenu(_restoreFocus);\n      }\n    };\n\n    _this.saveFocus = function () {\n      if (document) {\n        _this.savedFocusableElement = document.activeElement;\n      }\n    };\n\n    _this.restoreFocus = function () {\n      if (_this.savedFocusableElement) {\n        _this.savedFocusableElement.focus();\n\n        _this.savedFocusableElement = null;\n      }\n    };\n\n    _this.handleChangeMenuVisible = function (focusShouldBeRestored) {\n      if (focusShouldBeRestored) {\n        _this.restoreFocus();\n      }\n\n      if (typeof _this.props.onChangeMenuState === 'function') {\n        _this.props.onChangeMenuState(_this.state.menuVisible, focusShouldBeRestored);\n      }\n    };\n\n    _this.handleItemSelection = function (event) {\n      if (event.isDefaultPrevented()) {\n        return;\n      }\n\n      if (event.type === 'keydown') {\n        event.preventDefault();\n      }\n\n      var restoreFocus = event.type === 'keydown';\n\n      _this.hideMenu(restoreFocus);\n    };\n\n    return _this;\n  }\n\n  var _proto = PopupMenu.prototype;\n\n  _proto.render = function render() {\n    return React.createElement(RenderLayer, {\n      onClickOutside: this.hideMenuWithoutFocusing,\n      onFocusOutside: this.hideMenuWithoutFocusing,\n      active: this.state.menuVisible\n    }, React.createElement(\"div\", {\n      className: jsStyles.container()\n    }, this.renderCaption(), this.captionWrapper && this.props.children && React.createElement(Popup, {\n      anchorElement: this.captionWrapper,\n      opened: this.state.menuVisible,\n      hasShadow: true,\n      margin: this.props.popupMargin,\n      hasPin: this.props.popupHasPin,\n      pinOffset: this.props.popupPinOffset,\n      positions: this.getPositions(),\n      disableAnimations: this.props.disableAnimations,\n      onOpen: this.handleOpen\n    }, React.createElement(InternalMenu, {\n      hasShadow: false,\n      maxHeight: this.props.menuMaxHeight || 'none',\n      onKeyDown: this.handleKeyDown,\n      width: this.props.menuWidth || 'auto',\n      onItemClick: this.handleItemSelection,\n      cyclicSelection: false,\n      ref: this.refInternalMenu,\n      initialSelectedItemIndex: this.state.firstItemShouldBeSelected ? 0 : -1,\n      header: this.props.header,\n      footer: this.props.footer\n    }, this.props.children))));\n  };\n\n  _proto.getPositions = function getPositions() {\n    if (this.props.positions && isValidPositions(this.props.positions)) {\n      return this.props.positions;\n    }\n\n    return PopupMenuPositions;\n  };\n\n  return PopupMenu;\n}(React.Component);\nPopupMenu.__KONTUR_REACT_UI__ = 'PopupMenu';\nPopupMenu.defaultProps = {\n  positions: PopupMenuPositions,\n  type: PopupMenuType.Tooltip,\n  popupHasPin: true,\n  popupMargin: 0,\n  disableAnimations: false\n};\nPopupMenu.Type = PopupMenuType;","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/internal/PopupMenu/PopupMenu/PopupMenu.js"],"names":["_inheritsLoose","React","isKeyArrowVertical","isKeyEnter","isKeyEscape","isKeySpace","someKeys","InternalMenu","Popup","RenderLayer","PopupMenuPositions","isValidPositions","jsStyles","PopupMenuType","Dropdown","Tooltip","PopupMenu","_React$Component","_this","_len","arguments","length","args","Array","_key","call","apply","concat","state","menuVisible","firstItemShouldBeSelected","captionWrapper","savedFocusableElement","menu","open","showMenu","close","hideMenu","refInternalMenu","element","handleOpen","focus","renderCaption","props","caption","opened","openMenu","closeMenu","toggleMenu","createElement","className","ref","onClick","handleCaptionClick","onKeyDown","handleCaptionKeyDown","hideMenuWithoutFocusing","saveFocus","setState","handleChangeMenuVisible","restoreFocus","e","preventDefault","handleKeyDown","_restoreFocus","document","activeElement","focusShouldBeRestored","onChangeMenuState","handleItemSelection","event","isDefaultPrevented","type","_proto","prototype","render","onClickOutside","onFocusOutside","active","container","children","anchorElement","hasShadow","margin","popupMargin","hasPin","popupHasPin","pinOffset","popupPinOffset","positions","getPositions","disableAnimations","onOpen","maxHeight","menuMaxHeight","width","menuWidth","onItemClick","cyclicSelection","initialSelectedItemIndex","header","footer","Component","__KONTUR_REACT_UI__","defaultProps","Type"],"mappings":"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","sourcesContent":["import _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport { isKeyArrowVertical, isKeyEnter, isKeyEscape, isKeySpace, someKeys } from \"../../../lib/events/keyboard/identifiers\";\nimport { InternalMenu } from \"../../InternalMenu\";\nimport { Popup } from \"../../Popup\";\nimport { RenderLayer } from \"../../RenderLayer\";\nimport { PopupMenuPositions } from \"../PopupMenuPositions\";\nimport { isValidPositions } from \"../validatePositions\";\nimport { jsStyles } from \"../PopupMenu.styles\";\nexport var PopupMenuType = {\n  Dropdown: 'dropdown',\n  Tooltip: 'tooltip'\n};\nexport var PopupMenu =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(PopupMenu, _React$Component);\n\n  function PopupMenu() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      menuVisible: false,\n      firstItemShouldBeSelected: false\n    };\n    _this.captionWrapper = null;\n    _this.savedFocusableElement = null;\n    _this.menu = null;\n\n    _this.open = function () {\n      return _this.showMenu();\n    };\n\n    _this.close = function () {\n      return _this.hideMenu();\n    };\n\n    _this.refInternalMenu = function (element) {\n      return _this.menu = element;\n    };\n\n    _this.handleOpen = function () {\n      if (_this.menu) {\n        _this.menu.focus();\n      }\n    };\n\n    _this.renderCaption = function () {\n      if (typeof _this.props.caption === 'function') {\n        var caption = _this.props.caption({\n          opened: _this.state.menuVisible,\n          openMenu: _this.showMenu,\n          closeMenu: _this.hideMenu,\n          toggleMenu: _this.toggleMenu\n        });\n\n        return React.createElement(\"span\", {\n          \"data-tid\": \"PopupMenu__caption\",\n          className: jsStyles.caption(),\n          ref: function ref(element) {\n            return _this.captionWrapper = element;\n          }\n        }, caption);\n      }\n\n      return React.createElement(\"span\", {\n        \"data-tid\": \"PopupMenu__caption\",\n        onClick: _this.handleCaptionClick,\n        onKeyDown: _this.handleCaptionKeyDown,\n        ref: function ref(element) {\n          return _this.captionWrapper = element;\n        },\n        className: jsStyles.caption()\n      }, _this.props.caption);\n    };\n\n    _this.hideMenuWithoutFocusing = function () {\n      return _this.hideMenu();\n    };\n\n    _this.showMenu = function (firstItemShouldBeSelected) {\n      _this.saveFocus();\n\n      _this.setState({\n        menuVisible: true,\n        firstItemShouldBeSelected: firstItemShouldBeSelected\n      }, function () {\n        _this.handleChangeMenuVisible(false);\n      });\n    };\n\n    _this.hideMenu = function (restoreFocus) {\n      _this.setState({\n        menuVisible: false,\n        firstItemShouldBeSelected: false\n      }, function () {\n        _this.handleChangeMenuVisible(!!restoreFocus);\n      });\n    };\n\n    _this.toggleMenu = function () {\n      _this.state.menuVisible ? _this.hideMenu() : _this.showMenu();\n    };\n\n    _this.handleCaptionClick = function () {\n      _this.toggleMenu();\n    };\n\n    _this.handleCaptionKeyDown = function (e) {\n      if (someKeys(isKeyEnter, isKeySpace, isKeyArrowVertical)(e)) {\n        e.preventDefault();\n\n        _this.showMenu(true);\n      }\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (isKeyEscape(e)) {\n        var _restoreFocus = true;\n\n        _this.hideMenu(_restoreFocus);\n      }\n    };\n\n    _this.saveFocus = function () {\n      if (document) {\n        _this.savedFocusableElement = document.activeElement;\n      }\n    };\n\n    _this.restoreFocus = function () {\n      if (_this.savedFocusableElement) {\n        _this.savedFocusableElement.focus();\n\n        _this.savedFocusableElement = null;\n      }\n    };\n\n    _this.handleChangeMenuVisible = function (focusShouldBeRestored) {\n      if (focusShouldBeRestored) {\n        _this.restoreFocus();\n      }\n\n      if (typeof _this.props.onChangeMenuState === 'function') {\n        _this.props.onChangeMenuState(_this.state.menuVisible, focusShouldBeRestored);\n      }\n    };\n\n    _this.handleItemSelection = function (event) {\n      if (event.isDefaultPrevented()) {\n        return;\n      }\n\n      if (event.type === 'keydown') {\n        event.preventDefault();\n      }\n\n      var restoreFocus = event.type === 'keydown';\n\n      _this.hideMenu(restoreFocus);\n    };\n\n    return _this;\n  }\n\n  var _proto = PopupMenu.prototype;\n\n  _proto.render = function render() {\n    return React.createElement(RenderLayer, {\n      onClickOutside: this.hideMenuWithoutFocusing,\n      onFocusOutside: this.hideMenuWithoutFocusing,\n      active: this.state.menuVisible\n    }, React.createElement(\"div\", {\n      className: jsStyles.container()\n    }, this.renderCaption(), this.captionWrapper && this.props.children && React.createElement(Popup, {\n      anchorElement: this.captionWrapper,\n      opened: this.state.menuVisible,\n      hasShadow: true,\n      margin: this.props.popupMargin,\n      hasPin: this.props.popupHasPin,\n      pinOffset: this.props.popupPinOffset,\n      positions: this.getPositions(),\n      disableAnimations: this.props.disableAnimations,\n      onOpen: this.handleOpen\n    }, React.createElement(InternalMenu, {\n      hasShadow: false,\n      maxHeight: this.props.menuMaxHeight || 'none',\n      onKeyDown: this.handleKeyDown,\n      width: this.props.menuWidth || 'auto',\n      onItemClick: this.handleItemSelection,\n      cyclicSelection: false,\n      ref: this.refInternalMenu,\n      initialSelectedItemIndex: this.state.firstItemShouldBeSelected ? 0 : -1,\n      header: this.props.header,\n      footer: this.props.footer\n    }, this.props.children))));\n  };\n\n  _proto.getPositions = function getPositions() {\n    if (this.props.positions && isValidPositions(this.props.positions)) {\n      return this.props.positions;\n    }\n\n    return PopupMenuPositions;\n  };\n\n  return PopupMenu;\n}(React.Component);\nPopupMenu.__KONTUR_REACT_UI__ = 'PopupMenu';\nPopupMenu.defaultProps = {\n  positions: PopupMenuPositions,\n  type: PopupMenuType.Tooltip,\n  popupHasPin: true,\n  popupMargin: 0,\n  disableAnimations: false\n};\nPopupMenu.Type = PopupMenuType;"]},"metadata":{},"sourceType":"module"}