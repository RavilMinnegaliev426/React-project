{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport normalizeWheel from 'normalize-wheel';\nimport { MAX_DATE, MAX_MONTH, MAX_YEAR, MIN_DATE, MIN_MONTH, MIN_YEAR } from \"../../../lib/date/constants\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { Animation } from \"../../../lib/animation\";\nimport { config } from \"../config\";\nimport * as CalendarUtils from \"../CalendarUtils\";\nimport { MonthViewModel } from \"../MonthViewModel\";\nimport * as CalendarScrollEvents from \"../CalendarScrollEvents\";\nimport { Month } from \"../Month\";\nimport { jsStyles } from \"../Calendar.styles\";\nimport { create, isGreater, isLess } from \"../CalendarDateShape\";\n\nvar getTodayDate = function getTodayDate() {\n  var date = new Date();\n  return {\n    date: date.getDate(),\n    month: date.getMonth(),\n    year: date.getFullYear()\n  };\n};\n\nvar wrapperStyle = {\n  height: config.WRAPPER_HEIGHT\n};\nexport var Calendar = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(Calendar, _React$Component);\n\n  function Calendar(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.theme = void 0;\n    _this.wheelEndTimeout = void 0;\n    _this.root = void 0;\n    _this.animation = Animation();\n\n    _this.scrollToMonth = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(month, year) {\n        var _this$props, minDate, maxDate, currentMonth, diffInMonths, maxMonthsToAdd, onEnd, isYearChanges, monthsToPrependCount, monthsToPrepend, monthsToAppendCount, monthsToAppend;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!_this.animation.inProgress()) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _this.animation.finish(); // FIXME: Dirty hack to await batched updates\n\n\n                _context.next = 4;\n                return new Promise(function (r) {\n                  return setTimeout(r);\n                });\n\n              case 4:\n                _this$props = _this.props, minDate = _this$props.minDate, maxDate = _this$props.maxDate;\n\n                if (!(minDate && isGreater(minDate, create(32, month, year)))) {\n                  _context.next = 8;\n                  break;\n                }\n\n                _this.scrollToMonth(minDate.month, minDate.year);\n\n                return _context.abrupt(\"return\");\n\n              case 8:\n                if (!(maxDate && isLess(maxDate, create(0, month, year)))) {\n                  _context.next = 11;\n                  break;\n                }\n\n                _this.scrollToMonth(maxDate.month, maxDate.year);\n\n                return _context.abrupt(\"return\");\n\n              case 11:\n                currentMonth = _this.state.months[1];\n                diffInMonths = currentMonth.month + currentMonth.year * 12 - month - year * 12;\n\n                if (!(diffInMonths === 0)) {\n                  _context.next = 16;\n                  break;\n                }\n\n                _this.scrollTo(0);\n\n                return _context.abrupt(\"return\");\n\n              case 16:\n                maxMonthsToAdd = config.MAX_MONTHS_TO_APPEND_ON_SCROLL;\n\n                onEnd = function onEnd() {\n                  return _this.setState({\n                    months: CalendarUtils.getMonths(month, year),\n                    scrollPosition: 0\n                  });\n                };\n\n                isYearChanges = function isYearChanges(state) {\n                  return state.months[1].year !== year && // if diff in months is 2 or less,\n                  // either year is not changing either months already\n                  // have right isFirstInYear/isLastInYear flags\n                  Math.abs(diffInMonths) > 2;\n                }; // If scrolling upwards, prepend maximum maxMonthsToAdd months\n                // and scroll to the first month\n\n\n                if (diffInMonths > 0) {\n                  monthsToPrependCount = Math.min(Math.abs(diffInMonths) - 1, maxMonthsToAdd);\n                  monthsToPrepend = Array.from({\n                    length: monthsToPrependCount\n                  }, function (_, index) {\n                    return MonthViewModel.create(month + index, year);\n                  });\n\n                  _this.setState(function (state) {\n                    var yearChanges = isYearChanges(state);\n\n                    if (yearChanges) {\n                      // Mutating here can lead to some unexpected bugs\n                      // but we couldn't find any yet\n                      state.months[0].isFirstInYear = true;\n\n                      if (monthsToPrepend.length) {\n                        // Mutating item here is safe as it was just created\n                        monthsToPrepend[monthsToPrepend.length - 1].isLastInYear = true;\n                      }\n                    }\n\n                    return {\n                      months: monthsToPrepend.concat(state.months),\n                      scrollPosition: -CalendarUtils.getMonthsHeight(monthsToPrepend)\n                    };\n                  }, function () {\n                    var targetPosition = _this.state.months[0].height;\n\n                    _this.scrollTo(targetPosition, onEnd);\n                  });\n                } // If scrolling downwards, append maximum maxMonthsToAdd months\n                // and scroll to the last but one month\n\n\n                if (diffInMonths < 0) {\n                  monthsToAppendCount = Math.min(Math.abs(diffInMonths), maxMonthsToAdd);\n                  monthsToAppend = Array.from({\n                    length: monthsToAppendCount\n                  }, function (_, index) {\n                    return MonthViewModel.create(month + index - monthsToAppendCount + 2, year);\n                  });\n\n                  _this.setState(function (state) {\n                    if (isYearChanges(state)) {\n                      // Mutating here can lead to some unexpected bugs\n                      // but we couldn't find any yet\n                      state.months[state.months.length - 1].isLastInYear = true; // Mutating item here is safe as it was just created\n\n                      if (monthsToAppend[0]) {\n                        monthsToAppend[0].isFirstInYear = true;\n                      }\n                    }\n\n                    return {\n                      months: state.months.concat(monthsToAppend)\n                    };\n                  }, function () {\n                    var targetPosition = -1 * CalendarUtils.getMonthsHeight(_this.state.months.slice(1, -2));\n\n                    _this.scrollTo(targetPosition, onEnd);\n                  });\n                }\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.renderMain = function () {\n      var positions = _this.getMonthPositions();\n\n      return React.createElement(\"div\", {\n        ref: _this.refRoot,\n        className: jsStyles.root(_this.theme)\n      }, React.createElement(\"div\", {\n        style: wrapperStyle,\n        className: jsStyles.wrapper()\n      }, _this.state.months.map(function (x, i) {\n        return [positions[i], x];\n      }).filter(function (_ref2) {\n        var top = _ref2[0],\n            month = _ref2[1];\n        return CalendarUtils.isMonthVisible(top, month);\n      }).map(_this.renderMonth, _assertThisInitialized(_this))));\n    };\n\n    _this.refRoot = function (element) {\n      if (!_this.root && element) {\n        element.addEventListener('wheel', _this.handleWheel, {\n          passive: false\n        });\n      }\n\n      if (_this.root && !element) {\n        _this.root.removeEventListener('wheel', _this.handleWheel);\n      }\n\n      _this.root = element;\n    };\n\n    _this.handleMonthYearChange = function (month, year) {\n      _this.scrollToMonth(month, year);\n    };\n\n    _this.handleWheel = function (event) {\n      if (!(event instanceof WheelEvent)) {\n        return;\n      }\n\n      event.preventDefault();\n\n      var _normalizeWheel = normalizeWheel(event),\n          pixelY = _normalizeWheel.pixelY;\n\n      _this.setState(function (_ref3) {\n        var months = _ref3.months,\n            scrollPosition = _ref3.scrollPosition,\n            scrollTarget = _ref3.scrollTarget;\n        var targetPosition = CalendarUtils.calculateScrollPosition(months, scrollPosition, pixelY).scrollPosition;\n        return {\n          scrollTarget: targetPosition\n        };\n      }, _this.handleWheelEnd);\n\n      _this.animation.animate(pixelY, function (deltaY) {\n        return (// FIXME: Typescript not resolving setState cb type\n          _this.setState(CalendarUtils.applyDelta(deltaY))\n        );\n      });\n\n      CalendarScrollEvents.emit();\n    };\n\n    _this.handleWheelEnd = function () {\n      if (_this.wheelEndTimeout) {\n        clearTimeout(_this.wheelEndTimeout);\n      }\n\n      _this.wheelEndTimeout = window.setTimeout(_this.scrollToNearestWeek, 300);\n    };\n\n    _this.scrollToNearestWeek = function () {\n      var _this$state = _this.state,\n          scrollTarget = _this$state.scrollTarget,\n          scrollDirection = _this$state.scrollDirection;\n      var trasholdHeight = config.MONTH_TITLE_OFFSET_HEIGHT + config.DAY_HEIGHT;\n\n      if (scrollTarget < trasholdHeight) {\n        var targetPosition = 0;\n\n        if (scrollDirection < 0) {\n          targetPosition = trasholdHeight;\n        }\n\n        _this.setState({\n          scrollTarget: targetPosition\n        }, function () {\n          var amount = scrollTarget - targetPosition;\n\n          _this.animation.animate(amount, function (deltaY) {\n            return (// FIXME: Typescript not resolving setState cb type\n              _this.setState(CalendarUtils.applyDelta(deltaY))\n            );\n          });\n        });\n      }\n    };\n\n    _this.scrollTo = function (pos, onEnd) {\n      var scrollAmmount = pos - _this.state.scrollPosition;\n      return _this.scrollAmount(scrollAmmount, onEnd);\n    };\n\n    _this.scrollAmount = function (scrollAmmount, onEnd) {\n      return _this.animation.animate(scrollAmmount, function (deltaY) {\n        return _this.setState(function (_ref4) {\n          var scrollPosition = _ref4.scrollPosition;\n          return {\n            scrollPosition: scrollPosition + deltaY\n          };\n        });\n      }, onEnd);\n    };\n\n    var today = getTodayDate();\n    var initialMonth = props.initialMonth == null ? today.month : props.initialMonth;\n    var initialYear = props.initialYear == null ? today.year : props.initialYear;\n    _this.state = {\n      scrollPosition: 0,\n      months: CalendarUtils.getMonths(initialMonth, initialYear),\n      today: today,\n      scrollDirection: 1,\n      scrollTarget: 0\n    };\n    return _this;\n  }\n\n  var _proto = Calendar.prototype;\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    if (this.animation.inProgress()) {\n      this.animation.cancel();\n    }\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  }\n  /**\r\n   * Scrolls calendar to given date\r\n   * @public\r\n   */\n  ;\n\n  _proto.renderMonth = function renderMonth(_ref5) {\n    var top = _ref5[0],\n        month = _ref5[1];\n    return React.createElement(Month, {\n      key: month.month + '-' + month.year,\n      top: top,\n      month: month,\n      maxDate: this.props.maxDate,\n      minDate: this.props.minDate,\n      today: this.state.today,\n      value: this.props.value,\n      onDateClick: this.props.onSelect,\n      onMonthYearChange: this.handleMonthYearChange,\n      isHoliday: this.props.isHoliday\n    });\n  };\n\n  _proto.getMonthPositions = function getMonthPositions() {\n    var _this$state2 = this.state,\n        scrollPosition = _this$state2.scrollPosition,\n        months = _this$state2.months;\n    var positions = [scrollPosition - months[0].height];\n\n    for (var i = 1; i < months.length; i++) {\n      var position = positions[i - 1] + months[i - 1].height;\n      positions.push(position);\n    }\n\n    return positions;\n  };\n\n  return Calendar;\n}(React.Component);\nCalendar.__KONTUR_REACT_UI__ = 'Calendar';\nCalendar.defaultProps = {\n  holidays: [],\n  minDate: {\n    year: MIN_YEAR,\n    month: MIN_MONTH,\n    date: MIN_DATE\n  },\n  maxDate: {\n    year: MAX_YEAR,\n    month: MAX_MONTH,\n    date: MAX_DATE\n  }\n};","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/internal/Calendar/Calendar/Calendar.js"],"names":["_regeneratorRuntime","_asyncToGenerator","_assertThisInitialized","_inheritsLoose","React","normalizeWheel","MAX_DATE","MAX_MONTH","MAX_YEAR","MIN_DATE","MIN_MONTH","MIN_YEAR","ThemeContext","Animation","config","CalendarUtils","MonthViewModel","CalendarScrollEvents","Month","jsStyles","create","isGreater","isLess","getTodayDate","date","Date","getDate","month","getMonth","year","getFullYear","wrapperStyle","height","WRAPPER_HEIGHT","Calendar","_React$Component","props","_this","call","theme","wheelEndTimeout","root","animation","scrollToMonth","_ref","mark","_callee","_this$props","minDate","maxDate","currentMonth","diffInMonths","maxMonthsToAdd","onEnd","isYearChanges","monthsToPrependCount","monthsToPrepend","monthsToAppendCount","monthsToAppend","wrap","_callee$","_context","prev","next","inProgress","finish","Promise","r","setTimeout","abrupt","state","months","scrollTo","MAX_MONTHS_TO_APPEND_ON_SCROLL","setState","getMonths","scrollPosition","Math","abs","min","Array","from","length","_","index","yearChanges","isFirstInYear","isLastInYear","concat","getMonthsHeight","targetPosition","slice","stop","_x","_x2","apply","arguments","renderMain","positions","getMonthPositions","createElement","ref","refRoot","className","style","wrapper","map","x","i","filter","_ref2","top","isMonthVisible","renderMonth","element","addEventListener","handleWheel","passive","removeEventListener","handleMonthYearChange","event","WheelEvent","preventDefault","_normalizeWheel","pixelY","_ref3","scrollTarget","calculateScrollPosition","handleWheelEnd","animate","deltaY","applyDelta","emit","clearTimeout","window","scrollToNearestWeek","_this$state","scrollDirection","trasholdHeight","MONTH_TITLE_OFFSET_HEIGHT","DAY_HEIGHT","amount","pos","scrollAmmount","scrollAmount","_ref4","today","initialMonth","initialYear","_proto","prototype","componentWillUnmount","cancel","render","_this2","Consumer","_ref5","key","value","onDateClick","onSelect","onMonthYearChange","isHoliday","_this$state2","position","push","Component","__KONTUR_REACT_UI__","defaultProps","holidays"],"mappings":"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","sourcesContent":["import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport normalizeWheel from 'normalize-wheel';\nimport { MAX_DATE, MAX_MONTH, MAX_YEAR, MIN_DATE, MIN_MONTH, MIN_YEAR } from \"../../../lib/date/constants\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { Animation } from \"../../../lib/animation\";\nimport { config } from \"../config\";\nimport * as CalendarUtils from \"../CalendarUtils\";\nimport { MonthViewModel } from \"../MonthViewModel\";\nimport * as CalendarScrollEvents from \"../CalendarScrollEvents\";\nimport { Month } from \"../Month\";\nimport { jsStyles } from \"../Calendar.styles\";\nimport { create, isGreater, isLess } from \"../CalendarDateShape\";\n\nvar getTodayDate = function getTodayDate() {\n  var date = new Date();\n  return {\n    date: date.getDate(),\n    month: date.getMonth(),\n    year: date.getFullYear()\n  };\n};\n\nvar wrapperStyle = {\n  height: config.WRAPPER_HEIGHT\n};\nexport var Calendar =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(Calendar, _React$Component);\n\n  function Calendar(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.theme = void 0;\n    _this.wheelEndTimeout = void 0;\n    _this.root = void 0;\n    _this.animation = Animation();\n\n    _this.scrollToMonth =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(month, year) {\n        var _this$props, minDate, maxDate, currentMonth, diffInMonths, maxMonthsToAdd, onEnd, isYearChanges, monthsToPrependCount, monthsToPrepend, monthsToAppendCount, monthsToAppend;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!_this.animation.inProgress()) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _this.animation.finish(); // FIXME: Dirty hack to await batched updates\n\n\n                _context.next = 4;\n                return new Promise(function (r) {\n                  return setTimeout(r);\n                });\n\n              case 4:\n                _this$props = _this.props, minDate = _this$props.minDate, maxDate = _this$props.maxDate;\n\n                if (!(minDate && isGreater(minDate, create(32, month, year)))) {\n                  _context.next = 8;\n                  break;\n                }\n\n                _this.scrollToMonth(minDate.month, minDate.year);\n\n                return _context.abrupt(\"return\");\n\n              case 8:\n                if (!(maxDate && isLess(maxDate, create(0, month, year)))) {\n                  _context.next = 11;\n                  break;\n                }\n\n                _this.scrollToMonth(maxDate.month, maxDate.year);\n\n                return _context.abrupt(\"return\");\n\n              case 11:\n                currentMonth = _this.state.months[1];\n                diffInMonths = currentMonth.month + currentMonth.year * 12 - month - year * 12;\n\n                if (!(diffInMonths === 0)) {\n                  _context.next = 16;\n                  break;\n                }\n\n                _this.scrollTo(0);\n\n                return _context.abrupt(\"return\");\n\n              case 16:\n                maxMonthsToAdd = config.MAX_MONTHS_TO_APPEND_ON_SCROLL;\n\n                onEnd = function onEnd() {\n                  return _this.setState({\n                    months: CalendarUtils.getMonths(month, year),\n                    scrollPosition: 0\n                  });\n                };\n\n                isYearChanges = function isYearChanges(state) {\n                  return state.months[1].year !== year && // if diff in months is 2 or less,\n                  // either year is not changing either months already\n                  // have right isFirstInYear/isLastInYear flags\n                  Math.abs(diffInMonths) > 2;\n                }; // If scrolling upwards, prepend maximum maxMonthsToAdd months\n                // and scroll to the first month\n\n\n                if (diffInMonths > 0) {\n                  monthsToPrependCount = Math.min(Math.abs(diffInMonths) - 1, maxMonthsToAdd);\n                  monthsToPrepend = Array.from({\n                    length: monthsToPrependCount\n                  }, function (_, index) {\n                    return MonthViewModel.create(month + index, year);\n                  });\n\n                  _this.setState(function (state) {\n                    var yearChanges = isYearChanges(state);\n\n                    if (yearChanges) {\n                      // Mutating here can lead to some unexpected bugs\n                      // but we couldn't find any yet\n                      state.months[0].isFirstInYear = true;\n\n                      if (monthsToPrepend.length) {\n                        // Mutating item here is safe as it was just created\n                        monthsToPrepend[monthsToPrepend.length - 1].isLastInYear = true;\n                      }\n                    }\n\n                    return {\n                      months: monthsToPrepend.concat(state.months),\n                      scrollPosition: -CalendarUtils.getMonthsHeight(monthsToPrepend)\n                    };\n                  }, function () {\n                    var targetPosition = _this.state.months[0].height;\n\n                    _this.scrollTo(targetPosition, onEnd);\n                  });\n                } // If scrolling downwards, append maximum maxMonthsToAdd months\n                // and scroll to the last but one month\n\n\n                if (diffInMonths < 0) {\n                  monthsToAppendCount = Math.min(Math.abs(diffInMonths), maxMonthsToAdd);\n                  monthsToAppend = Array.from({\n                    length: monthsToAppendCount\n                  }, function (_, index) {\n                    return MonthViewModel.create(month + index - monthsToAppendCount + 2, year);\n                  });\n\n                  _this.setState(function (state) {\n                    if (isYearChanges(state)) {\n                      // Mutating here can lead to some unexpected bugs\n                      // but we couldn't find any yet\n                      state.months[state.months.length - 1].isLastInYear = true; // Mutating item here is safe as it was just created\n\n                      if (monthsToAppend[0]) {\n                        monthsToAppend[0].isFirstInYear = true;\n                      }\n                    }\n\n                    return {\n                      months: state.months.concat(monthsToAppend)\n                    };\n                  }, function () {\n                    var targetPosition = -1 * CalendarUtils.getMonthsHeight(_this.state.months.slice(1, -2));\n\n                    _this.scrollTo(targetPosition, onEnd);\n                  });\n                }\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.renderMain = function () {\n      var positions = _this.getMonthPositions();\n\n      return React.createElement(\"div\", {\n        ref: _this.refRoot,\n        className: jsStyles.root(_this.theme)\n      }, React.createElement(\"div\", {\n        style: wrapperStyle,\n        className: jsStyles.wrapper()\n      }, _this.state.months.map(function (x, i) {\n        return [positions[i], x];\n      }).filter(function (_ref2) {\n        var top = _ref2[0],\n            month = _ref2[1];\n        return CalendarUtils.isMonthVisible(top, month);\n      }).map(_this.renderMonth, _assertThisInitialized(_this))));\n    };\n\n    _this.refRoot = function (element) {\n      if (!_this.root && element) {\n        element.addEventListener('wheel', _this.handleWheel, {\n          passive: false\n        });\n      }\n\n      if (_this.root && !element) {\n        _this.root.removeEventListener('wheel', _this.handleWheel);\n      }\n\n      _this.root = element;\n    };\n\n    _this.handleMonthYearChange = function (month, year) {\n      _this.scrollToMonth(month, year);\n    };\n\n    _this.handleWheel = function (event) {\n      if (!(event instanceof WheelEvent)) {\n        return;\n      }\n\n      event.preventDefault();\n\n      var _normalizeWheel = normalizeWheel(event),\n          pixelY = _normalizeWheel.pixelY;\n\n      _this.setState(function (_ref3) {\n        var months = _ref3.months,\n            scrollPosition = _ref3.scrollPosition,\n            scrollTarget = _ref3.scrollTarget;\n        var targetPosition = CalendarUtils.calculateScrollPosition(months, scrollPosition, pixelY).scrollPosition;\n        return {\n          scrollTarget: targetPosition\n        };\n      }, _this.handleWheelEnd);\n\n      _this.animation.animate(pixelY, function (deltaY) {\n        return (// FIXME: Typescript not resolving setState cb type\n          _this.setState(CalendarUtils.applyDelta(deltaY))\n        );\n      });\n\n      CalendarScrollEvents.emit();\n    };\n\n    _this.handleWheelEnd = function () {\n      if (_this.wheelEndTimeout) {\n        clearTimeout(_this.wheelEndTimeout);\n      }\n\n      _this.wheelEndTimeout = window.setTimeout(_this.scrollToNearestWeek, 300);\n    };\n\n    _this.scrollToNearestWeek = function () {\n      var _this$state = _this.state,\n          scrollTarget = _this$state.scrollTarget,\n          scrollDirection = _this$state.scrollDirection;\n      var trasholdHeight = config.MONTH_TITLE_OFFSET_HEIGHT + config.DAY_HEIGHT;\n\n      if (scrollTarget < trasholdHeight) {\n        var targetPosition = 0;\n\n        if (scrollDirection < 0) {\n          targetPosition = trasholdHeight;\n        }\n\n        _this.setState({\n          scrollTarget: targetPosition\n        }, function () {\n          var amount = scrollTarget - targetPosition;\n\n          _this.animation.animate(amount, function (deltaY) {\n            return (// FIXME: Typescript not resolving setState cb type\n              _this.setState(CalendarUtils.applyDelta(deltaY))\n            );\n          });\n        });\n      }\n    };\n\n    _this.scrollTo = function (pos, onEnd) {\n      var scrollAmmount = pos - _this.state.scrollPosition;\n      return _this.scrollAmount(scrollAmmount, onEnd);\n    };\n\n    _this.scrollAmount = function (scrollAmmount, onEnd) {\n      return _this.animation.animate(scrollAmmount, function (deltaY) {\n        return _this.setState(function (_ref4) {\n          var scrollPosition = _ref4.scrollPosition;\n          return {\n            scrollPosition: scrollPosition + deltaY\n          };\n        });\n      }, onEnd);\n    };\n\n    var today = getTodayDate();\n    var initialMonth = props.initialMonth == null ? today.month : props.initialMonth;\n    var initialYear = props.initialYear == null ? today.year : props.initialYear;\n    _this.state = {\n      scrollPosition: 0,\n      months: CalendarUtils.getMonths(initialMonth, initialYear),\n      today: today,\n      scrollDirection: 1,\n      scrollTarget: 0\n    };\n    return _this;\n  }\n\n  var _proto = Calendar.prototype;\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    if (this.animation.inProgress()) {\n      this.animation.cancel();\n    }\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  }\n  /**\r\n   * Scrolls calendar to given date\r\n   * @public\r\n   */\n  ;\n\n  _proto.renderMonth = function renderMonth(_ref5) {\n    var top = _ref5[0],\n        month = _ref5[1];\n    return React.createElement(Month, {\n      key: month.month + '-' + month.year,\n      top: top,\n      month: month,\n      maxDate: this.props.maxDate,\n      minDate: this.props.minDate,\n      today: this.state.today,\n      value: this.props.value,\n      onDateClick: this.props.onSelect,\n      onMonthYearChange: this.handleMonthYearChange,\n      isHoliday: this.props.isHoliday\n    });\n  };\n\n  _proto.getMonthPositions = function getMonthPositions() {\n    var _this$state2 = this.state,\n        scrollPosition = _this$state2.scrollPosition,\n        months = _this$state2.months;\n    var positions = [scrollPosition - months[0].height];\n\n    for (var i = 1; i < months.length; i++) {\n      var position = positions[i - 1] + months[i - 1].height;\n      positions.push(position);\n    }\n\n    return positions;\n  };\n\n  return Calendar;\n}(React.Component);\nCalendar.__KONTUR_REACT_UI__ = 'Calendar';\nCalendar.defaultProps = {\n  holidays: [],\n  minDate: {\n    year: MIN_YEAR,\n    month: MIN_MONTH,\n    date: MIN_DATE\n  },\n  maxDate: {\n    year: MAX_YEAR,\n    month: MAX_MONTH,\n    date: MAX_DATE\n  }\n};"]},"metadata":{},"sourceType":"module"}