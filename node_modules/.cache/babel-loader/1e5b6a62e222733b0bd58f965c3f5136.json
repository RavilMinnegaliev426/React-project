{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\n\nvar _dec, _class, _class2, _temp;\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cn from 'classnames';\nimport { isKeyEscape } from \"../../../lib/events/keyboard/identifiers\";\nimport { DatePickerLocaleHelper } from \"../../../components/DatePicker/locale\";\nimport { locale } from \"../../../lib/locale/decorators\";\nimport { RenderLayer } from \"../../RenderLayer\";\nimport { DropdownContainer } from \"../../DropdownContainer\";\nimport * as LayoutEvents from \"../../../lib/LayoutEvents\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { ArrowTriangleDownIcon, ArrowTriangleUpDownIcon, ArrowTriangleUpIcon } from \"../../icons/16px\";\nimport { jsStyles } from \"../DateSelect.styles\";\nvar itemHeight = 24;\nvar visibleYearsCount = 11;\nvar itemsToMoveCount = -5;\nvar monthsCount = 12;\nvar defaultMinYear = 1900;\nvar defaultMaxYear = 2100;\nexport var DateSelect = (_dec = locale('DatePicker', DatePickerLocaleHelper), _dec(_class = (_temp = _class2 = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(DateSelect, _React$Component);\n\n  function DateSelect() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      botCapped: false,\n      current: 0,\n      height: 0,\n      opened: false,\n      pos: 0,\n      top: 0,\n      topCapped: false,\n      nodeTop: Infinity\n    };\n    _this.theme = void 0;\n    _this.locale = void 0;\n    _this.root = null;\n    _this.itemsContainer = null;\n    _this.listener = void 0;\n    _this.timeout = void 0;\n    _this.longClickTimer = 0;\n    _this.setPositionRepeatTimer = 0;\n    _this.yearStep = 3;\n\n    _this.open = function () {\n      if (_this.props.disabled) {\n        return;\n      }\n\n      if (_this.state.opened) {\n        return;\n      }\n\n      _this.setPosition(0);\n\n      _this.setState({\n        opened: true,\n        current: 0\n      });\n    };\n\n    _this.close = function () {\n      if (!_this.state.opened) {\n        return;\n      }\n\n      _this.setState({\n        opened: false\n      });\n    };\n\n    _this.refRoot = function (element) {\n      _this.root = element;\n    };\n\n    _this.setNodeTop = function () {\n      var root = _this.root;\n\n      if (!root) {\n        return;\n      }\n\n      if (_this.timeout) {\n        clearTimeout(_this.timeout);\n      }\n\n      _this.timeout = setTimeout(function () {\n        return _this.setState({\n          nodeTop: root.getBoundingClientRect().top\n        });\n      });\n    };\n\n    _this.refItemsContainer = function (element) {\n      if (!_this.itemsContainer && element) {\n        element.addEventListener('wheel', _this.handleWheel, {\n          passive: false\n        });\n      }\n\n      if (_this.itemsContainer && !element) {\n        _this.itemsContainer.removeEventListener('wheel', _this.handleWheel);\n      }\n\n      _this.itemsContainer = element;\n    };\n\n    _this.handleLongClickUp = function (event) {\n      event.preventDefault();\n      _this.longClickTimer = window.setTimeout(function () {\n        _this.setPositionRepeatTimer = window.setInterval(function () {\n          return _this.setPosition(_this.state.pos - itemHeight);\n        }, 100);\n      }, 200);\n    };\n\n    _this.handleLongClickDown = function (event) {\n      event.preventDefault();\n      _this.longClickTimer = window.setTimeout(function () {\n        _this.setPositionRepeatTimer = window.setInterval(function () {\n          return _this.setPosition(_this.state.pos + itemHeight);\n        }, 100);\n      }, 200);\n    };\n\n    _this.handleLongClickStop = function () {\n      clearTimeout(_this.longClickTimer);\n      clearTimeout(_this.setPositionRepeatTimer);\n    };\n\n    _this.getAnchor = function () {\n      return _this.root;\n    };\n\n    _this.handleWheel = function (event) {\n      if (!(event instanceof WheelEvent)) {\n        return;\n      }\n\n      event.preventDefault();\n      event.stopPropagation();\n      var deltaY = event.deltaY;\n\n      if (event.deltaMode === 1) {\n        deltaY *= itemHeight;\n      } else if (event.deltaMode === 2) {\n        deltaY *= itemHeight * 4;\n      }\n\n      var pos = _this.state.pos + deltaY;\n\n      _this.setPosition(pos);\n    };\n\n    _this.handleItemClick = function (shift) {\n      return function (e) {\n        var value = _this.props.value + shift;\n\n        if (_this.props.onValueChange) {\n          _this.props.onValueChange(value);\n        }\n\n        _this.setState({\n          opened: false\n        });\n      };\n    };\n\n    _this.handleKey = function (e) {\n      if (_this.state.opened && isKeyEscape(e)) {\n        e.preventDefault();\n\n        _this.close();\n\n        e.stopPropagation();\n      }\n    };\n\n    _this.handleUp = function (event) {\n      event.preventDefault();\n\n      _this.setPosition(_this.state.pos - itemHeight * _this.yearStep);\n    };\n\n    _this.handleDown = function (event) {\n      event.preventDefault();\n\n      _this.setPosition(_this.state.pos + itemHeight * _this.yearStep);\n    };\n\n    return _this;\n  }\n\n  var _proto = DateSelect.prototype;\n\n  _proto.UNSAFE_componentWillReceiveProps = function UNSAFE_componentWillReceiveProps() {\n    this.setNodeTop();\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.listener = LayoutEvents.addListener(this.setNodeTop);\n    this.setNodeTop();\n    window.addEventListener('keydown', this.handleKey);\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    if (this.listener) {\n      this.listener.remove();\n    }\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n\n    if (this.longClickTimer) {\n      clearTimeout(this.longClickTimer);\n    }\n\n    if (this.setPositionRepeatTimer) {\n      clearTimeout(this.setPositionRepeatTimer);\n    }\n\n    window.removeEventListener('keydown', this.handleKey);\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var _cn, _cn2;\n\n    var _this$props = this.props,\n        width = _this$props.width,\n        disabled = _this$props.disabled;\n    var rootProps = {\n      className: cn((_cn = {}, _cn[jsStyles.root(this.theme)] = true, _cn[jsStyles.disabled()] = Boolean(disabled), _cn)),\n      style: {\n        width: width\n      },\n      ref: this.refRoot\n    };\n    return React.createElement(\"span\", rootProps, React.createElement(\"div\", {\n      \"data-tid\": \"DateSelect__caption\",\n      className: jsStyles.caption(),\n      onClick: this.open\n    }, this.getItem(0), React.createElement(\"div\", {\n      className: cn((_cn2 = {}, _cn2[jsStyles.arrow(this.theme)] = true, _cn2[jsStyles.arrowDisabled()] = Boolean(disabled), _cn2))\n    }, React.createElement(ArrowTriangleUpDownIcon, {\n      size: 12\n    }))), this.state.opened && this.renderMenu());\n  };\n\n  _proto.disableItems = function disableItems(index) {\n    var value = this.props.value + index;\n\n    if (this.props.maxValue != null && this.props.minValue != null) {\n      return value > this.props.maxValue || value < this.props.minValue;\n    }\n\n    if (this.props.minValue != null) {\n      return value < this.props.minValue;\n    }\n\n    if (this.props.maxValue != null) {\n      return value > this.props.maxValue;\n    }\n  };\n\n  _proto.renderMenu = function renderMenu() {\n    var _this3 = this,\n        _cn3;\n\n    var _this$state = this.state,\n        top = _this$state.top,\n        height = _this$state.height,\n        nodeTop = _this$state.nodeTop;\n    var shift = this.state.pos % itemHeight;\n\n    if (shift < 0) {\n      shift += itemHeight;\n    }\n\n    var from = (this.state.pos - shift + top) / itemHeight;\n    var to = from + Math.ceil((height + shift) / itemHeight);\n    var items = [];\n\n    var _loop = function _loop(i) {\n      var _cn4;\n\n      var disableItems = _this3.disableItems(i) || false;\n      var className = cn((_cn4 = {}, _cn4[jsStyles.menuItem(_this3.theme)] = true, _cn4[jsStyles.menuItemSelected(_this3.theme)] = i === 0, _cn4[jsStyles.menuItemActive(_this3.theme)] = i === _this3.state.current, _cn4[jsStyles.menuItemDisabled(_this3.theme)] = disableItems, _cn4));\n      var clickHandler = {\n        onMouseDown: preventDefault,\n        onClick: _this3.handleItemClick(i)\n      };\n      items.push(React.createElement(\"div\", _extends({\n        \"data-tid\": \"DateSelect__menuItem\",\n        \"data-prop-disabled\": disableItems,\n        key: i,\n        className: className,\n        onMouseEnter: function onMouseEnter() {\n          return _this3.setState({\n            current: i\n          });\n        },\n        onMouseLeave: function onMouseLeave() {\n          return _this3.setState({\n            current: null\n          });\n        }\n      }, clickHandler), _this3.getItem(i)));\n    };\n\n    for (var i = from; i < to; ++i) {\n      _loop(i);\n    }\n\n    var style = {\n      top: top - 5,\n      left: 0,\n      right: 0\n    };\n    var shiftStyle = {\n      position: 'relative',\n      top: -shift\n    };\n    var holderClass = cn((_cn3 = {}, _cn3[jsStyles.menuHolder(this.theme)] = true, _cn3[jsStyles.isTopCapped()] = this.state.topCapped, _cn3[jsStyles.isBotCapped()] = this.state.botCapped, _cn3));\n    var dropdownOffset = -itemHeight;\n\n    if (nodeTop < -top) {\n      var overflowOffsetDelta = this.state.topCapped ? 6 : 17;\n      dropdownOffset -= nodeTop + top - overflowOffsetDelta;\n    }\n\n    return React.createElement(RenderLayer, {\n      onClickOutside: this.close,\n      onFocusOutside: this.close,\n      active: true\n    }, React.createElement(\"div\", null, React.createElement(DropdownContainer, {\n      getParent: this.getAnchor,\n      offsetY: dropdownOffset,\n      offsetX: -10\n    }, React.createElement(\"div\", {\n      className: holderClass,\n      style: style\n    }, !this.state.topCapped && React.createElement(\"div\", {\n      className: jsStyles.menuUp(this.theme),\n      onClick: this.handleUp,\n      onMouseDown: this.handleLongClickUp,\n      onMouseUp: this.handleLongClickStop,\n      onMouseLeave: this.handleLongClickStop,\n      onTouchStart: this.handleLongClickUp,\n      onTouchEnd: this.handleLongClickStop\n    }, React.createElement(\"span\", null, React.createElement(ArrowTriangleUpIcon, null))), React.createElement(\"div\", {\n      className: jsStyles.itemsHolder(),\n      style: {\n        height: height\n      }\n    }, React.createElement(\"div\", {\n      ref: this.refItemsContainer,\n      style: shiftStyle\n    }, items)), !this.state.botCapped && React.createElement(\"div\", {\n      className: jsStyles.menuDown(this.theme),\n      onClick: this.handleDown,\n      onMouseDown: this.handleLongClickDown,\n      onMouseUp: this.handleLongClickStop,\n      onMouseLeave: this.handleLongClickStop,\n      onTouchStart: this.handleLongClickDown,\n      onTouchEnd: this.handleLongClickStop\n    }, React.createElement(\"span\", null, React.createElement(ArrowTriangleDownIcon, null)))))));\n  };\n\n  _proto.getItem = function getItem(index) {\n    var value = this.props.value + index;\n\n    if (this.props.type === 'month') {\n      return this.locale.months[value];\n    }\n\n    return value;\n  };\n\n  _proto.setPosition = function setPosition(pos) {\n    var top = itemsToMoveCount * itemHeight;\n    var height = visibleYearsCount * itemHeight;\n\n    if (this.props.type === 'month') {\n      top = -this.props.value * itemHeight;\n      height = monthsCount * itemHeight;\n    }\n\n    var minPos = this.getMinPos() - top;\n    var maxPos = this.getMaxPos() - top - height + itemHeight;\n\n    if (minPos >= pos) {\n      pos = minPos;\n    }\n\n    if (maxPos <= pos) {\n      pos = maxPos;\n    }\n\n    var topCapped = pos <= minPos;\n    var botCapped = pos >= maxPos;\n    this.setState({\n      pos: pos,\n      top: top,\n      height: height,\n      topCapped: topCapped,\n      botCapped: botCapped\n    });\n  };\n\n  _proto.getMinPos = function getMinPos() {\n    if (this.props.type === 'month') {\n      return -this.props.value * itemHeight;\n    } else if (this.props.type === 'year') {\n      return ((this.props.minValue || defaultMinYear) - this.props.value) * itemHeight;\n    }\n\n    return -Infinity; // Be defensive.\n  };\n\n  _proto.getMaxPos = function getMaxPos() {\n    if (this.props.type === 'month') {\n      return (visibleYearsCount - this.props.value) * itemHeight;\n    } else if (this.props.type === 'year') {\n      return ((this.props.maxValue || defaultMaxYear) - this.props.value) * itemHeight;\n    }\n\n    return Infinity; // Be defensive.\n  };\n\n  return DateSelect;\n}(React.Component), _class2.__KONTUR_REACT_UI__ = 'DateSelect', _class2.propTypes = {\n  disabled: PropTypes.bool,\n  type: PropTypes.string,\n  value: PropTypes.number.isRequired,\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  onValueChange: PropTypes.func,\n  minValue: PropTypes.number,\n  maxValue: PropTypes.number\n}, _class2.defaultProps = {\n  type: 'year',\n  minMonth: 0,\n  maxMonth: 11,\n  width: 'auto'\n}, _temp)) || _class);\n\nfunction preventDefault(e) {\n  e.preventDefault();\n}","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/internal/DateSelect/DateSelect/DateSelect.js"],"names":["_extends","_inheritsLoose","_dec","_class","_class2","_temp","React","PropTypes","cn","isKeyEscape","DatePickerLocaleHelper","locale","RenderLayer","DropdownContainer","LayoutEvents","ThemeContext","ArrowTriangleDownIcon","ArrowTriangleUpDownIcon","ArrowTriangleUpIcon","jsStyles","itemHeight","visibleYearsCount","itemsToMoveCount","monthsCount","defaultMinYear","defaultMaxYear","DateSelect","_React$Component","_this","_len","arguments","length","args","Array","_key","call","apply","concat","state","botCapped","current","height","opened","pos","top","topCapped","nodeTop","Infinity","theme","root","itemsContainer","listener","timeout","longClickTimer","setPositionRepeatTimer","yearStep","open","props","disabled","setPosition","setState","close","refRoot","element","setNodeTop","clearTimeout","setTimeout","getBoundingClientRect","refItemsContainer","addEventListener","handleWheel","passive","removeEventListener","handleLongClickUp","event","preventDefault","window","setInterval","handleLongClickDown","handleLongClickStop","getAnchor","WheelEvent","stopPropagation","deltaY","deltaMode","handleItemClick","shift","e","value","onValueChange","handleKey","handleUp","handleDown","_proto","prototype","UNSAFE_componentWillReceiveProps","componentDidMount","addListener","componentWillUnmount","remove","render","_this2","createElement","Consumer","renderMain","_cn","_cn2","_this$props","width","rootProps","className","Boolean","style","ref","caption","onClick","getItem","arrow","arrowDisabled","size","renderMenu","disableItems","index","maxValue","minValue","_this3","_cn3","_this$state","from","to","Math","ceil","items","_loop","i","_cn4","menuItem","menuItemSelected","menuItemActive","menuItemDisabled","clickHandler","onMouseDown","push","key","onMouseEnter","onMouseLeave","left","right","shiftStyle","position","holderClass","menuHolder","isTopCapped","isBotCapped","dropdownOffset","overflowOffsetDelta","onClickOutside","onFocusOutside","active","getParent","offsetY","offsetX","menuUp","onMouseUp","onTouchStart","onTouchEnd","itemsHolder","menuDown","type","months","minPos","getMinPos","maxPos","getMaxPos","Component","__KONTUR_REACT_UI__","propTypes","bool","string","number","isRequired","oneOfType","func","defaultProps","minMonth","maxMonth"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,oCAArB;AACA,OAAOC,cAAP,MAA2B,0CAA3B;;AAEA,IAAIC,IAAJ,EAAUC,MAAV,EAAkBC,OAAlB,EAA2BC,KAA3B;;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,EAAP,MAAe,YAAf;AACA,SAASC,WAAT,QAA4B,0CAA5B;AACA,SAASC,sBAAT,QAAuC,uCAAvC;AACA,SAASC,MAAT,QAAuB,gCAAvB;AACA,SAASC,WAAT,QAA4B,mBAA5B;AACA,SAASC,iBAAT,QAAkC,yBAAlC;AACA,OAAO,KAAKC,YAAZ,MAA8B,2BAA9B;AACA,SAASC,YAAT,QAA6B,mCAA7B;AACA,SAASC,qBAAT,EAAgCC,uBAAhC,EAAyDC,mBAAzD,QAAoF,kBAApF;AACA,SAASC,QAAT,QAAyB,sBAAzB;AACA,IAAIC,UAAU,GAAG,EAAjB;AACA,IAAIC,iBAAiB,GAAG,EAAxB;AACA,IAAIC,gBAAgB,GAAG,CAAC,CAAxB;AACA,IAAIC,WAAW,GAAG,EAAlB;AACA,IAAIC,cAAc,GAAG,IAArB;AACA,IAAIC,cAAc,GAAG,IAArB;AACA,OAAO,IAAIC,UAAU,IAAIxB,IAAI,GAAGS,MAAM,CAAC,YAAD,EAAeD,sBAAf,CAAb,EAAqDR,IAAI,CAACC,MAAM,IAAIE,KAAK,GAAGD,OAAO,GAC5G,aACA,UAAUuB,gBAAV,EAA4B;AAC1B1B,EAAAA,cAAc,CAACyB,UAAD,EAAaC,gBAAb,CAAd;;AAEA,WAASD,UAAT,GAAsB;AACpB,QAAIE,KAAJ;;AAEA,SAAK,IAAIC,IAAI,GAAGC,SAAS,CAACC,MAArB,EAA6BC,IAAI,GAAG,IAAIC,KAAJ,CAAUJ,IAAV,CAApC,EAAqDK,IAAI,GAAG,CAAjE,EAAoEA,IAAI,GAAGL,IAA3E,EAAiFK,IAAI,EAArF,EAAyF;AACvFF,MAAAA,IAAI,CAACE,IAAD,CAAJ,GAAaJ,SAAS,CAACI,IAAD,CAAtB;AACD;;AAEDN,IAAAA,KAAK,GAAGD,gBAAgB,CAACQ,IAAjB,CAAsBC,KAAtB,CAA4BT,gBAA5B,EAA8C,CAAC,IAAD,EAAOU,MAAP,CAAcL,IAAd,CAA9C,KAAsE,IAA9E;AACAJ,IAAAA,KAAK,CAACU,KAAN,GAAc;AACZC,MAAAA,SAAS,EAAE,KADC;AAEZC,MAAAA,OAAO,EAAE,CAFG;AAGZC,MAAAA,MAAM,EAAE,CAHI;AAIZC,MAAAA,MAAM,EAAE,KAJI;AAKZC,MAAAA,GAAG,EAAE,CALO;AAMZC,MAAAA,GAAG,EAAE,CANO;AAOZC,MAAAA,SAAS,EAAE,KAPC;AAQZC,MAAAA,OAAO,EAAEC;AARG,KAAd;AAUAnB,IAAAA,KAAK,CAACoB,KAAN,GAAc,KAAK,CAAnB;AACApB,IAAAA,KAAK,CAACjB,MAAN,GAAe,KAAK,CAApB;AACAiB,IAAAA,KAAK,CAACqB,IAAN,GAAa,IAAb;AACArB,IAAAA,KAAK,CAACsB,cAAN,GAAuB,IAAvB;AACAtB,IAAAA,KAAK,CAACuB,QAAN,GAAiB,KAAK,CAAtB;AACAvB,IAAAA,KAAK,CAACwB,OAAN,GAAgB,KAAK,CAArB;AACAxB,IAAAA,KAAK,CAACyB,cAAN,GAAuB,CAAvB;AACAzB,IAAAA,KAAK,CAAC0B,sBAAN,GAA+B,CAA/B;AACA1B,IAAAA,KAAK,CAAC2B,QAAN,GAAiB,CAAjB;;AAEA3B,IAAAA,KAAK,CAAC4B,IAAN,GAAa,YAAY;AACvB,UAAI5B,KAAK,CAAC6B,KAAN,CAAYC,QAAhB,EAA0B;AACxB;AACD;;AAED,UAAI9B,KAAK,CAACU,KAAN,CAAYI,MAAhB,EAAwB;AACtB;AACD;;AAEDd,MAAAA,KAAK,CAAC+B,WAAN,CAAkB,CAAlB;;AAEA/B,MAAAA,KAAK,CAACgC,QAAN,CAAe;AACblB,QAAAA,MAAM,EAAE,IADK;AAEbF,QAAAA,OAAO,EAAE;AAFI,OAAf;AAID,KAfD;;AAiBAZ,IAAAA,KAAK,CAACiC,KAAN,GAAc,YAAY;AACxB,UAAI,CAACjC,KAAK,CAACU,KAAN,CAAYI,MAAjB,EAAyB;AACvB;AACD;;AAEDd,MAAAA,KAAK,CAACgC,QAAN,CAAe;AACblB,QAAAA,MAAM,EAAE;AADK,OAAf;AAGD,KARD;;AAUAd,IAAAA,KAAK,CAACkC,OAAN,GAAgB,UAAUC,OAAV,EAAmB;AACjCnC,MAAAA,KAAK,CAACqB,IAAN,GAAac,OAAb;AACD,KAFD;;AAIAnC,IAAAA,KAAK,CAACoC,UAAN,GAAmB,YAAY;AAC7B,UAAIf,IAAI,GAAGrB,KAAK,CAACqB,IAAjB;;AAEA,UAAI,CAACA,IAAL,EAAW;AACT;AACD;;AAED,UAAIrB,KAAK,CAACwB,OAAV,EAAmB;AACjBa,QAAAA,YAAY,CAACrC,KAAK,CAACwB,OAAP,CAAZ;AACD;;AAEDxB,MAAAA,KAAK,CAACwB,OAAN,GAAgBc,UAAU,CAAC,YAAY;AACrC,eAAOtC,KAAK,CAACgC,QAAN,CAAe;AACpBd,UAAAA,OAAO,EAAEG,IAAI,CAACkB,qBAAL,GAA6BvB;AADlB,SAAf,CAAP;AAGD,OAJyB,CAA1B;AAKD,KAhBD;;AAkBAhB,IAAAA,KAAK,CAACwC,iBAAN,GAA0B,UAAUL,OAAV,EAAmB;AAC3C,UAAI,CAACnC,KAAK,CAACsB,cAAP,IAAyBa,OAA7B,EAAsC;AACpCA,QAAAA,OAAO,CAACM,gBAAR,CAAyB,OAAzB,EAAkCzC,KAAK,CAAC0C,WAAxC,EAAqD;AACnDC,UAAAA,OAAO,EAAE;AAD0C,SAArD;AAGD;;AAED,UAAI3C,KAAK,CAACsB,cAAN,IAAwB,CAACa,OAA7B,EAAsC;AACpCnC,QAAAA,KAAK,CAACsB,cAAN,CAAqBsB,mBAArB,CAAyC,OAAzC,EAAkD5C,KAAK,CAAC0C,WAAxD;AACD;;AAED1C,MAAAA,KAAK,CAACsB,cAAN,GAAuBa,OAAvB;AACD,KAZD;;AAcAnC,IAAAA,KAAK,CAAC6C,iBAAN,GAA0B,UAAUC,KAAV,EAAiB;AACzCA,MAAAA,KAAK,CAACC,cAAN;AACA/C,MAAAA,KAAK,CAACyB,cAAN,GAAuBuB,MAAM,CAACV,UAAP,CAAkB,YAAY;AACnDtC,QAAAA,KAAK,CAAC0B,sBAAN,GAA+BsB,MAAM,CAACC,WAAP,CAAmB,YAAY;AAC5D,iBAAOjD,KAAK,CAAC+B,WAAN,CAAkB/B,KAAK,CAACU,KAAN,CAAYK,GAAZ,GAAkBvB,UAApC,CAAP;AACD,SAF8B,EAE5B,GAF4B,CAA/B;AAGD,OAJsB,EAIpB,GAJoB,CAAvB;AAKD,KAPD;;AASAQ,IAAAA,KAAK,CAACkD,mBAAN,GAA4B,UAAUJ,KAAV,EAAiB;AAC3CA,MAAAA,KAAK,CAACC,cAAN;AACA/C,MAAAA,KAAK,CAACyB,cAAN,GAAuBuB,MAAM,CAACV,UAAP,CAAkB,YAAY;AACnDtC,QAAAA,KAAK,CAAC0B,sBAAN,GAA+BsB,MAAM,CAACC,WAAP,CAAmB,YAAY;AAC5D,iBAAOjD,KAAK,CAAC+B,WAAN,CAAkB/B,KAAK,CAACU,KAAN,CAAYK,GAAZ,GAAkBvB,UAApC,CAAP;AACD,SAF8B,EAE5B,GAF4B,CAA/B;AAGD,OAJsB,EAIpB,GAJoB,CAAvB;AAKD,KAPD;;AASAQ,IAAAA,KAAK,CAACmD,mBAAN,GAA4B,YAAY;AACtCd,MAAAA,YAAY,CAACrC,KAAK,CAACyB,cAAP,CAAZ;AACAY,MAAAA,YAAY,CAACrC,KAAK,CAAC0B,sBAAP,CAAZ;AACD,KAHD;;AAKA1B,IAAAA,KAAK,CAACoD,SAAN,GAAkB,YAAY;AAC5B,aAAOpD,KAAK,CAACqB,IAAb;AACD,KAFD;;AAIArB,IAAAA,KAAK,CAAC0C,WAAN,GAAoB,UAAUI,KAAV,EAAiB;AACnC,UAAI,EAAEA,KAAK,YAAYO,UAAnB,CAAJ,EAAoC;AAClC;AACD;;AAEDP,MAAAA,KAAK,CAACC,cAAN;AACAD,MAAAA,KAAK,CAACQ,eAAN;AACA,UAAIC,MAAM,GAAGT,KAAK,CAACS,MAAnB;;AAEA,UAAIT,KAAK,CAACU,SAAN,KAAoB,CAAxB,EAA2B;AACzBD,QAAAA,MAAM,IAAI/D,UAAV;AACD,OAFD,MAEO,IAAIsD,KAAK,CAACU,SAAN,KAAoB,CAAxB,EAA2B;AAChCD,QAAAA,MAAM,IAAI/D,UAAU,GAAG,CAAvB;AACD;;AAED,UAAIuB,GAAG,GAAGf,KAAK,CAACU,KAAN,CAAYK,GAAZ,GAAkBwC,MAA5B;;AAEAvD,MAAAA,KAAK,CAAC+B,WAAN,CAAkBhB,GAAlB;AACD,KAlBD;;AAoBAf,IAAAA,KAAK,CAACyD,eAAN,GAAwB,UAAUC,KAAV,EAAiB;AACvC,aAAO,UAAUC,CAAV,EAAa;AAClB,YAAIC,KAAK,GAAG5D,KAAK,CAAC6B,KAAN,CAAY+B,KAAZ,GAAoBF,KAAhC;;AAEA,YAAI1D,KAAK,CAAC6B,KAAN,CAAYgC,aAAhB,EAA+B;AAC7B7D,UAAAA,KAAK,CAAC6B,KAAN,CAAYgC,aAAZ,CAA0BD,KAA1B;AACD;;AAED5D,QAAAA,KAAK,CAACgC,QAAN,CAAe;AACblB,UAAAA,MAAM,EAAE;AADK,SAAf;AAGD,OAVD;AAWD,KAZD;;AAcAd,IAAAA,KAAK,CAAC8D,SAAN,GAAkB,UAAUH,CAAV,EAAa;AAC7B,UAAI3D,KAAK,CAACU,KAAN,CAAYI,MAAZ,IAAsBjC,WAAW,CAAC8E,CAAD,CAArC,EAA0C;AACxCA,QAAAA,CAAC,CAACZ,cAAF;;AAEA/C,QAAAA,KAAK,CAACiC,KAAN;;AAEA0B,QAAAA,CAAC,CAACL,eAAF;AACD;AACF,KARD;;AAUAtD,IAAAA,KAAK,CAAC+D,QAAN,GAAiB,UAAUjB,KAAV,EAAiB;AAChCA,MAAAA,KAAK,CAACC,cAAN;;AAEA/C,MAAAA,KAAK,CAAC+B,WAAN,CAAkB/B,KAAK,CAACU,KAAN,CAAYK,GAAZ,GAAkBvB,UAAU,GAAGQ,KAAK,CAAC2B,QAAvD;AACD,KAJD;;AAMA3B,IAAAA,KAAK,CAACgE,UAAN,GAAmB,UAAUlB,KAAV,EAAiB;AAClCA,MAAAA,KAAK,CAACC,cAAN;;AAEA/C,MAAAA,KAAK,CAAC+B,WAAN,CAAkB/B,KAAK,CAACU,KAAN,CAAYK,GAAZ,GAAkBvB,UAAU,GAAGQ,KAAK,CAAC2B,QAAvD;AACD,KAJD;;AAMA,WAAO3B,KAAP;AACD;;AAED,MAAIiE,MAAM,GAAGnE,UAAU,CAACoE,SAAxB;;AAEAD,EAAAA,MAAM,CAACE,gCAAP,GAA0C,SAASA,gCAAT,GAA4C;AACpF,SAAK/B,UAAL;AACD,GAFD;;AAIA6B,EAAAA,MAAM,CAACG,iBAAP,GAA2B,SAASA,iBAAT,GAA6B;AACtD,SAAK7C,QAAL,GAAgBrC,YAAY,CAACmF,WAAb,CAAyB,KAAKjC,UAA9B,CAAhB;AACA,SAAKA,UAAL;AACAY,IAAAA,MAAM,CAACP,gBAAP,CAAwB,SAAxB,EAAmC,KAAKqB,SAAxC;AACD,GAJD;;AAMAG,EAAAA,MAAM,CAACK,oBAAP,GAA8B,SAASA,oBAAT,GAAgC;AAC5D,QAAI,KAAK/C,QAAT,EAAmB;AACjB,WAAKA,QAAL,CAAcgD,MAAd;AACD;;AAED,QAAI,KAAK/C,OAAT,EAAkB;AAChBa,MAAAA,YAAY,CAAC,KAAKb,OAAN,CAAZ;AACD;;AAED,QAAI,KAAKC,cAAT,EAAyB;AACvBY,MAAAA,YAAY,CAAC,KAAKZ,cAAN,CAAZ;AACD;;AAED,QAAI,KAAKC,sBAAT,EAAiC;AAC/BW,MAAAA,YAAY,CAAC,KAAKX,sBAAN,CAAZ;AACD;;AAEDsB,IAAAA,MAAM,CAACJ,mBAAP,CAA2B,SAA3B,EAAsC,KAAKkB,SAA3C;AACD;AACD;;;AAnBA;;AAwBAG,EAAAA,MAAM,CAACO,MAAP,GAAgB,SAASA,MAAT,GAAkB;AAChC,QAAIC,MAAM,GAAG,IAAb;;AAEA,WAAO/F,KAAK,CAACgG,aAAN,CAAoBvF,YAAY,CAACwF,QAAjC,EAA2C,IAA3C,EAAiD,UAAUvD,KAAV,EAAiB;AACvEqD,MAAAA,MAAM,CAACrD,KAAP,GAAeA,KAAf;AACA,aAAOqD,MAAM,CAACG,UAAP,EAAP;AACD,KAHM,CAAP;AAID,GAPD;;AASAX,EAAAA,MAAM,CAACW,UAAP,GAAoB,SAASA,UAAT,GAAsB;AACxC,QAAIC,GAAJ,EAASC,IAAT;;AAEA,QAAIC,WAAW,GAAG,KAAKlD,KAAvB;AAAA,QACImD,KAAK,GAAGD,WAAW,CAACC,KADxB;AAAA,QAEIlD,QAAQ,GAAGiD,WAAW,CAACjD,QAF3B;AAGA,QAAImD,SAAS,GAAG;AACdC,MAAAA,SAAS,EAAEtG,EAAE,EAAEiG,GAAG,GAAG,EAAN,EAAUA,GAAG,CAACtF,QAAQ,CAAC8B,IAAT,CAAc,KAAKD,KAAnB,CAAD,CAAH,GAAiC,IAA3C,EAAiDyD,GAAG,CAACtF,QAAQ,CAACuC,QAAT,EAAD,CAAH,GAA2BqD,OAAO,CAACrD,QAAD,CAAnF,EAA+F+C,GAAjG,EADC;AAEdO,MAAAA,KAAK,EAAE;AACLJ,QAAAA,KAAK,EAAEA;AADF,OAFO;AAKdK,MAAAA,GAAG,EAAE,KAAKnD;AALI,KAAhB;AAOA,WAAOxD,KAAK,CAACgG,aAAN,CAAoB,MAApB,EAA4BO,SAA5B,EAAuCvG,KAAK,CAACgG,aAAN,CAAoB,KAApB,EAA2B;AACvE,kBAAY,qBAD2D;AAEvEQ,MAAAA,SAAS,EAAE3F,QAAQ,CAAC+F,OAAT,EAF4D;AAGvEC,MAAAA,OAAO,EAAE,KAAK3D;AAHyD,KAA3B,EAI3C,KAAK4D,OAAL,CAAa,CAAb,CAJ2C,EAI1B9G,KAAK,CAACgG,aAAN,CAAoB,KAApB,EAA2B;AAC7CQ,MAAAA,SAAS,EAAEtG,EAAE,EAAEkG,IAAI,GAAG,EAAP,EAAWA,IAAI,CAACvF,QAAQ,CAACkG,KAAT,CAAe,KAAKrE,KAApB,CAAD,CAAJ,GAAmC,IAA9C,EAAoD0D,IAAI,CAACvF,QAAQ,CAACmG,aAAT,EAAD,CAAJ,GAAiCP,OAAO,CAACrD,QAAD,CAA5F,EAAwGgD,IAA1G;AADgC,KAA3B,EAEjBpG,KAAK,CAACgG,aAAN,CAAoBrF,uBAApB,EAA6C;AAC9CsG,MAAAA,IAAI,EAAE;AADwC,KAA7C,CAFiB,CAJ0B,CAAvC,EAQD,KAAKjF,KAAL,CAAWI,MAAX,IAAqB,KAAK8E,UAAL,EARpB,CAAP;AASD,GAtBD;;AAwBA3B,EAAAA,MAAM,CAAC4B,YAAP,GAAsB,SAASA,YAAT,CAAsBC,KAAtB,EAA6B;AACjD,QAAIlC,KAAK,GAAG,KAAK/B,KAAL,CAAW+B,KAAX,GAAmBkC,KAA/B;;AAEA,QAAI,KAAKjE,KAAL,CAAWkE,QAAX,IAAuB,IAAvB,IAA+B,KAAKlE,KAAL,CAAWmE,QAAX,IAAuB,IAA1D,EAAgE;AAC9D,aAAOpC,KAAK,GAAG,KAAK/B,KAAL,CAAWkE,QAAnB,IAA+BnC,KAAK,GAAG,KAAK/B,KAAL,CAAWmE,QAAzD;AACD;;AAED,QAAI,KAAKnE,KAAL,CAAWmE,QAAX,IAAuB,IAA3B,EAAiC;AAC/B,aAAOpC,KAAK,GAAG,KAAK/B,KAAL,CAAWmE,QAA1B;AACD;;AAED,QAAI,KAAKnE,KAAL,CAAWkE,QAAX,IAAuB,IAA3B,EAAiC;AAC/B,aAAOnC,KAAK,GAAG,KAAK/B,KAAL,CAAWkE,QAA1B;AACD;AACF,GAdD;;AAgBA9B,EAAAA,MAAM,CAAC2B,UAAP,GAAoB,SAASA,UAAT,GAAsB;AACxC,QAAIK,MAAM,GAAG,IAAb;AAAA,QACIC,IADJ;;AAGA,QAAIC,WAAW,GAAG,KAAKzF,KAAvB;AAAA,QACIM,GAAG,GAAGmF,WAAW,CAACnF,GADtB;AAAA,QAEIH,MAAM,GAAGsF,WAAW,CAACtF,MAFzB;AAAA,QAGIK,OAAO,GAAGiF,WAAW,CAACjF,OAH1B;AAIA,QAAIwC,KAAK,GAAG,KAAKhD,KAAL,CAAWK,GAAX,GAAiBvB,UAA7B;;AAEA,QAAIkE,KAAK,GAAG,CAAZ,EAAe;AACbA,MAAAA,KAAK,IAAIlE,UAAT;AACD;;AAED,QAAI4G,IAAI,GAAG,CAAC,KAAK1F,KAAL,CAAWK,GAAX,GAAiB2C,KAAjB,GAAyB1C,GAA1B,IAAiCxB,UAA5C;AACA,QAAI6G,EAAE,GAAGD,IAAI,GAAGE,IAAI,CAACC,IAAL,CAAU,CAAC1F,MAAM,GAAG6C,KAAV,IAAmBlE,UAA7B,CAAhB;AACA,QAAIgH,KAAK,GAAG,EAAZ;;AAEA,QAAIC,KAAK,GAAG,SAASA,KAAT,CAAeC,CAAf,EAAkB;AAC5B,UAAIC,IAAJ;;AAEA,UAAId,YAAY,GAAGI,MAAM,CAACJ,YAAP,CAAoBa,CAApB,KAA0B,KAA7C;AACA,UAAIxB,SAAS,GAAGtG,EAAE,EAAE+H,IAAI,GAAG,EAAP,EAAWA,IAAI,CAACpH,QAAQ,CAACqH,QAAT,CAAkBX,MAAM,CAAC7E,KAAzB,CAAD,CAAJ,GAAwC,IAAnD,EAAyDuF,IAAI,CAACpH,QAAQ,CAACsH,gBAAT,CAA0BZ,MAAM,CAAC7E,KAAjC,CAAD,CAAJ,GAAgDsF,CAAC,KAAK,CAA/G,EAAkHC,IAAI,CAACpH,QAAQ,CAACuH,cAAT,CAAwBb,MAAM,CAAC7E,KAA/B,CAAD,CAAJ,GAA8CsF,CAAC,KAAKT,MAAM,CAACvF,KAAP,CAAaE,OAAnL,EAA4L+F,IAAI,CAACpH,QAAQ,CAACwH,gBAAT,CAA0Bd,MAAM,CAAC7E,KAAjC,CAAD,CAAJ,GAAgDyE,YAA5O,EAA0Pc,IAA5P,EAAlB;AACA,UAAIK,YAAY,GAAG;AACjBC,QAAAA,WAAW,EAAElE,cADI;AAEjBwC,QAAAA,OAAO,EAAEU,MAAM,CAACxC,eAAP,CAAuBiD,CAAvB;AAFQ,OAAnB;AAIAF,MAAAA,KAAK,CAACU,IAAN,CAAWxI,KAAK,CAACgG,aAAN,CAAoB,KAApB,EAA2BtG,QAAQ,CAAC;AAC7C,oBAAY,sBADiC;AAE7C,8BAAsByH,YAFuB;AAG7CsB,QAAAA,GAAG,EAAET,CAHwC;AAI7CxB,QAAAA,SAAS,EAAEA,SAJkC;AAK7CkC,QAAAA,YAAY,EAAE,SAASA,YAAT,GAAwB;AACpC,iBAAOnB,MAAM,CAACjE,QAAP,CAAgB;AACrBpB,YAAAA,OAAO,EAAE8F;AADY,WAAhB,CAAP;AAGD,SAT4C;AAU7CW,QAAAA,YAAY,EAAE,SAASA,YAAT,GAAwB;AACpC,iBAAOpB,MAAM,CAACjE,QAAP,CAAgB;AACrBpB,YAAAA,OAAO,EAAE;AADY,WAAhB,CAAP;AAGD;AAd4C,OAAD,EAe3CoG,YAf2C,CAAnC,EAeOf,MAAM,CAACT,OAAP,CAAekB,CAAf,CAfP,CAAX;AAgBD,KAzBD;;AA2BA,SAAK,IAAIA,CAAC,GAAGN,IAAb,EAAmBM,CAAC,GAAGL,EAAvB,EAA2B,EAAEK,CAA7B,EAAgC;AAC9BD,MAAAA,KAAK,CAACC,CAAD,CAAL;AACD;;AAED,QAAItB,KAAK,GAAG;AACVpE,MAAAA,GAAG,EAAEA,GAAG,GAAG,CADD;AAEVsG,MAAAA,IAAI,EAAE,CAFI;AAGVC,MAAAA,KAAK,EAAE;AAHG,KAAZ;AAKA,QAAIC,UAAU,GAAG;AACfC,MAAAA,QAAQ,EAAE,UADK;AAEfzG,MAAAA,GAAG,EAAE,CAAC0C;AAFS,KAAjB;AAIA,QAAIgE,WAAW,GAAG9I,EAAE,EAAEsH,IAAI,GAAG,EAAP,EAAWA,IAAI,CAAC3G,QAAQ,CAACoI,UAAT,CAAoB,KAAKvG,KAAzB,CAAD,CAAJ,GAAwC,IAAnD,EAAyD8E,IAAI,CAAC3G,QAAQ,CAACqI,WAAT,EAAD,CAAJ,GAA+B,KAAKlH,KAAL,CAAWO,SAAnG,EAA8GiF,IAAI,CAAC3G,QAAQ,CAACsI,WAAT,EAAD,CAAJ,GAA+B,KAAKnH,KAAL,CAAWC,SAAxJ,EAAmKuF,IAArK,EAApB;AACA,QAAI4B,cAAc,GAAG,CAACtI,UAAtB;;AAEA,QAAI0B,OAAO,GAAG,CAACF,GAAf,EAAoB;AAClB,UAAI+G,mBAAmB,GAAG,KAAKrH,KAAL,CAAWO,SAAX,GAAuB,CAAvB,GAA2B,EAArD;AACA6G,MAAAA,cAAc,IAAI5G,OAAO,GAAGF,GAAV,GAAgB+G,mBAAlC;AACD;;AAED,WAAOrJ,KAAK,CAACgG,aAAN,CAAoB1F,WAApB,EAAiC;AACtCgJ,MAAAA,cAAc,EAAE,KAAK/F,KADiB;AAEtCgG,MAAAA,cAAc,EAAE,KAAKhG,KAFiB;AAGtCiG,MAAAA,MAAM,EAAE;AAH8B,KAAjC,EAIJxJ,KAAK,CAACgG,aAAN,CAAoB,KAApB,EAA2B,IAA3B,EAAiChG,KAAK,CAACgG,aAAN,CAAoBzF,iBAApB,EAAuC;AACzEkJ,MAAAA,SAAS,EAAE,KAAK/E,SADyD;AAEzEgF,MAAAA,OAAO,EAAEN,cAFgE;AAGzEO,MAAAA,OAAO,EAAE,CAAC;AAH+D,KAAvC,EAIjC3J,KAAK,CAACgG,aAAN,CAAoB,KAApB,EAA2B;AAC5BQ,MAAAA,SAAS,EAAEwC,WADiB;AAE5BtC,MAAAA,KAAK,EAAEA;AAFqB,KAA3B,EAGA,CAAC,KAAK1E,KAAL,CAAWO,SAAZ,IAAyBvC,KAAK,CAACgG,aAAN,CAAoB,KAApB,EAA2B;AACrDQ,MAAAA,SAAS,EAAE3F,QAAQ,CAAC+I,MAAT,CAAgB,KAAKlH,KAArB,CAD0C;AAErDmE,MAAAA,OAAO,EAAE,KAAKxB,QAFuC;AAGrDkD,MAAAA,WAAW,EAAE,KAAKpE,iBAHmC;AAIrD0F,MAAAA,SAAS,EAAE,KAAKpF,mBAJqC;AAKrDkE,MAAAA,YAAY,EAAE,KAAKlE,mBALkC;AAMrDqF,MAAAA,YAAY,EAAE,KAAK3F,iBANkC;AAOrD4F,MAAAA,UAAU,EAAE,KAAKtF;AAPoC,KAA3B,EAQzBzE,KAAK,CAACgG,aAAN,CAAoB,MAApB,EAA4B,IAA5B,EAAkChG,KAAK,CAACgG,aAAN,CAAoBpF,mBAApB,EAAyC,IAAzC,CAAlC,CARyB,CAHzB,EAWoFZ,KAAK,CAACgG,aAAN,CAAoB,KAApB,EAA2B;AAChHQ,MAAAA,SAAS,EAAE3F,QAAQ,CAACmJ,WAAT,EADqG;AAEhHtD,MAAAA,KAAK,EAAE;AACLvE,QAAAA,MAAM,EAAEA;AADH;AAFyG,KAA3B,EAKpFnC,KAAK,CAACgG,aAAN,CAAoB,KAApB,EAA2B;AAC5BW,MAAAA,GAAG,EAAE,KAAK7C,iBADkB;AAE5B4C,MAAAA,KAAK,EAAEoC;AAFqB,KAA3B,EAGAhB,KAHA,CALoF,CAXpF,EAmBS,CAAC,KAAK9F,KAAL,CAAWC,SAAZ,IAAyBjC,KAAK,CAACgG,aAAN,CAAoB,KAApB,EAA2B;AAC9DQ,MAAAA,SAAS,EAAE3F,QAAQ,CAACoJ,QAAT,CAAkB,KAAKvH,KAAvB,CADmD;AAE9DmE,MAAAA,OAAO,EAAE,KAAKvB,UAFgD;AAG9DiD,MAAAA,WAAW,EAAE,KAAK/D,mBAH4C;AAI9DqF,MAAAA,SAAS,EAAE,KAAKpF,mBAJ8C;AAK9DkE,MAAAA,YAAY,EAAE,KAAKlE,mBAL2C;AAM9DqF,MAAAA,YAAY,EAAE,KAAKtF,mBAN2C;AAO9DuF,MAAAA,UAAU,EAAE,KAAKtF;AAP6C,KAA3B,EAQlCzE,KAAK,CAACgG,aAAN,CAAoB,MAApB,EAA4B,IAA5B,EAAkChG,KAAK,CAACgG,aAAN,CAAoBtF,qBAApB,EAA2C,IAA3C,CAAlC,CARkC,CAnBlC,CAJiC,CAAjC,CAJI,CAAP;AAoCD,GAtGD;;AAwGA6E,EAAAA,MAAM,CAACuB,OAAP,GAAiB,SAASA,OAAT,CAAiBM,KAAjB,EAAwB;AACvC,QAAIlC,KAAK,GAAG,KAAK/B,KAAL,CAAW+B,KAAX,GAAmBkC,KAA/B;;AAEA,QAAI,KAAKjE,KAAL,CAAW+G,IAAX,KAAoB,OAAxB,EAAiC;AAC/B,aAAO,KAAK7J,MAAL,CAAY8J,MAAZ,CAAmBjF,KAAnB,CAAP;AACD;;AAED,WAAOA,KAAP;AACD,GARD;;AAUAK,EAAAA,MAAM,CAAClC,WAAP,GAAqB,SAASA,WAAT,CAAqBhB,GAArB,EAA0B;AAC7C,QAAIC,GAAG,GAAGtB,gBAAgB,GAAGF,UAA7B;AACA,QAAIqB,MAAM,GAAGpB,iBAAiB,GAAGD,UAAjC;;AAEA,QAAI,KAAKqC,KAAL,CAAW+G,IAAX,KAAoB,OAAxB,EAAiC;AAC/B5H,MAAAA,GAAG,GAAG,CAAC,KAAKa,KAAL,CAAW+B,KAAZ,GAAoBpE,UAA1B;AACAqB,MAAAA,MAAM,GAAGlB,WAAW,GAAGH,UAAvB;AACD;;AAED,QAAIsJ,MAAM,GAAG,KAAKC,SAAL,KAAmB/H,GAAhC;AACA,QAAIgI,MAAM,GAAG,KAAKC,SAAL,KAAmBjI,GAAnB,GAAyBH,MAAzB,GAAkCrB,UAA/C;;AAEA,QAAIsJ,MAAM,IAAI/H,GAAd,EAAmB;AACjBA,MAAAA,GAAG,GAAG+H,MAAN;AACD;;AAED,QAAIE,MAAM,IAAIjI,GAAd,EAAmB;AACjBA,MAAAA,GAAG,GAAGiI,MAAN;AACD;;AAED,QAAI/H,SAAS,GAAGF,GAAG,IAAI+H,MAAvB;AACA,QAAInI,SAAS,GAAGI,GAAG,IAAIiI,MAAvB;AACA,SAAKhH,QAAL,CAAc;AACZjB,MAAAA,GAAG,EAAEA,GADO;AAEZC,MAAAA,GAAG,EAAEA,GAFO;AAGZH,MAAAA,MAAM,EAAEA,MAHI;AAIZI,MAAAA,SAAS,EAAEA,SAJC;AAKZN,MAAAA,SAAS,EAAEA;AALC,KAAd;AAOD,GA7BD;;AA+BAsD,EAAAA,MAAM,CAAC8E,SAAP,GAAmB,SAASA,SAAT,GAAqB;AACtC,QAAI,KAAKlH,KAAL,CAAW+G,IAAX,KAAoB,OAAxB,EAAiC;AAC/B,aAAO,CAAC,KAAK/G,KAAL,CAAW+B,KAAZ,GAAoBpE,UAA3B;AACD,KAFD,MAEO,IAAI,KAAKqC,KAAL,CAAW+G,IAAX,KAAoB,MAAxB,EAAgC;AACrC,aAAO,CAAC,CAAC,KAAK/G,KAAL,CAAWmE,QAAX,IAAuBpG,cAAxB,IAA0C,KAAKiC,KAAL,CAAW+B,KAAtD,IAA+DpE,UAAtE;AACD;;AAED,WAAO,CAAC2B,QAAR,CAPsC,CAOpB;AACnB,GARD;;AAUA8C,EAAAA,MAAM,CAACgF,SAAP,GAAmB,SAASA,SAAT,GAAqB;AACtC,QAAI,KAAKpH,KAAL,CAAW+G,IAAX,KAAoB,OAAxB,EAAiC;AAC/B,aAAO,CAACnJ,iBAAiB,GAAG,KAAKoC,KAAL,CAAW+B,KAAhC,IAAyCpE,UAAhD;AACD,KAFD,MAEO,IAAI,KAAKqC,KAAL,CAAW+G,IAAX,KAAoB,MAAxB,EAAgC;AACrC,aAAO,CAAC,CAAC,KAAK/G,KAAL,CAAWkE,QAAX,IAAuBlG,cAAxB,IAA0C,KAAKgC,KAAL,CAAW+B,KAAtD,IAA+DpE,UAAtE;AACD;;AAED,WAAO2B,QAAP,CAPsC,CAOrB;AAClB,GARD;;AAUA,SAAOrB,UAAP;AACD,CA/aD,CA+aEpB,KAAK,CAACwK,SA/aR,CAF6F,EAibzE1K,OAAO,CAAC2K,mBAAR,GAA8B,YAjb2C,EAib7B3K,OAAO,CAAC4K,SAAR,GAAoB;AAClFtH,EAAAA,QAAQ,EAAEnD,SAAS,CAAC0K,IAD8D;AAElFT,EAAAA,IAAI,EAAEjK,SAAS,CAAC2K,MAFkE;AAGlF1F,EAAAA,KAAK,EAAEjF,SAAS,CAAC4K,MAAV,CAAiBC,UAH0D;AAIlFxE,EAAAA,KAAK,EAAErG,SAAS,CAAC8K,SAAV,CAAoB,CAAC9K,SAAS,CAAC4K,MAAX,EAAmB5K,SAAS,CAAC2K,MAA7B,CAApB,CAJ2E;AAKlFzF,EAAAA,aAAa,EAAElF,SAAS,CAAC+K,IALyD;AAMlF1D,EAAAA,QAAQ,EAAErH,SAAS,CAAC4K,MAN8D;AAOlFxD,EAAAA,QAAQ,EAAEpH,SAAS,CAAC4K;AAP8D,CAjbS,EAyb1F/K,OAAO,CAACmL,YAAR,GAAuB;AACxBf,EAAAA,IAAI,EAAE,MADkB;AAExBgB,EAAAA,QAAQ,EAAE,CAFc;AAGxBC,EAAAA,QAAQ,EAAE,EAHc;AAIxB7E,EAAAA,KAAK,EAAE;AAJiB,CAzbmE,EA8b1FvG,KA9bsF,CAAP,CAAJ,IA8bhEF,MA9bO,CAAd;;AAgcP,SAASwE,cAAT,CAAwBY,CAAxB,EAA2B;AACzBA,EAAAA,CAAC,CAACZ,cAAF;AACD","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\n\nvar _dec, _class, _class2, _temp;\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport cn from 'classnames';\nimport { isKeyEscape } from \"../../../lib/events/keyboard/identifiers\";\nimport { DatePickerLocaleHelper } from \"../../../components/DatePicker/locale\";\nimport { locale } from \"../../../lib/locale/decorators\";\nimport { RenderLayer } from \"../../RenderLayer\";\nimport { DropdownContainer } from \"../../DropdownContainer\";\nimport * as LayoutEvents from \"../../../lib/LayoutEvents\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { ArrowTriangleDownIcon, ArrowTriangleUpDownIcon, ArrowTriangleUpIcon } from \"../../icons/16px\";\nimport { jsStyles } from \"../DateSelect.styles\";\nvar itemHeight = 24;\nvar visibleYearsCount = 11;\nvar itemsToMoveCount = -5;\nvar monthsCount = 12;\nvar defaultMinYear = 1900;\nvar defaultMaxYear = 2100;\nexport var DateSelect = (_dec = locale('DatePicker', DatePickerLocaleHelper), _dec(_class = (_temp = _class2 =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(DateSelect, _React$Component);\n\n  function DateSelect() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      botCapped: false,\n      current: 0,\n      height: 0,\n      opened: false,\n      pos: 0,\n      top: 0,\n      topCapped: false,\n      nodeTop: Infinity\n    };\n    _this.theme = void 0;\n    _this.locale = void 0;\n    _this.root = null;\n    _this.itemsContainer = null;\n    _this.listener = void 0;\n    _this.timeout = void 0;\n    _this.longClickTimer = 0;\n    _this.setPositionRepeatTimer = 0;\n    _this.yearStep = 3;\n\n    _this.open = function () {\n      if (_this.props.disabled) {\n        return;\n      }\n\n      if (_this.state.opened) {\n        return;\n      }\n\n      _this.setPosition(0);\n\n      _this.setState({\n        opened: true,\n        current: 0\n      });\n    };\n\n    _this.close = function () {\n      if (!_this.state.opened) {\n        return;\n      }\n\n      _this.setState({\n        opened: false\n      });\n    };\n\n    _this.refRoot = function (element) {\n      _this.root = element;\n    };\n\n    _this.setNodeTop = function () {\n      var root = _this.root;\n\n      if (!root) {\n        return;\n      }\n\n      if (_this.timeout) {\n        clearTimeout(_this.timeout);\n      }\n\n      _this.timeout = setTimeout(function () {\n        return _this.setState({\n          nodeTop: root.getBoundingClientRect().top\n        });\n      });\n    };\n\n    _this.refItemsContainer = function (element) {\n      if (!_this.itemsContainer && element) {\n        element.addEventListener('wheel', _this.handleWheel, {\n          passive: false\n        });\n      }\n\n      if (_this.itemsContainer && !element) {\n        _this.itemsContainer.removeEventListener('wheel', _this.handleWheel);\n      }\n\n      _this.itemsContainer = element;\n    };\n\n    _this.handleLongClickUp = function (event) {\n      event.preventDefault();\n      _this.longClickTimer = window.setTimeout(function () {\n        _this.setPositionRepeatTimer = window.setInterval(function () {\n          return _this.setPosition(_this.state.pos - itemHeight);\n        }, 100);\n      }, 200);\n    };\n\n    _this.handleLongClickDown = function (event) {\n      event.preventDefault();\n      _this.longClickTimer = window.setTimeout(function () {\n        _this.setPositionRepeatTimer = window.setInterval(function () {\n          return _this.setPosition(_this.state.pos + itemHeight);\n        }, 100);\n      }, 200);\n    };\n\n    _this.handleLongClickStop = function () {\n      clearTimeout(_this.longClickTimer);\n      clearTimeout(_this.setPositionRepeatTimer);\n    };\n\n    _this.getAnchor = function () {\n      return _this.root;\n    };\n\n    _this.handleWheel = function (event) {\n      if (!(event instanceof WheelEvent)) {\n        return;\n      }\n\n      event.preventDefault();\n      event.stopPropagation();\n      var deltaY = event.deltaY;\n\n      if (event.deltaMode === 1) {\n        deltaY *= itemHeight;\n      } else if (event.deltaMode === 2) {\n        deltaY *= itemHeight * 4;\n      }\n\n      var pos = _this.state.pos + deltaY;\n\n      _this.setPosition(pos);\n    };\n\n    _this.handleItemClick = function (shift) {\n      return function (e) {\n        var value = _this.props.value + shift;\n\n        if (_this.props.onValueChange) {\n          _this.props.onValueChange(value);\n        }\n\n        _this.setState({\n          opened: false\n        });\n      };\n    };\n\n    _this.handleKey = function (e) {\n      if (_this.state.opened && isKeyEscape(e)) {\n        e.preventDefault();\n\n        _this.close();\n\n        e.stopPropagation();\n      }\n    };\n\n    _this.handleUp = function (event) {\n      event.preventDefault();\n\n      _this.setPosition(_this.state.pos - itemHeight * _this.yearStep);\n    };\n\n    _this.handleDown = function (event) {\n      event.preventDefault();\n\n      _this.setPosition(_this.state.pos + itemHeight * _this.yearStep);\n    };\n\n    return _this;\n  }\n\n  var _proto = DateSelect.prototype;\n\n  _proto.UNSAFE_componentWillReceiveProps = function UNSAFE_componentWillReceiveProps() {\n    this.setNodeTop();\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.listener = LayoutEvents.addListener(this.setNodeTop);\n    this.setNodeTop();\n    window.addEventListener('keydown', this.handleKey);\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    if (this.listener) {\n      this.listener.remove();\n    }\n\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n\n    if (this.longClickTimer) {\n      clearTimeout(this.longClickTimer);\n    }\n\n    if (this.setPositionRepeatTimer) {\n      clearTimeout(this.setPositionRepeatTimer);\n    }\n\n    window.removeEventListener('keydown', this.handleKey);\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var _cn, _cn2;\n\n    var _this$props = this.props,\n        width = _this$props.width,\n        disabled = _this$props.disabled;\n    var rootProps = {\n      className: cn((_cn = {}, _cn[jsStyles.root(this.theme)] = true, _cn[jsStyles.disabled()] = Boolean(disabled), _cn)),\n      style: {\n        width: width\n      },\n      ref: this.refRoot\n    };\n    return React.createElement(\"span\", rootProps, React.createElement(\"div\", {\n      \"data-tid\": \"DateSelect__caption\",\n      className: jsStyles.caption(),\n      onClick: this.open\n    }, this.getItem(0), React.createElement(\"div\", {\n      className: cn((_cn2 = {}, _cn2[jsStyles.arrow(this.theme)] = true, _cn2[jsStyles.arrowDisabled()] = Boolean(disabled), _cn2))\n    }, React.createElement(ArrowTriangleUpDownIcon, {\n      size: 12\n    }))), this.state.opened && this.renderMenu());\n  };\n\n  _proto.disableItems = function disableItems(index) {\n    var value = this.props.value + index;\n\n    if (this.props.maxValue != null && this.props.minValue != null) {\n      return value > this.props.maxValue || value < this.props.minValue;\n    }\n\n    if (this.props.minValue != null) {\n      return value < this.props.minValue;\n    }\n\n    if (this.props.maxValue != null) {\n      return value > this.props.maxValue;\n    }\n  };\n\n  _proto.renderMenu = function renderMenu() {\n    var _this3 = this,\n        _cn3;\n\n    var _this$state = this.state,\n        top = _this$state.top,\n        height = _this$state.height,\n        nodeTop = _this$state.nodeTop;\n    var shift = this.state.pos % itemHeight;\n\n    if (shift < 0) {\n      shift += itemHeight;\n    }\n\n    var from = (this.state.pos - shift + top) / itemHeight;\n    var to = from + Math.ceil((height + shift) / itemHeight);\n    var items = [];\n\n    var _loop = function _loop(i) {\n      var _cn4;\n\n      var disableItems = _this3.disableItems(i) || false;\n      var className = cn((_cn4 = {}, _cn4[jsStyles.menuItem(_this3.theme)] = true, _cn4[jsStyles.menuItemSelected(_this3.theme)] = i === 0, _cn4[jsStyles.menuItemActive(_this3.theme)] = i === _this3.state.current, _cn4[jsStyles.menuItemDisabled(_this3.theme)] = disableItems, _cn4));\n      var clickHandler = {\n        onMouseDown: preventDefault,\n        onClick: _this3.handleItemClick(i)\n      };\n      items.push(React.createElement(\"div\", _extends({\n        \"data-tid\": \"DateSelect__menuItem\",\n        \"data-prop-disabled\": disableItems,\n        key: i,\n        className: className,\n        onMouseEnter: function onMouseEnter() {\n          return _this3.setState({\n            current: i\n          });\n        },\n        onMouseLeave: function onMouseLeave() {\n          return _this3.setState({\n            current: null\n          });\n        }\n      }, clickHandler), _this3.getItem(i)));\n    };\n\n    for (var i = from; i < to; ++i) {\n      _loop(i);\n    }\n\n    var style = {\n      top: top - 5,\n      left: 0,\n      right: 0\n    };\n    var shiftStyle = {\n      position: 'relative',\n      top: -shift\n    };\n    var holderClass = cn((_cn3 = {}, _cn3[jsStyles.menuHolder(this.theme)] = true, _cn3[jsStyles.isTopCapped()] = this.state.topCapped, _cn3[jsStyles.isBotCapped()] = this.state.botCapped, _cn3));\n    var dropdownOffset = -itemHeight;\n\n    if (nodeTop < -top) {\n      var overflowOffsetDelta = this.state.topCapped ? 6 : 17;\n      dropdownOffset -= nodeTop + top - overflowOffsetDelta;\n    }\n\n    return React.createElement(RenderLayer, {\n      onClickOutside: this.close,\n      onFocusOutside: this.close,\n      active: true\n    }, React.createElement(\"div\", null, React.createElement(DropdownContainer, {\n      getParent: this.getAnchor,\n      offsetY: dropdownOffset,\n      offsetX: -10\n    }, React.createElement(\"div\", {\n      className: holderClass,\n      style: style\n    }, !this.state.topCapped && React.createElement(\"div\", {\n      className: jsStyles.menuUp(this.theme),\n      onClick: this.handleUp,\n      onMouseDown: this.handleLongClickUp,\n      onMouseUp: this.handleLongClickStop,\n      onMouseLeave: this.handleLongClickStop,\n      onTouchStart: this.handleLongClickUp,\n      onTouchEnd: this.handleLongClickStop\n    }, React.createElement(\"span\", null, React.createElement(ArrowTriangleUpIcon, null))), React.createElement(\"div\", {\n      className: jsStyles.itemsHolder(),\n      style: {\n        height: height\n      }\n    }, React.createElement(\"div\", {\n      ref: this.refItemsContainer,\n      style: shiftStyle\n    }, items)), !this.state.botCapped && React.createElement(\"div\", {\n      className: jsStyles.menuDown(this.theme),\n      onClick: this.handleDown,\n      onMouseDown: this.handleLongClickDown,\n      onMouseUp: this.handleLongClickStop,\n      onMouseLeave: this.handleLongClickStop,\n      onTouchStart: this.handleLongClickDown,\n      onTouchEnd: this.handleLongClickStop\n    }, React.createElement(\"span\", null, React.createElement(ArrowTriangleDownIcon, null)))))));\n  };\n\n  _proto.getItem = function getItem(index) {\n    var value = this.props.value + index;\n\n    if (this.props.type === 'month') {\n      return this.locale.months[value];\n    }\n\n    return value;\n  };\n\n  _proto.setPosition = function setPosition(pos) {\n    var top = itemsToMoveCount * itemHeight;\n    var height = visibleYearsCount * itemHeight;\n\n    if (this.props.type === 'month') {\n      top = -this.props.value * itemHeight;\n      height = monthsCount * itemHeight;\n    }\n\n    var minPos = this.getMinPos() - top;\n    var maxPos = this.getMaxPos() - top - height + itemHeight;\n\n    if (minPos >= pos) {\n      pos = minPos;\n    }\n\n    if (maxPos <= pos) {\n      pos = maxPos;\n    }\n\n    var topCapped = pos <= minPos;\n    var botCapped = pos >= maxPos;\n    this.setState({\n      pos: pos,\n      top: top,\n      height: height,\n      topCapped: topCapped,\n      botCapped: botCapped\n    });\n  };\n\n  _proto.getMinPos = function getMinPos() {\n    if (this.props.type === 'month') {\n      return -this.props.value * itemHeight;\n    } else if (this.props.type === 'year') {\n      return ((this.props.minValue || defaultMinYear) - this.props.value) * itemHeight;\n    }\n\n    return -Infinity; // Be defensive.\n  };\n\n  _proto.getMaxPos = function getMaxPos() {\n    if (this.props.type === 'month') {\n      return (visibleYearsCount - this.props.value) * itemHeight;\n    } else if (this.props.type === 'year') {\n      return ((this.props.maxValue || defaultMaxYear) - this.props.value) * itemHeight;\n    }\n\n    return Infinity; // Be defensive.\n  };\n\n  return DateSelect;\n}(React.Component), _class2.__KONTUR_REACT_UI__ = 'DateSelect', _class2.propTypes = {\n  disabled: PropTypes.bool,\n  type: PropTypes.string,\n  value: PropTypes.number.isRequired,\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  onValueChange: PropTypes.func,\n  minValue: PropTypes.number,\n  maxValue: PropTypes.number\n}, _class2.defaultProps = {\n  type: 'year',\n  minMonth: 0,\n  maxMonth: 11,\n  width: 'auto'\n}, _temp)) || _class);\n\nfunction preventDefault(e) {\n  e.preventDefault();\n}"]},"metadata":{},"sourceType":"module"}