{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport cn from 'classnames';\nimport { isKeyTab, isShortcutPaste } from \"../../../lib/events/keyboard/identifiers\";\nimport { MouseDrag } from \"../../../lib/events/MouseDrag\";\nimport { isEdge, isIE11 } from \"../../../lib/utils\";\nimport { removeAllSelections, selectNodeContents } from \"../../../components/DateInput/helpers/SelectionHelpers\";\nimport { jsStyles as jsInputStyles } from \"../../../components/Input/Input.styles\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { jsStyles } from \"../InputLikeText.styles\";\nimport { HiddenInput } from \"../HiddenInput\";\nexport var InputLikeText = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(InputLikeText, _React$Component);\n\n  function InputLikeText() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      blinking: false,\n      focused: false\n    };\n    _this.theme = void 0;\n    _this.node = null;\n    _this.hiddenInput = null;\n    _this.lastSelectedInnerNode = null;\n    _this.frozen = false;\n    _this.frozenBlur = false;\n    _this.dragging = false;\n    _this.focusTimeout = void 0;\n    _this.blinkTimeout = void 0;\n\n    _this.selectInnerNode = function (node, start, end) {\n      if (start === void 0) {\n        start = 0;\n      }\n\n      if (end === void 0) {\n        end = 1;\n      }\n\n      if (_this.dragging || !node) {\n        return;\n      }\n\n      _this.frozen = true;\n      _this.frozenBlur = true;\n      _this.lastSelectedInnerNode = [node, start, end];\n      setTimeout(function () {\n        return selectNodeContents(node, start, end);\n      }, 0);\n\n      if (_this.focusTimeout) {\n        clearInterval(_this.focusTimeout);\n      }\n\n      _this.focusTimeout = window.setTimeout(function () {\n        return (isIE11 || isEdge) && _this.node && _this.node.focus();\n      }, 0);\n    };\n\n    _this.renderLeftIcon = function () {\n      return _this.renderIcon(_this.props.leftIcon, jsInputStyles.leftIcon());\n    };\n\n    _this.renderRightIcon = function () {\n      return _this.renderIcon(_this.props.rightIcon, jsInputStyles.rightIcon());\n    };\n\n    _this.renderIcon = function (icon, className) {\n      if (!icon) {\n        return null;\n      }\n\n      if (icon instanceof Function) {\n        return React.createElement(\"span\", {\n          className: className\n        }, icon());\n      }\n\n      return React.createElement(\"span\", {\n        className: cn(className, jsInputStyles.useDefaultColor(_this.theme))\n      }, icon);\n    };\n\n    _this.renderPrefix = function () {\n      var prefix = _this.props.prefix;\n\n      if (!prefix) {\n        return null;\n      }\n\n      return React.createElement(\"span\", {\n        className: jsInputStyles.prefix(_this.theme)\n      }, prefix);\n    };\n\n    _this.renderSuffix = function () {\n      var suffix = _this.props.suffix;\n\n      if (!suffix) {\n        return null;\n      }\n\n      return React.createElement(\"span\", {\n        className: jsInputStyles.suffix(_this.theme)\n      }, suffix);\n    };\n\n    _this.renderLeftSide = function () {\n      var leftIcon = _this.renderLeftIcon();\n\n      var prefix = _this.renderPrefix();\n\n      if (!leftIcon && !prefix) {\n        return null;\n      }\n\n      return React.createElement(\"span\", {\n        className: jsInputStyles.sideContainer()\n      }, leftIcon, prefix);\n    };\n\n    _this.renderRightSide = function () {\n      var rightIcon = _this.renderRightIcon();\n\n      var suffix = _this.renderSuffix();\n\n      if (!rightIcon && !suffix) {\n        return null;\n      }\n\n      return React.createElement(\"span\", {\n        className: jsInputStyles.sideContainer()\n      }, rightIcon, suffix);\n    };\n\n    _this.renderPlaceholder = function () {\n      var _this$props = _this.props,\n          children = _this$props.children,\n          placeholder = _this$props.placeholder;\n\n      if (!children && placeholder) {\n        return React.createElement(\"span\", {\n          className: jsInputStyles.placeholder(_this.theme)\n        }, placeholder);\n      }\n\n      return null;\n    };\n\n    _this.handleDocumentMouseDown = function (e) {\n      if (_this.state.focused && _this.node && e.target instanceof Node && !_this.node.contains(e.target)) {\n        _this.defrost();\n      }\n    };\n\n    _this.handleDocumentKeyDown = function (e) {\n      if (_this.state.focused && isKeyTab(e)) {\n        _this.defrost();\n      }\n    };\n\n    _this.handleMouseDown = function (e) {\n      _this.frozen = true;\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (_this.props.disabled) {\n        return;\n      }\n\n      if (isIE11 && isShortcutPaste(e) && _this.hiddenInput) {\n        _this.frozen = true;\n        setTimeout(function () {\n          if (_this.lastSelectedInnerNode) {\n            var _this2;\n\n            (_this2 = _this).selectInnerNode.apply(_this2, _this.lastSelectedInnerNode);\n          }\n\n          if (_this.node) {\n            _this.node.focus();\n          }\n        }, 0);\n\n        _this.hiddenInput.focus();\n      }\n\n      if (_this.props.onKeyDown) {\n        _this.props.onKeyDown(e);\n      }\n    };\n\n    _this.handleMouseDragStart = function (e) {\n      _this.dragging = true;\n      document.documentElement.classList.add(jsStyles.userSelectNone());\n\n      if (_this.props.onMouseDragStart) {\n        _this.props.onMouseDragStart(e);\n      }\n    };\n\n    _this.handleMouseDragEnd = function (e) {\n      // Дожидаемся onMouseUp\n      setTimeout(function () {\n        _this.dragging = false;\n\n        if (_this.props.onMouseDragEnd) {\n          _this.props.onMouseDragEnd(e);\n        }\n      }, 0);\n      document.documentElement.classList.remove(jsStyles.userSelectNone());\n    };\n\n    _this.handleFocus = function (e) {\n      if (_this.props.disabled) {\n        if (isIE11) {\n          selectNodeContents(document.body, 0, 0);\n        }\n\n        return;\n      }\n\n      if ((isIE11 || isEdge) && _this.frozen) {\n        _this.frozen = false;\n\n        if (_this.state.focused) {\n          return;\n        }\n      }\n\n      _this.setState({\n        focused: true\n      });\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus(e);\n      }\n    };\n\n    _this.handleBlur = function (e) {\n      if (_this.props.disabled) {\n        e.stopPropagation();\n        return;\n      }\n\n      if ((isIE11 || isEdge) && _this.frozenBlur) {\n        _this.frozenBlur = false;\n        return;\n      }\n\n      if ((isIE11 || isEdge) && _this.frozen) {\n        return;\n      }\n\n      removeAllSelections();\n\n      _this.setState({\n        focused: false\n      });\n\n      if (_this.props.onBlur) {\n        _this.props.onBlur(e);\n      }\n    };\n\n    _this.hiddenInputRef = function (el) {\n      _this.hiddenInput = el;\n    };\n\n    _this.innerRef = function (el) {\n      if (_this.props.innerRef) {\n        _this.props.innerRef(el);\n      }\n\n      _this.node = el;\n    };\n\n    _this.defrost = function () {\n      _this.frozen = false;\n      _this.frozenBlur = false;\n    };\n\n    _this.getSizeClassName = function () {\n      var _ref, _ref2, _ref3;\n\n      switch (_this.props.size) {\n        case 'large':\n          return _ref = {}, _ref[jsInputStyles.sizeLarge(_this.theme)] = true, _ref[jsInputStyles.sizeLargeFallback(_this.theme)] = isIE11 || isEdge, _ref;\n\n        case 'medium':\n          return _ref2 = {}, _ref2[jsInputStyles.sizeMedium(_this.theme)] = true, _ref2[jsInputStyles.sizeMediumFallback(_this.theme)] = isIE11 || isEdge, _ref2;\n\n        case 'small':\n        default:\n          return _ref3 = {}, _ref3[jsInputStyles.sizeSmall(_this.theme)] = true, _ref3[jsInputStyles.sizeSmallFallback(_this.theme)] = isIE11 || isEdge, _ref3;\n      }\n    };\n\n    return _this;\n  }\n\n  var _proto = InputLikeText.prototype;\n  /**\r\n   * @public\r\n   */\n\n  _proto.focus = function focus() {\n    if (this.node) {\n      this.node.focus();\n    }\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.blur = function blur() {\n    if (this.node) {\n      this.node.blur();\n    }\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.blink = function blink() {\n    var _this3 = this;\n\n    if (this.props.disabled) {\n      return;\n    }\n\n    this.setState({\n      blinking: true\n    }, function () {\n      _this3.blinkTimeout = window.setTimeout(function () {\n        return _this3.setState({\n          blinking: false\n        });\n      }, 150);\n    });\n  };\n\n  _proto.getNode = function getNode() {\n    return this.node;\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    if (this.node) {\n      MouseDrag.listen(this.node).onMouseDragStart(this.handleMouseDragStart).onMouseDragEnd(this.handleMouseDragEnd);\n    }\n\n    document.addEventListener('mousedown', this.handleDocumentMouseDown);\n    document.addEventListener('keydown', this.handleDocumentKeyDown);\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    if (this.blinkTimeout) {\n      clearTimeout(this.blinkTimeout);\n    }\n\n    MouseDrag.stop(this.node);\n    document.removeEventListener('mousedown', this.handleDocumentMouseDown);\n    document.removeEventListener('keydown', this.handleDocumentKeyDown);\n  };\n\n  _proto.render = function render() {\n    var _this4 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this4.theme = theme;\n      return _this4.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var _cn, _cn2;\n\n    var _this$props2 = this.props,\n        innerRef = _this$props2.innerRef,\n        tabIndex = _this$props2.tabIndex,\n        placeholder = _this$props2.placeholder,\n        align = _this$props2.align,\n        borderless = _this$props2.borderless,\n        width = _this$props2.width,\n        children = _this$props2.children,\n        error = _this$props2.error,\n        warning = _this$props2.warning,\n        onValueChange = _this$props2.onValueChange,\n        disabled = _this$props2.disabled,\n        prefix = _this$props2.prefix,\n        suffix = _this$props2.suffix,\n        leftIcon = _this$props2.leftIcon,\n        rightIcon = _this$props2.rightIcon,\n        value = _this$props2.value,\n        onMouseDragStart = _this$props2.onMouseDragStart,\n        onMouseDragEnd = _this$props2.onMouseDragEnd,\n        rest = _objectWithoutPropertiesLoose(_this$props2, [\"innerRef\", \"tabIndex\", \"placeholder\", \"align\", \"borderless\", \"width\", \"children\", \"error\", \"warning\", \"onValueChange\", \"disabled\", \"prefix\", \"suffix\", \"leftIcon\", \"rightIcon\", \"value\", \"onMouseDragStart\", \"onMouseDragEnd\"]);\n\n    var _this$state = this.state,\n        focused = _this$state.focused,\n        blinking = _this$state.blinking;\n    var leftSide = this.renderLeftSide();\n    var rightSide = this.renderRightSide();\n    var className = cn(jsStyles.root(), jsInputStyles.root(this.theme), this.getSizeClassName(), (_cn = {}, _cn[jsInputStyles.borderless()] = !!borderless, _cn[jsStyles.withoutLeftSide()] = !leftSide, _cn[jsInputStyles.focus(this.theme)] = focused, _cn[jsInputStyles.blink(this.theme)] = blinking, _cn[jsInputStyles.warning(this.theme)] = !!warning, _cn[jsInputStyles.error(this.theme)] = !!error, _cn[jsInputStyles.disabled(this.theme)] = !!disabled, _cn[jsInputStyles.focusFallback(this.theme)] = focused && (isIE11 || isEdge), _cn[jsInputStyles.warningFallback(this.theme)] = !!warning && (isIE11 || isEdge), _cn[jsInputStyles.errorFallback(this.theme)] = !!error && (isIE11 || isEdge), _cn));\n    var wrapperClass = cn(jsInputStyles.wrapper(), (_cn2 = {}, _cn2[jsStyles.userSelectContain()] = focused, _cn2));\n    return React.createElement(\"span\", _extends({}, rest, {\n      className: className,\n      style: {\n        width: width,\n        textAlign: align\n      },\n      tabIndex: disabled ? undefined : 0,\n      onFocus: this.handleFocus,\n      onBlur: this.handleBlur,\n      ref: this.innerRef,\n      onKeyDown: this.handleKeyDown,\n      onMouseDown: this.handleMouseDown\n    }), React.createElement(\"input\", {\n      type: \"hidden\",\n      value: value\n    }), leftSide, React.createElement(\"span\", {\n      className: wrapperClass\n    }, React.createElement(\"span\", {\n      \"data-tid\": \"InputLikeText__input\",\n      className: cn(jsStyles.input(), jsInputStyles.input(this.theme))\n    }, children), this.renderPlaceholder()), rightSide, isIE11 && focused && React.createElement(HiddenInput, {\n      nodeRef: this.hiddenInputRef\n    }));\n  };\n\n  return InputLikeText;\n}(React.Component);\nInputLikeText.__KONTUR_REACT_UI__ = 'InputLikeText';\nInputLikeText.defaultProps = {\n  size: 'small'\n};","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/internal/InputLikeText/InputLikeText/InputLikeText.js"],"names":["_extends","_objectWithoutPropertiesLoose","_inheritsLoose","React","cn","isKeyTab","isShortcutPaste","MouseDrag","isEdge","isIE11","removeAllSelections","selectNodeContents","jsStyles","jsInputStyles","ThemeContext","HiddenInput","InputLikeText","_React$Component","_this","_len","arguments","length","args","Array","_key","call","apply","concat","state","blinking","focused","theme","node","hiddenInput","lastSelectedInnerNode","frozen","frozenBlur","dragging","focusTimeout","blinkTimeout","selectInnerNode","start","end","setTimeout","clearInterval","window","focus","renderLeftIcon","renderIcon","props","leftIcon","renderRightIcon","rightIcon","icon","className","Function","createElement","useDefaultColor","renderPrefix","prefix","renderSuffix","suffix","renderLeftSide","sideContainer","renderRightSide","renderPlaceholder","_this$props","children","placeholder","handleDocumentMouseDown","e","target","Node","contains","defrost","handleDocumentKeyDown","handleMouseDown","handleKeyDown","disabled","_this2","onKeyDown","handleMouseDragStart","document","documentElement","classList","add","userSelectNone","onMouseDragStart","handleMouseDragEnd","onMouseDragEnd","remove","handleFocus","body","setState","onFocus","handleBlur","stopPropagation","onBlur","hiddenInputRef","el","innerRef","getSizeClassName","_ref","_ref2","_ref3","size","sizeLarge","sizeLargeFallback","sizeMedium","sizeMediumFallback","sizeSmall","sizeSmallFallback","_proto","prototype","blur","blink","_this3","getNode","componentDidMount","listen","addEventListener","componentWillUnmount","clearTimeout","stop","removeEventListener","render","_this4","Consumer","renderMain","_cn","_cn2","_this$props2","tabIndex","align","borderless","width","error","warning","onValueChange","value","rest","_this$state","leftSide","rightSide","root","withoutLeftSide","focusFallback","warningFallback","errorFallback","wrapperClass","wrapper","userSelectContain","style","textAlign","undefined","ref","onMouseDown","type","input","nodeRef","Component","__KONTUR_REACT_UI__","defaultProps"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\nimport React from 'react';\nimport cn from 'classnames';\nimport { isKeyTab, isShortcutPaste } from \"../../../lib/events/keyboard/identifiers\";\nimport { MouseDrag } from \"../../../lib/events/MouseDrag\";\nimport { isEdge, isIE11 } from \"../../../lib/utils\";\nimport { removeAllSelections, selectNodeContents } from \"../../../components/DateInput/helpers/SelectionHelpers\";\nimport { jsStyles as jsInputStyles } from \"../../../components/Input/Input.styles\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { jsStyles } from \"../InputLikeText.styles\";\nimport { HiddenInput } from \"../HiddenInput\";\nexport var InputLikeText =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(InputLikeText, _React$Component);\n\n  function InputLikeText() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n    _this.state = {\n      blinking: false,\n      focused: false\n    };\n    _this.theme = void 0;\n    _this.node = null;\n    _this.hiddenInput = null;\n    _this.lastSelectedInnerNode = null;\n    _this.frozen = false;\n    _this.frozenBlur = false;\n    _this.dragging = false;\n    _this.focusTimeout = void 0;\n    _this.blinkTimeout = void 0;\n\n    _this.selectInnerNode = function (node, start, end) {\n      if (start === void 0) {\n        start = 0;\n      }\n\n      if (end === void 0) {\n        end = 1;\n      }\n\n      if (_this.dragging || !node) {\n        return;\n      }\n\n      _this.frozen = true;\n      _this.frozenBlur = true;\n      _this.lastSelectedInnerNode = [node, start, end];\n      setTimeout(function () {\n        return selectNodeContents(node, start, end);\n      }, 0);\n\n      if (_this.focusTimeout) {\n        clearInterval(_this.focusTimeout);\n      }\n\n      _this.focusTimeout = window.setTimeout(function () {\n        return (isIE11 || isEdge) && _this.node && _this.node.focus();\n      }, 0);\n    };\n\n    _this.renderLeftIcon = function () {\n      return _this.renderIcon(_this.props.leftIcon, jsInputStyles.leftIcon());\n    };\n\n    _this.renderRightIcon = function () {\n      return _this.renderIcon(_this.props.rightIcon, jsInputStyles.rightIcon());\n    };\n\n    _this.renderIcon = function (icon, className) {\n      if (!icon) {\n        return null;\n      }\n\n      if (icon instanceof Function) {\n        return React.createElement(\"span\", {\n          className: className\n        }, icon());\n      }\n\n      return React.createElement(\"span\", {\n        className: cn(className, jsInputStyles.useDefaultColor(_this.theme))\n      }, icon);\n    };\n\n    _this.renderPrefix = function () {\n      var prefix = _this.props.prefix;\n\n      if (!prefix) {\n        return null;\n      }\n\n      return React.createElement(\"span\", {\n        className: jsInputStyles.prefix(_this.theme)\n      }, prefix);\n    };\n\n    _this.renderSuffix = function () {\n      var suffix = _this.props.suffix;\n\n      if (!suffix) {\n        return null;\n      }\n\n      return React.createElement(\"span\", {\n        className: jsInputStyles.suffix(_this.theme)\n      }, suffix);\n    };\n\n    _this.renderLeftSide = function () {\n      var leftIcon = _this.renderLeftIcon();\n\n      var prefix = _this.renderPrefix();\n\n      if (!leftIcon && !prefix) {\n        return null;\n      }\n\n      return React.createElement(\"span\", {\n        className: jsInputStyles.sideContainer()\n      }, leftIcon, prefix);\n    };\n\n    _this.renderRightSide = function () {\n      var rightIcon = _this.renderRightIcon();\n\n      var suffix = _this.renderSuffix();\n\n      if (!rightIcon && !suffix) {\n        return null;\n      }\n\n      return React.createElement(\"span\", {\n        className: jsInputStyles.sideContainer()\n      }, rightIcon, suffix);\n    };\n\n    _this.renderPlaceholder = function () {\n      var _this$props = _this.props,\n          children = _this$props.children,\n          placeholder = _this$props.placeholder;\n\n      if (!children && placeholder) {\n        return React.createElement(\"span\", {\n          className: jsInputStyles.placeholder(_this.theme)\n        }, placeholder);\n      }\n\n      return null;\n    };\n\n    _this.handleDocumentMouseDown = function (e) {\n      if (_this.state.focused && _this.node && e.target instanceof Node && !_this.node.contains(e.target)) {\n        _this.defrost();\n      }\n    };\n\n    _this.handleDocumentKeyDown = function (e) {\n      if (_this.state.focused && isKeyTab(e)) {\n        _this.defrost();\n      }\n    };\n\n    _this.handleMouseDown = function (e) {\n      _this.frozen = true;\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (_this.props.disabled) {\n        return;\n      }\n\n      if (isIE11 && isShortcutPaste(e) && _this.hiddenInput) {\n        _this.frozen = true;\n        setTimeout(function () {\n          if (_this.lastSelectedInnerNode) {\n            var _this2;\n\n            (_this2 = _this).selectInnerNode.apply(_this2, _this.lastSelectedInnerNode);\n          }\n\n          if (_this.node) {\n            _this.node.focus();\n          }\n        }, 0);\n\n        _this.hiddenInput.focus();\n      }\n\n      if (_this.props.onKeyDown) {\n        _this.props.onKeyDown(e);\n      }\n    };\n\n    _this.handleMouseDragStart = function (e) {\n      _this.dragging = true;\n      document.documentElement.classList.add(jsStyles.userSelectNone());\n\n      if (_this.props.onMouseDragStart) {\n        _this.props.onMouseDragStart(e);\n      }\n    };\n\n    _this.handleMouseDragEnd = function (e) {\n      // Дожидаемся onMouseUp\n      setTimeout(function () {\n        _this.dragging = false;\n\n        if (_this.props.onMouseDragEnd) {\n          _this.props.onMouseDragEnd(e);\n        }\n      }, 0);\n      document.documentElement.classList.remove(jsStyles.userSelectNone());\n    };\n\n    _this.handleFocus = function (e) {\n      if (_this.props.disabled) {\n        if (isIE11) {\n          selectNodeContents(document.body, 0, 0);\n        }\n\n        return;\n      }\n\n      if ((isIE11 || isEdge) && _this.frozen) {\n        _this.frozen = false;\n\n        if (_this.state.focused) {\n          return;\n        }\n      }\n\n      _this.setState({\n        focused: true\n      });\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus(e);\n      }\n    };\n\n    _this.handleBlur = function (e) {\n      if (_this.props.disabled) {\n        e.stopPropagation();\n        return;\n      }\n\n      if ((isIE11 || isEdge) && _this.frozenBlur) {\n        _this.frozenBlur = false;\n        return;\n      }\n\n      if ((isIE11 || isEdge) && _this.frozen) {\n        return;\n      }\n\n      removeAllSelections();\n\n      _this.setState({\n        focused: false\n      });\n\n      if (_this.props.onBlur) {\n        _this.props.onBlur(e);\n      }\n    };\n\n    _this.hiddenInputRef = function (el) {\n      _this.hiddenInput = el;\n    };\n\n    _this.innerRef = function (el) {\n      if (_this.props.innerRef) {\n        _this.props.innerRef(el);\n      }\n\n      _this.node = el;\n    };\n\n    _this.defrost = function () {\n      _this.frozen = false;\n      _this.frozenBlur = false;\n    };\n\n    _this.getSizeClassName = function () {\n      var _ref, _ref2, _ref3;\n\n      switch (_this.props.size) {\n        case 'large':\n          return _ref = {}, _ref[jsInputStyles.sizeLarge(_this.theme)] = true, _ref[jsInputStyles.sizeLargeFallback(_this.theme)] = isIE11 || isEdge, _ref;\n\n        case 'medium':\n          return _ref2 = {}, _ref2[jsInputStyles.sizeMedium(_this.theme)] = true, _ref2[jsInputStyles.sizeMediumFallback(_this.theme)] = isIE11 || isEdge, _ref2;\n\n        case 'small':\n        default:\n          return _ref3 = {}, _ref3[jsInputStyles.sizeSmall(_this.theme)] = true, _ref3[jsInputStyles.sizeSmallFallback(_this.theme)] = isIE11 || isEdge, _ref3;\n      }\n    };\n\n    return _this;\n  }\n\n  var _proto = InputLikeText.prototype;\n  /**\r\n   * @public\r\n   */\n\n  _proto.focus = function focus() {\n    if (this.node) {\n      this.node.focus();\n    }\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.blur = function blur() {\n    if (this.node) {\n      this.node.blur();\n    }\n  }\n  /**\r\n   * @public\r\n   */\n  ;\n\n  _proto.blink = function blink() {\n    var _this3 = this;\n\n    if (this.props.disabled) {\n      return;\n    }\n\n    this.setState({\n      blinking: true\n    }, function () {\n      _this3.blinkTimeout = window.setTimeout(function () {\n        return _this3.setState({\n          blinking: false\n        });\n      }, 150);\n    });\n  };\n\n  _proto.getNode = function getNode() {\n    return this.node;\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    if (this.node) {\n      MouseDrag.listen(this.node).onMouseDragStart(this.handleMouseDragStart).onMouseDragEnd(this.handleMouseDragEnd);\n    }\n\n    document.addEventListener('mousedown', this.handleDocumentMouseDown);\n    document.addEventListener('keydown', this.handleDocumentKeyDown);\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    if (this.blinkTimeout) {\n      clearTimeout(this.blinkTimeout);\n    }\n\n    MouseDrag.stop(this.node);\n    document.removeEventListener('mousedown', this.handleDocumentMouseDown);\n    document.removeEventListener('keydown', this.handleDocumentKeyDown);\n  };\n\n  _proto.render = function render() {\n    var _this4 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this4.theme = theme;\n      return _this4.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var _cn, _cn2;\n\n    var _this$props2 = this.props,\n        innerRef = _this$props2.innerRef,\n        tabIndex = _this$props2.tabIndex,\n        placeholder = _this$props2.placeholder,\n        align = _this$props2.align,\n        borderless = _this$props2.borderless,\n        width = _this$props2.width,\n        children = _this$props2.children,\n        error = _this$props2.error,\n        warning = _this$props2.warning,\n        onValueChange = _this$props2.onValueChange,\n        disabled = _this$props2.disabled,\n        prefix = _this$props2.prefix,\n        suffix = _this$props2.suffix,\n        leftIcon = _this$props2.leftIcon,\n        rightIcon = _this$props2.rightIcon,\n        value = _this$props2.value,\n        onMouseDragStart = _this$props2.onMouseDragStart,\n        onMouseDragEnd = _this$props2.onMouseDragEnd,\n        rest = _objectWithoutPropertiesLoose(_this$props2, [\"innerRef\", \"tabIndex\", \"placeholder\", \"align\", \"borderless\", \"width\", \"children\", \"error\", \"warning\", \"onValueChange\", \"disabled\", \"prefix\", \"suffix\", \"leftIcon\", \"rightIcon\", \"value\", \"onMouseDragStart\", \"onMouseDragEnd\"]);\n\n    var _this$state = this.state,\n        focused = _this$state.focused,\n        blinking = _this$state.blinking;\n    var leftSide = this.renderLeftSide();\n    var rightSide = this.renderRightSide();\n    var className = cn(jsStyles.root(), jsInputStyles.root(this.theme), this.getSizeClassName(), (_cn = {}, _cn[jsInputStyles.borderless()] = !!borderless, _cn[jsStyles.withoutLeftSide()] = !leftSide, _cn[jsInputStyles.focus(this.theme)] = focused, _cn[jsInputStyles.blink(this.theme)] = blinking, _cn[jsInputStyles.warning(this.theme)] = !!warning, _cn[jsInputStyles.error(this.theme)] = !!error, _cn[jsInputStyles.disabled(this.theme)] = !!disabled, _cn[jsInputStyles.focusFallback(this.theme)] = focused && (isIE11 || isEdge), _cn[jsInputStyles.warningFallback(this.theme)] = !!warning && (isIE11 || isEdge), _cn[jsInputStyles.errorFallback(this.theme)] = !!error && (isIE11 || isEdge), _cn));\n    var wrapperClass = cn(jsInputStyles.wrapper(), (_cn2 = {}, _cn2[jsStyles.userSelectContain()] = focused, _cn2));\n    return React.createElement(\"span\", _extends({}, rest, {\n      className: className,\n      style: {\n        width: width,\n        textAlign: align\n      },\n      tabIndex: disabled ? undefined : 0,\n      onFocus: this.handleFocus,\n      onBlur: this.handleBlur,\n      ref: this.innerRef,\n      onKeyDown: this.handleKeyDown,\n      onMouseDown: this.handleMouseDown\n    }), React.createElement(\"input\", {\n      type: \"hidden\",\n      value: value\n    }), leftSide, React.createElement(\"span\", {\n      className: wrapperClass\n    }, React.createElement(\"span\", {\n      \"data-tid\": \"InputLikeText__input\",\n      className: cn(jsStyles.input(), jsInputStyles.input(this.theme))\n    }, children), this.renderPlaceholder()), rightSide, isIE11 && focused && React.createElement(HiddenInput, {\n      nodeRef: this.hiddenInputRef\n    }));\n  };\n\n  return InputLikeText;\n}(React.Component);\nInputLikeText.__KONTUR_REACT_UI__ = 'InputLikeText';\nInputLikeText.defaultProps = {\n  size: 'small'\n};"]},"metadata":{},"sourceType":"module"}