{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\n\nvar _dec, _class, _class2, _temp;\n\nimport React from 'react';\nimport cn from 'classnames';\nimport { ConditionalHandler } from \"../../../lib/ConditionalHandler\";\nimport { LENGTH_FULLDATE, MAX_FULLDATE, MIN_FULLDATE } from \"../../../lib/date/constants\";\nimport { InternalDateComponentType } from \"../../../lib/date/types\";\nimport { DatePickerLocaleHelper } from \"../../DatePicker/locale\";\nimport { InputLikeText } from \"../../../internal/InputLikeText\";\nimport { locale } from \"../../../lib/locale/decorators\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { CalendarIcon } from \"../../../internal/icons/16px\";\nimport { DateFragmentsView } from \"../DateFragmentsView\";\nimport { jsStyles } from \"../DateInput.styles\";\nimport { Actions, extractAction } from \"../helpers/DateInputKeyboardActions\";\nimport { InternalDateMediator } from \"../helpers/InternalDateMediator\";\nexport var DateInput = (_dec = locale('DatePicker', DatePickerLocaleHelper), _dec(_class = (_temp = _class2 = /*#__PURE__*/function (_React$Component) {\n  _inheritsLoose(DateInput, _React$Component);\n\n  function DateInput(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.iDateMediator = new InternalDateMediator();\n    _this.inputLikeText = null;\n    _this.dateFragmentsView = null;\n    _this.isMouseDown = false;\n    _this.isMouseFocus = false;\n    _this.ignoringDelimiter = false;\n    _this.locale = void 0;\n    _this.blurEvent = null;\n    _this.theme = void 0;\n    _this.conditionalHandler = new ConditionalHandler().add(Actions.MoveSelectionLeft, function () {\n      return _this.shiftSelection(-1);\n    }).add(Actions.MoveSelectionRight, function () {\n      return _this.shiftSelection(1);\n    }).add(Actions.Separator, function () {\n      return _this.pressDelimiter();\n    }).add(Actions.MoveSelectionFirst, function () {\n      return _this.selectDateComponent(_this.iDateMediator.getLeftmostType());\n    }).add(Actions.MoveSelectionLast, function () {\n      return _this.selectDateComponent(_this.iDateMediator.getRightmostType());\n    }).add(Actions.Increment, function () {\n      return _this.shiftDateComponent(1);\n    }).add(Actions.Decrement, function () {\n      return _this.shiftDateComponent(-1);\n    }).add(Actions.Digit, function (e) {\n      return _this.inputValue(e);\n    }).add(Actions.ClearSelection, function () {\n      return _this.clearSelected();\n    }).add(Actions.ClearOneChar, function () {\n      return _this.clearOneChar();\n    }).add(Actions.FullSelection, function () {\n      return _this.fullSelection();\n    }).add(Actions.WrongInput, function () {\n      return _this.blink();\n    }).build();\n\n    _this.selectNode = function () {\n      var type = _this.state.selected;\n\n      var dateFragmentsView = _this.dateFragmentsView && _this.dateFragmentsView.getRootNode();\n\n      if (type === null || !_this.inputLikeText || !dateFragmentsView) {\n        return;\n      }\n\n      if (type === InternalDateComponentType.All) {\n        _this.inputLikeText.selectInnerNode(dateFragmentsView, 0, 5);\n\n        return;\n      }\n\n      var index = _this.iDateMediator.getTypesOrder().indexOf(type);\n\n      if (index > -1) {\n        _this.inputLikeText.selectInnerNode(dateFragmentsView, index * 2, index * 2 + 1);\n      }\n    };\n\n    _this.renderIcon = function () {\n      var _this$props = _this.props,\n          withIcon = _this$props.withIcon,\n          size = _this$props.size,\n          _this$props$disabled = _this$props.disabled,\n          disabled = _this$props$disabled === void 0 ? false : _this$props$disabled;\n\n      if (withIcon) {\n        var _cn;\n\n        var theme = _this.theme;\n        var iconStyles = cn((_cn = {}, _cn[jsStyles.icon(theme)] = true, _cn[jsStyles.iconSmall(theme)] = size === 'small', _cn[jsStyles.iconMedium(theme)] = size === 'medium', _cn[jsStyles.iconLarge(theme)] = size === 'large', _cn[jsStyles.iconDisabled(theme)] = disabled, _cn));\n        return React.createElement(\"span\", {\n          className: iconStyles\n        }, React.createElement(CalendarIcon, null));\n      }\n\n      return null;\n    };\n\n    _this.handleFocus = function (e) {\n      _this.setState(function (prevState) {\n        return {\n          focused: true,\n          selected: _this.isMouseDown && !prevState.focused ? prevState.selected : _this.iDateMediator.getLeftmostType()\n        };\n      });\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus(e);\n      }\n    };\n\n    _this.handleBlur = function (e) {\n      var restored = _this.iDateMediator.restore();\n\n      _this.updateValue({\n        focused: false,\n        selected: null,\n        inputMode: false\n      });\n\n      if (_this.props.onBlur) {\n        if (restored) {\n          e.persist();\n          _this.blurEvent = e;\n        } else {\n          _this.props.onBlur(e);\n        }\n      }\n    };\n\n    _this.handleMouseDownCapture = function (e) {\n      var isFragment = _this.dateFragmentsView ? _this.dateFragmentsView.isFragment(e.target) : false;\n\n      if (_this.state.focused && !isFragment) {\n        e.preventDefault();\n      }\n\n      _this.isMouseFocus = !_this.state.focused;\n      _this.isMouseDown = isFragment;\n    };\n\n    _this.handleSelectDateComponent = function (type) {\n      if (!(_this.isMouseFocus && _this.iDateMediator.isEmpty())) {\n        _this.selectDateComponent(type);\n      }\n\n      _this.isMouseFocus = false;\n      _this.isMouseDown = false;\n    };\n\n    _this.handleMouseDragStart = function () {\n      _this.setState({\n        dragged: true,\n        selected: null\n      });\n    };\n\n    _this.handleMouseDragEnd = function () {\n      var selection = getSelection();\n\n      if (selection && selection.toString().length === LENGTH_FULLDATE && _this.state.selected !== InternalDateComponentType.All) {\n        _this.selectDateComponent(InternalDateComponentType.All);\n      }\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (_this.conditionalHandler(extractAction(e), e)) {\n        e.preventDefault();\n      }\n\n      if (_this.props.onKeyDown) {\n        _this.props.onKeyDown(e);\n      }\n    };\n\n    _this.handlePaste = function (e) {\n      var pasted = e && e.clipboardData.getData('text').trim();\n\n      if (pasted && _this.iDateMediator.validateString(pasted)) {\n        _this.iDateMediator.paste(pasted);\n\n        _this.updateValue();\n      }\n    };\n\n    _this.handleDoubleClick = function () {\n      _this.selectDateComponent(InternalDateComponentType.All);\n    };\n\n    _this.inputLikeTextRef = function (el) {\n      _this.inputLikeText = el;\n    };\n\n    _this.dateFragmentsViewRef = function (el) {\n      _this.dateFragmentsView = el;\n    };\n\n    _this.selectDateComponent = function (selected) {\n      _this.setState({\n        selected: selected,\n        inputMode: false\n      });\n    };\n\n    _this.updateValue = function (state) {\n      if (state === void 0) {\n        state = {};\n      }\n\n      var valueFormatted = _this.iDateMediator.getString();\n\n      _this.setState(_extends({}, state, {\n        valueFormatted: valueFormatted\n      }), _this.emitChange);\n    };\n\n    _this.updateFromProps = function () {\n      _this.iDateMediator.update(_this.props, _this.locale);\n\n      _this.updateValue();\n    };\n\n    _this.fullSelection = function () {\n      _this.selectDateComponent(InternalDateComponentType.All);\n    };\n\n    _this.pressDelimiter = function () {\n      var value = _this.iDateMediator.get(_this.state.selected);\n\n      if (value !== null && value !== '') {\n        if (!_this.ignoringDelimiter) {\n          _this.shiftSelection(1);\n        }\n\n        _this.ignoringDelimiter = false;\n      }\n    };\n\n    _this.emitChange = function () {\n      var value = _this.iDateMediator.getInternalString();\n\n      if (_this.props.value === value) {\n        return;\n      }\n\n      if (_this.props.onValueChange) {\n        _this.props.onValueChange(value);\n      }\n\n      if (_this.blurEvent && _this.props.onBlur) {\n        _this.props.onBlur(_this.blurEvent);\n\n        _this.blurEvent = null;\n      }\n    };\n\n    _this.clearSelected = function () {\n      var selected = _this.state.selected === null ? _this.iDateMediator.getLeftmostType() : _this.state.selected;\n\n      _this.iDateMediator.clear(selected);\n\n      _this.updateValue({\n        inputMode: false,\n        selected: selected === InternalDateComponentType.All ? _this.iDateMediator.getLeftmostType() : selected\n      });\n    };\n\n    _this.clearOneChar = function () {\n      var _this$state = _this.state,\n          selected = _this$state.selected,\n          inputMode = _this$state.inputMode;\n      var nextType = selected === null ? _this.iDateMediator.getRightmostType() : selected;\n\n      if (_this.iDateMediator.isNull(nextType)) {\n        _this.shiftSelection(-1);\n\n        return;\n      }\n\n      if (selected === InternalDateComponentType.All) {\n        _this.iDateMediator.clear(InternalDateComponentType.All);\n\n        _this.updateValue({\n          selected: _this.iDateMediator.getLeftmostType()\n        });\n\n        return;\n      }\n\n      _this.iDateMediator.deleteOneCharRight(nextType, inputMode);\n\n      _this.updateValue({\n        inputMode: _this.iDateMediator.get(nextType) !== null,\n        selected: nextType\n      });\n    };\n\n    _this.shiftDateComponent = function (step) {\n      var selected = _this.state.selected;\n\n      var changed = _this.iDateMediator.shiftDateComponent(selected, step);\n\n      if (!changed) {\n        _this.blink();\n\n        return;\n      }\n\n      _this.updateValue({\n        inputMode: false,\n        selected: selected === InternalDateComponentType.All ? _this.iDateMediator.getLeftmostType() : selected\n      });\n    };\n\n    _this.shiftSelection = function (step) {\n      var selected = _this.iDateMediator.getShiftedType(_this.state.selected, step);\n\n      if (selected !== _this.state.selected) {\n        _this.setState({\n          selected: selected,\n          inputMode: false\n        });\n      }\n    };\n\n    _this.inputValue = function (event) {\n      var selected = _this.state.selected;\n\n      if (selected === InternalDateComponentType.All) {\n        selected = _this.iDateMediator.getLeftmostType();\n\n        _this.iDateMediator.clear(InternalDateComponentType.All);\n\n        _this.setState({\n          selected: selected\n        });\n      }\n\n      var inputMode = _this.iDateMediator.inputKey(event.key, selected, _this.state.inputMode);\n\n      if (!inputMode) {\n        _this.ignoringDelimiter = true;\n\n        _this.shiftSelection(1);\n      }\n\n      _this.updateValue({\n        inputMode: inputMode\n      });\n    };\n\n    _this.state = {\n      valueFormatted: '',\n      selected: null,\n      inputMode: false,\n      focused: false,\n      dragged: false\n    };\n    return _this;\n  }\n\n  var _proto = DateInput.prototype;\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n    if (prevProps.value !== this.props.value || prevProps.minDate !== this.props.minDate || prevProps.maxDate !== this.props.maxDate || this.iDateMediator.isChangedLocale(this.locale)) {\n      this.updateFromProps();\n    }\n\n    this.selectNode();\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.updateFromProps();\n  };\n\n  _proto.blur = function blur() {\n    if (this.inputLikeText) {\n      this.inputLikeText.blur();\n    }\n  };\n\n  _proto.focus = function focus() {\n    if (this.inputLikeText) {\n      this.inputLikeText.focus();\n    }\n  };\n\n  _proto.blink = function blink() {\n    if (this.inputLikeText) {\n      this.inputLikeText.blink();\n    }\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var _this$state2 = this.state,\n        focused = _this$state2.focused,\n        selected = _this$state2.selected,\n        inputMode = _this$state2.inputMode,\n        valueFormatted = _this$state2.valueFormatted;\n    var fragments = focused || valueFormatted !== '' ? this.iDateMediator.getFragments() : [];\n    return React.createElement(InputLikeText, {\n      width: this.props.width,\n      ref: this.inputLikeTextRef,\n      size: this.props.size,\n      disabled: this.props.disabled,\n      error: this.props.error,\n      warning: this.props.warning,\n      onBlur: this.handleBlur,\n      onFocus: this.handleFocus,\n      onKeyDown: this.handleKeyDown,\n      onMouseDownCapture: this.handleMouseDownCapture,\n      onPaste: this.handlePaste,\n      rightIcon: this.renderIcon(),\n      onDoubleClickCapture: this.handleDoubleClick,\n      onMouseDragStart: this.handleMouseDragStart,\n      onMouseDragEnd: this.handleMouseDragEnd,\n      value: this.iDateMediator.getInternalString()\n    }, React.createElement(DateFragmentsView, {\n      ref: this.dateFragmentsViewRef,\n      fragments: fragments,\n      onSelectDateComponent: this.handleSelectDateComponent,\n      selected: selected,\n      inputMode: inputMode\n    }));\n  };\n\n  return DateInput;\n}(React.Component), _class2.__KONTUR_REACT_UI__ = 'DateInput', _class2.defaultProps = {\n  value: '',\n  minDate: MIN_FULLDATE,\n  maxDate: MAX_FULLDATE,\n  size: 'small',\n  width: 125\n}, _temp)) || _class);","map":{"version":3,"sources":["C:/Users/ravka/Desktop/react-typescript-task/node_modules/@skbkontur/react-ui/components/DateInput/DateInput/DateInput.js"],"names":["_extends","_inheritsLoose","_dec","_class","_class2","_temp","React","cn","ConditionalHandler","LENGTH_FULLDATE","MAX_FULLDATE","MIN_FULLDATE","InternalDateComponentType","DatePickerLocaleHelper","InputLikeText","locale","ThemeContext","CalendarIcon","DateFragmentsView","jsStyles","Actions","extractAction","InternalDateMediator","DateInput","_React$Component","props","_this","call","iDateMediator","inputLikeText","dateFragmentsView","isMouseDown","isMouseFocus","ignoringDelimiter","blurEvent","theme","conditionalHandler","add","MoveSelectionLeft","shiftSelection","MoveSelectionRight","Separator","pressDelimiter","MoveSelectionFirst","selectDateComponent","getLeftmostType","MoveSelectionLast","getRightmostType","Increment","shiftDateComponent","Decrement","Digit","e","inputValue","ClearSelection","clearSelected","ClearOneChar","clearOneChar","FullSelection","fullSelection","WrongInput","blink","build","selectNode","type","state","selected","getRootNode","All","selectInnerNode","index","getTypesOrder","indexOf","renderIcon","_this$props","withIcon","size","_this$props$disabled","disabled","_cn","iconStyles","icon","iconSmall","iconMedium","iconLarge","iconDisabled","createElement","className","handleFocus","setState","prevState","focused","onFocus","handleBlur","restored","restore","updateValue","inputMode","onBlur","persist","handleMouseDownCapture","isFragment","target","preventDefault","handleSelectDateComponent","isEmpty","handleMouseDragStart","dragged","handleMouseDragEnd","selection","getSelection","toString","length","handleKeyDown","onKeyDown","handlePaste","pasted","clipboardData","getData","trim","validateString","paste","handleDoubleClick","inputLikeTextRef","el","dateFragmentsViewRef","valueFormatted","getString","emitChange","updateFromProps","update","value","get","getInternalString","onValueChange","clear","_this$state","nextType","isNull","deleteOneCharRight","step","changed","getShiftedType","event","inputKey","key","_proto","prototype","componentDidUpdate","prevProps","minDate","maxDate","isChangedLocale","componentDidMount","blur","focus","render","_this2","Consumer","renderMain","_this$state2","fragments","getFragments","width","ref","error","warning","onMouseDownCapture","onPaste","rightIcon","onDoubleClickCapture","onMouseDragStart","onMouseDragEnd","onSelectDateComponent","Component","__KONTUR_REACT_UI__","defaultProps"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _inheritsLoose from \"@babel/runtime/helpers/esm/inheritsLoose\";\n\nvar _dec, _class, _class2, _temp;\n\nimport React from 'react';\nimport cn from 'classnames';\nimport { ConditionalHandler } from \"../../../lib/ConditionalHandler\";\nimport { LENGTH_FULLDATE, MAX_FULLDATE, MIN_FULLDATE } from \"../../../lib/date/constants\";\nimport { InternalDateComponentType } from \"../../../lib/date/types\";\nimport { DatePickerLocaleHelper } from \"../../DatePicker/locale\";\nimport { InputLikeText } from \"../../../internal/InputLikeText\";\nimport { locale } from \"../../../lib/locale/decorators\";\nimport { ThemeContext } from \"../../../lib/theming/ThemeContext\";\nimport { CalendarIcon } from \"../../../internal/icons/16px\";\nimport { DateFragmentsView } from \"../DateFragmentsView\";\nimport { jsStyles } from \"../DateInput.styles\";\nimport { Actions, extractAction } from \"../helpers/DateInputKeyboardActions\";\nimport { InternalDateMediator } from \"../helpers/InternalDateMediator\";\nexport var DateInput = (_dec = locale('DatePicker', DatePickerLocaleHelper), _dec(_class = (_temp = _class2 =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(DateInput, _React$Component);\n\n  function DateInput(props) {\n    var _this;\n\n    _this = _React$Component.call(this, props) || this;\n    _this.iDateMediator = new InternalDateMediator();\n    _this.inputLikeText = null;\n    _this.dateFragmentsView = null;\n    _this.isMouseDown = false;\n    _this.isMouseFocus = false;\n    _this.ignoringDelimiter = false;\n    _this.locale = void 0;\n    _this.blurEvent = null;\n    _this.theme = void 0;\n    _this.conditionalHandler = new ConditionalHandler().add(Actions.MoveSelectionLeft, function () {\n      return _this.shiftSelection(-1);\n    }).add(Actions.MoveSelectionRight, function () {\n      return _this.shiftSelection(1);\n    }).add(Actions.Separator, function () {\n      return _this.pressDelimiter();\n    }).add(Actions.MoveSelectionFirst, function () {\n      return _this.selectDateComponent(_this.iDateMediator.getLeftmostType());\n    }).add(Actions.MoveSelectionLast, function () {\n      return _this.selectDateComponent(_this.iDateMediator.getRightmostType());\n    }).add(Actions.Increment, function () {\n      return _this.shiftDateComponent(1);\n    }).add(Actions.Decrement, function () {\n      return _this.shiftDateComponent(-1);\n    }).add(Actions.Digit, function (e) {\n      return _this.inputValue(e);\n    }).add(Actions.ClearSelection, function () {\n      return _this.clearSelected();\n    }).add(Actions.ClearOneChar, function () {\n      return _this.clearOneChar();\n    }).add(Actions.FullSelection, function () {\n      return _this.fullSelection();\n    }).add(Actions.WrongInput, function () {\n      return _this.blink();\n    }).build();\n\n    _this.selectNode = function () {\n      var type = _this.state.selected;\n\n      var dateFragmentsView = _this.dateFragmentsView && _this.dateFragmentsView.getRootNode();\n\n      if (type === null || !_this.inputLikeText || !dateFragmentsView) {\n        return;\n      }\n\n      if (type === InternalDateComponentType.All) {\n        _this.inputLikeText.selectInnerNode(dateFragmentsView, 0, 5);\n\n        return;\n      }\n\n      var index = _this.iDateMediator.getTypesOrder().indexOf(type);\n\n      if (index > -1) {\n        _this.inputLikeText.selectInnerNode(dateFragmentsView, index * 2, index * 2 + 1);\n      }\n    };\n\n    _this.renderIcon = function () {\n      var _this$props = _this.props,\n          withIcon = _this$props.withIcon,\n          size = _this$props.size,\n          _this$props$disabled = _this$props.disabled,\n          disabled = _this$props$disabled === void 0 ? false : _this$props$disabled;\n\n      if (withIcon) {\n        var _cn;\n\n        var theme = _this.theme;\n        var iconStyles = cn((_cn = {}, _cn[jsStyles.icon(theme)] = true, _cn[jsStyles.iconSmall(theme)] = size === 'small', _cn[jsStyles.iconMedium(theme)] = size === 'medium', _cn[jsStyles.iconLarge(theme)] = size === 'large', _cn[jsStyles.iconDisabled(theme)] = disabled, _cn));\n        return React.createElement(\"span\", {\n          className: iconStyles\n        }, React.createElement(CalendarIcon, null));\n      }\n\n      return null;\n    };\n\n    _this.handleFocus = function (e) {\n      _this.setState(function (prevState) {\n        return {\n          focused: true,\n          selected: _this.isMouseDown && !prevState.focused ? prevState.selected : _this.iDateMediator.getLeftmostType()\n        };\n      });\n\n      if (_this.props.onFocus) {\n        _this.props.onFocus(e);\n      }\n    };\n\n    _this.handleBlur = function (e) {\n      var restored = _this.iDateMediator.restore();\n\n      _this.updateValue({\n        focused: false,\n        selected: null,\n        inputMode: false\n      });\n\n      if (_this.props.onBlur) {\n        if (restored) {\n          e.persist();\n          _this.blurEvent = e;\n        } else {\n          _this.props.onBlur(e);\n        }\n      }\n    };\n\n    _this.handleMouseDownCapture = function (e) {\n      var isFragment = _this.dateFragmentsView ? _this.dateFragmentsView.isFragment(e.target) : false;\n\n      if (_this.state.focused && !isFragment) {\n        e.preventDefault();\n      }\n\n      _this.isMouseFocus = !_this.state.focused;\n      _this.isMouseDown = isFragment;\n    };\n\n    _this.handleSelectDateComponent = function (type) {\n      if (!(_this.isMouseFocus && _this.iDateMediator.isEmpty())) {\n        _this.selectDateComponent(type);\n      }\n\n      _this.isMouseFocus = false;\n      _this.isMouseDown = false;\n    };\n\n    _this.handleMouseDragStart = function () {\n      _this.setState({\n        dragged: true,\n        selected: null\n      });\n    };\n\n    _this.handleMouseDragEnd = function () {\n      var selection = getSelection();\n\n      if (selection && selection.toString().length === LENGTH_FULLDATE && _this.state.selected !== InternalDateComponentType.All) {\n        _this.selectDateComponent(InternalDateComponentType.All);\n      }\n    };\n\n    _this.handleKeyDown = function (e) {\n      if (_this.conditionalHandler(extractAction(e), e)) {\n        e.preventDefault();\n      }\n\n      if (_this.props.onKeyDown) {\n        _this.props.onKeyDown(e);\n      }\n    };\n\n    _this.handlePaste = function (e) {\n      var pasted = e && e.clipboardData.getData('text').trim();\n\n      if (pasted && _this.iDateMediator.validateString(pasted)) {\n        _this.iDateMediator.paste(pasted);\n\n        _this.updateValue();\n      }\n    };\n\n    _this.handleDoubleClick = function () {\n      _this.selectDateComponent(InternalDateComponentType.All);\n    };\n\n    _this.inputLikeTextRef = function (el) {\n      _this.inputLikeText = el;\n    };\n\n    _this.dateFragmentsViewRef = function (el) {\n      _this.dateFragmentsView = el;\n    };\n\n    _this.selectDateComponent = function (selected) {\n      _this.setState({\n        selected: selected,\n        inputMode: false\n      });\n    };\n\n    _this.updateValue = function (state) {\n      if (state === void 0) {\n        state = {};\n      }\n\n      var valueFormatted = _this.iDateMediator.getString();\n\n      _this.setState(_extends({}, state, {\n        valueFormatted: valueFormatted\n      }), _this.emitChange);\n    };\n\n    _this.updateFromProps = function () {\n      _this.iDateMediator.update(_this.props, _this.locale);\n\n      _this.updateValue();\n    };\n\n    _this.fullSelection = function () {\n      _this.selectDateComponent(InternalDateComponentType.All);\n    };\n\n    _this.pressDelimiter = function () {\n      var value = _this.iDateMediator.get(_this.state.selected);\n\n      if (value !== null && value !== '') {\n        if (!_this.ignoringDelimiter) {\n          _this.shiftSelection(1);\n        }\n\n        _this.ignoringDelimiter = false;\n      }\n    };\n\n    _this.emitChange = function () {\n      var value = _this.iDateMediator.getInternalString();\n\n      if (_this.props.value === value) {\n        return;\n      }\n\n      if (_this.props.onValueChange) {\n        _this.props.onValueChange(value);\n      }\n\n      if (_this.blurEvent && _this.props.onBlur) {\n        _this.props.onBlur(_this.blurEvent);\n\n        _this.blurEvent = null;\n      }\n    };\n\n    _this.clearSelected = function () {\n      var selected = _this.state.selected === null ? _this.iDateMediator.getLeftmostType() : _this.state.selected;\n\n      _this.iDateMediator.clear(selected);\n\n      _this.updateValue({\n        inputMode: false,\n        selected: selected === InternalDateComponentType.All ? _this.iDateMediator.getLeftmostType() : selected\n      });\n    };\n\n    _this.clearOneChar = function () {\n      var _this$state = _this.state,\n          selected = _this$state.selected,\n          inputMode = _this$state.inputMode;\n      var nextType = selected === null ? _this.iDateMediator.getRightmostType() : selected;\n\n      if (_this.iDateMediator.isNull(nextType)) {\n        _this.shiftSelection(-1);\n\n        return;\n      }\n\n      if (selected === InternalDateComponentType.All) {\n        _this.iDateMediator.clear(InternalDateComponentType.All);\n\n        _this.updateValue({\n          selected: _this.iDateMediator.getLeftmostType()\n        });\n\n        return;\n      }\n\n      _this.iDateMediator.deleteOneCharRight(nextType, inputMode);\n\n      _this.updateValue({\n        inputMode: _this.iDateMediator.get(nextType) !== null,\n        selected: nextType\n      });\n    };\n\n    _this.shiftDateComponent = function (step) {\n      var selected = _this.state.selected;\n\n      var changed = _this.iDateMediator.shiftDateComponent(selected, step);\n\n      if (!changed) {\n        _this.blink();\n\n        return;\n      }\n\n      _this.updateValue({\n        inputMode: false,\n        selected: selected === InternalDateComponentType.All ? _this.iDateMediator.getLeftmostType() : selected\n      });\n    };\n\n    _this.shiftSelection = function (step) {\n      var selected = _this.iDateMediator.getShiftedType(_this.state.selected, step);\n\n      if (selected !== _this.state.selected) {\n        _this.setState({\n          selected: selected,\n          inputMode: false\n        });\n      }\n    };\n\n    _this.inputValue = function (event) {\n      var selected = _this.state.selected;\n\n      if (selected === InternalDateComponentType.All) {\n        selected = _this.iDateMediator.getLeftmostType();\n\n        _this.iDateMediator.clear(InternalDateComponentType.All);\n\n        _this.setState({\n          selected: selected\n        });\n      }\n\n      var inputMode = _this.iDateMediator.inputKey(event.key, selected, _this.state.inputMode);\n\n      if (!inputMode) {\n        _this.ignoringDelimiter = true;\n\n        _this.shiftSelection(1);\n      }\n\n      _this.updateValue({\n        inputMode: inputMode\n      });\n    };\n\n    _this.state = {\n      valueFormatted: '',\n      selected: null,\n      inputMode: false,\n      focused: false,\n      dragged: false\n    };\n    return _this;\n  }\n\n  var _proto = DateInput.prototype;\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n    if (prevProps.value !== this.props.value || prevProps.minDate !== this.props.minDate || prevProps.maxDate !== this.props.maxDate || this.iDateMediator.isChangedLocale(this.locale)) {\n      this.updateFromProps();\n    }\n\n    this.selectNode();\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.updateFromProps();\n  };\n\n  _proto.blur = function blur() {\n    if (this.inputLikeText) {\n      this.inputLikeText.blur();\n    }\n  };\n\n  _proto.focus = function focus() {\n    if (this.inputLikeText) {\n      this.inputLikeText.focus();\n    }\n  };\n\n  _proto.blink = function blink() {\n    if (this.inputLikeText) {\n      this.inputLikeText.blink();\n    }\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    return React.createElement(ThemeContext.Consumer, null, function (theme) {\n      _this2.theme = theme;\n      return _this2.renderMain();\n    });\n  };\n\n  _proto.renderMain = function renderMain() {\n    var _this$state2 = this.state,\n        focused = _this$state2.focused,\n        selected = _this$state2.selected,\n        inputMode = _this$state2.inputMode,\n        valueFormatted = _this$state2.valueFormatted;\n    var fragments = focused || valueFormatted !== '' ? this.iDateMediator.getFragments() : [];\n    return React.createElement(InputLikeText, {\n      width: this.props.width,\n      ref: this.inputLikeTextRef,\n      size: this.props.size,\n      disabled: this.props.disabled,\n      error: this.props.error,\n      warning: this.props.warning,\n      onBlur: this.handleBlur,\n      onFocus: this.handleFocus,\n      onKeyDown: this.handleKeyDown,\n      onMouseDownCapture: this.handleMouseDownCapture,\n      onPaste: this.handlePaste,\n      rightIcon: this.renderIcon(),\n      onDoubleClickCapture: this.handleDoubleClick,\n      onMouseDragStart: this.handleMouseDragStart,\n      onMouseDragEnd: this.handleMouseDragEnd,\n      value: this.iDateMediator.getInternalString()\n    }, React.createElement(DateFragmentsView, {\n      ref: this.dateFragmentsViewRef,\n      fragments: fragments,\n      onSelectDateComponent: this.handleSelectDateComponent,\n      selected: selected,\n      inputMode: inputMode\n    }));\n  };\n\n  return DateInput;\n}(React.Component), _class2.__KONTUR_REACT_UI__ = 'DateInput', _class2.defaultProps = {\n  value: '',\n  minDate: MIN_FULLDATE,\n  maxDate: MAX_FULLDATE,\n  size: 'small',\n  width: 125\n}, _temp)) || _class);"]},"metadata":{},"sourceType":"module"}