{"version":3,"sources":["ColorFactory.ts"],"names":["warning","clamp","extractColorParts","hue2rgb","parseHSLParts","parseRGBParts","ColorKeywords","ColorObject","RGB_REGEX","RGBA_REGEX","HSL_REGEX","HSLA_REGEX","HEX_REGEX","ColorFactory","create","input","cache","instantiate","toLowerCase","trim","isKeyword","fromKeyword","startsWith","parts","r","g","b","a","fromRGB","h","s","l","fromHSL","fromHex","Object","prototype","hasOwnProperty","call","keyword","hexString","type","test","Error","colorCode","substring","rgb","length","match","forEach","c","i","parseInt","split","gray","Math","round","hDeg","t1","t2"],"mappings":"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","sourcesContent":["import warning from 'warning';\r\n\r\nimport { clamp, extractColorParts, hue2rgb, parseHSLParts, parseRGBParts } from './ColorHelpers';\r\nimport { ColorKeywords } from './ColorKeywords';\r\nimport { ColorKeywordsType, ColorObject, ColorType, RGBTuple } from './ColorObject';\r\n\r\ninterface ColorFactoryCacheType {\r\n  [key: string]: ColorObject;\r\n}\r\n\r\nconst RGB_REGEX = /rgb\\(\\s*(\\d{1,3}(?:(?:\\.\\d+)?%)?)\\s*,\\s*(\\d{1,3}(?:(?:\\.\\d+)?%)?)\\s*,\\s*(\\d{1,3}(?:(?:\\.\\d+)?%)?)\\s*\\)/;\r\nconst RGBA_REGEX = /rgba\\(\\s*(\\d{1,3}(?:(?:\\.\\d+)?%)?)\\s*,\\s*(\\d{1,3}(?:(?:\\.\\d+)?%)?)\\s*,\\s*(\\d{1,3}(?:(?:\\.\\d+)?%)?)\\s*,\\s*(0|0\\.\\d+|1|1\\.0+|\\d{1,3}(?:(?:\\.\\d+)?%))\\s*\\)/;\r\nconst HSL_REGEX = /hsl\\(\\s*(\\d{1,3})\\s*,\\s*(0|0\\.\\d+|1|1\\.0+|\\d{1,3}(?:(?:\\.\\d+)?%))\\s*,\\s*(0|0\\.\\d+|1|1\\.0+|\\d{1,3}(?:(?:\\.\\d+)?%))\\s*\\)/;\r\nconst HSLA_REGEX = /hsla\\(\\s*(\\d{1,3})\\s*,\\s*(0|0\\.\\d+|1|1\\.0+|\\d{1,3}(?:(?:\\.\\d+)?%))\\s*,\\s*(0|0\\.\\d+|1|1\\.0+|\\d{1,3}(?:(?:\\.\\d+)?%))\\s*,\\s*(0|0\\.\\d+|1|1\\.0+|\\d{1,3}(?:(?:\\.\\d+)?%))\\s*\\)/;\r\nconst HEX_REGEX = /^#([0-9a-f]{3}|[0-9a-f]{6})$/;\r\n\r\nexport class ColorFactory {\r\n  public static create(input: string) {\r\n    if (!this.cache[input]) {\r\n      this.cache[input] = this.instantiate(input);\r\n    }\r\n\r\n    return this.cache[input];\r\n  }\r\n\r\n  private static cache: ColorFactoryCacheType = Object.create(null);\r\n\r\n  private static instantiate(input: string) {\r\n    if (typeof input !== 'string') {\r\n      warning(false, `Invalid type of input (${typeof input}), expected a string. Returning transparent color`);\r\n      return new ColorObject([0, 0, 0], 1.0, 'transparent');\r\n    }\r\n    input = input.toLowerCase().trim();\r\n\r\n    if (input === 'transparent') {\r\n      return new ColorObject([0, 0, 0], 0, 'transparent');\r\n    } else if (this.isKeyword(input)) {\r\n      return this.fromKeyword(input);\r\n    } else if (input.startsWith('rgb')) {\r\n      const parts = extractColorParts(input, RGB_REGEX, RGBA_REGEX);\r\n      let { r, g, b, a } = parseRGBParts(parts);\r\n\r\n      r = clamp(r, 255);\r\n      g = clamp(g, 255);\r\n      b = clamp(b, 255);\r\n      a = clamp(a, 1);\r\n\r\n      return this.fromRGB(r, g, b, a);\r\n    } else if (input.startsWith('hsl')) {\r\n      const parts = extractColorParts(input, HSL_REGEX, HSLA_REGEX);\r\n      let { h, s, l, a } = parseHSLParts(parts);\r\n\r\n      h = clamp(h, 360);\r\n      s = clamp(s, 1);\r\n      l = clamp(l, 1);\r\n      a = clamp(a, 1);\r\n\r\n      return this.fromHSL(h, s, l, a);\r\n    }\r\n\r\n    return this.fromHex(input);\r\n  }\r\n\r\n  private static isKeyword(input: string): input is ColorKeywordsType {\r\n    return Object.prototype.hasOwnProperty.call(ColorKeywords, input);\r\n  }\r\n\r\n  private static fromKeyword(keyword: ColorKeywordsType) {\r\n    return this.fromHex(ColorKeywords[keyword], keyword);\r\n  }\r\n\r\n  private static fromHex(hexString: string, type: ColorType = 'hex') {\r\n    if (!HEX_REGEX.test(hexString)) {\r\n      throw new Error(`${hexString} is not a valid hex color string`);\r\n    }\r\n\r\n    const colorCode = hexString.substring(1);\r\n    const rgb: RGBTuple = [0, 0, 0];\r\n    if (colorCode.length === 6) {\r\n      colorCode.match(/.{2}/g)!.forEach((c, i) => {\r\n        rgb[i] = parseInt(c, 16);\r\n      });\r\n    } else if (colorCode.length === 3) {\r\n      colorCode.split('').forEach((c, i) => {\r\n        rgb[i] = parseInt(c + c, 16);\r\n      });\r\n    }\r\n    return new ColorObject(rgb, 1.0, type);\r\n  }\r\n\r\n  private static fromRGB(r: number, g: number, b: number, a = 1.0) {\r\n    return new ColorObject([r, g, b], a, a < 1 ? 'rgba' : 'rgb');\r\n  }\r\n\r\n  private static fromHSL(h: number, s: number, l: number, a = 1.0) {\r\n    if (s === 0) {\r\n      const gray = Math.round(l * 255);\r\n      return new ColorObject([gray, gray, gray], a, a < 1 ? 'hsla' : 'hsl');\r\n    }\r\n\r\n    const hDeg = h / 360;\r\n    const t1 = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n    const t2 = l * 2 - t1;\r\n\r\n    const r = hue2rgb(hDeg + 1 / 3, t1, t2);\r\n    const g = hue2rgb(hDeg, t1, t2);\r\n    const b = hue2rgb(hDeg - 1 / 3, t1, t2);\r\n\r\n    const rgb: RGBTuple = [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\r\n    return new ColorObject(rgb, a, a < 1 ? 'hsla' : 'hsl');\r\n  }\r\n}\r\n"]}