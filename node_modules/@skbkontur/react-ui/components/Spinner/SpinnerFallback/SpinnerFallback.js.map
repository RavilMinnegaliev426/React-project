{"version":3,"sources":["SpinnerFallback.tsx"],"names":["React","PropTypes","fallbackImage_mini","fallbackImage_mini_dimmed","fallbackImage_big","fallbackImage_normal","jsStyles","types","big","mini","normal","SpinnerFallback","state","frame","mounted","_framesCount","dimmed","imageUrls","animate","framesCount","getSpriteSettingsKey","nextFrame","setState","setTimeout","props","type","componentDidMount","componentWillUnmount","render","renderCircle","size","backgroundImage","cssSet","height","width","marginBottom","marginLeft","marginRight","process","env","enableReactTesting","backgroundPosition","fallback","Component","__KONTUR_REACT_UI__","propTypes","oneOf","Object","keys","bool"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport fallbackImage_mini from './fallback_circle_mini.png';\r\nimport fallbackImage_mini_dimmed from './fallback_circle_dimmed.png';\r\nimport fallbackImage_big from './fallback_circle_big.png';\r\nimport fallbackImage_normal from './fallback_circle_normal.png';\r\nimport { jsStyles } from './Spinner.styles';\r\nimport { SpinnerType } from './Spinner';\r\n\r\nexport const types: {\r\n  [key: string]: SpinnerType;\r\n} = {\r\n  big: 'big',\r\n  mini: 'mini',\r\n  normal: 'normal',\r\n};\r\n\r\nexport interface SpinnerFallbackProps {\r\n  type: SpinnerType;\r\n  dimmed?: boolean;\r\n}\r\n\r\nexport class SpinnerFallback extends React.Component<SpinnerFallbackProps> {\r\n  public static __KONTUR_REACT_UI__ = 'SpinnerFallback';\r\n\r\n  public static propTypes = {\r\n    type: PropTypes.oneOf(Object.keys(types)),\r\n\r\n    dimmed: PropTypes.bool,\r\n  };\r\n\r\n  public state = {\r\n    frame: 0,\r\n  };\r\n\r\n  private mounted = false;\r\n\r\n  // quantity of frames in images\r\n  private _framesCount = {\r\n    [types.mini]: 151,\r\n    [types.normal]: 151,\r\n    [types.big]: 151,\r\n    dimmed: 60,\r\n  };\r\n\r\n  private imageUrls = {\r\n    [types.mini]: fallbackImage_mini,\r\n    [types.normal]: fallbackImage_normal,\r\n    [types.big]: fallbackImage_big,\r\n    dimmed: fallbackImage_mini_dimmed,\r\n  };\r\n\r\n  public componentDidMount() {\r\n    this.mounted = true;\r\n    this.animate();\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this.mounted = false;\r\n  }\r\n\r\n  public render() {\r\n    return this.renderCircle();\r\n  }\r\n\r\n  private renderCircle() {\r\n    const { dimmed } = this.props;\r\n    const { type } = this.props;\r\n    const { frame } = this.state;\r\n    const size = type === 'big' ? 96 : type === 'normal' ? 48 : 16;\r\n    const backgroundImage = dimmed ? this.imageUrls.dimmed : this.imageUrls[type];\r\n\r\n    const cssSet: React.CSSProperties = {\r\n      backgroundImage: `url('${backgroundImage}')`,\r\n      height: size,\r\n      width: size,\r\n      marginBottom: -3,\r\n      marginLeft: -1,\r\n      marginRight: -1,\r\n    };\r\n\r\n    if (!process.env.enableReactTesting) {\r\n      cssSet.backgroundPosition = `0 -${frame * size}px`;\r\n    }\r\n\r\n    return <span className={jsStyles.fallback()} style={cssSet} />;\r\n  }\r\n\r\n  private animate = () => {\r\n    if (!this.mounted) {\r\n      return;\r\n    }\r\n\r\n    const { frame } = this.state;\r\n    const framesCount = this._framesCount[this.getSpriteSettingsKey()];\r\n    const nextFrame = frame < framesCount ? frame + 1 : 0;\r\n    this.setState({ frame: nextFrame });\r\n\r\n    setTimeout(this.animate, 1000 / 25);\r\n  };\r\n\r\n  private getSpriteSettingsKey = () =>\r\n    this.props.type === types.mini && this.props.dimmed ? 'dimmed' : this.props.type;\r\n}\r\n"]}