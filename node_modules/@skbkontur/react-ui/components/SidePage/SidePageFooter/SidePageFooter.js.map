{"version":3,"sources":["SidePageFooter.tsx"],"names":["React","cn","LayoutEvents","ThemeContext","jsStyles","SidePageContext","SidePageFooter","context","state","fixed","theme","content","wrapper","layoutSub","update","setProperStyles","refContent","node","refWrapper","wrapperRect","getBoundingClientRect","contentRect","top","setState","componentDidMount","footerRef","addListener","componentWillUnmount","remove","render","renderMain","height","getContentHeight","getWidth","footer","width","footerContent","panel","props","footerFixed","children","Component","__KONTUR_REACT_UI__","contextType"],"mappings":"sEAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,EAAP,MAAe,YAAf;;AAEA,OAAO,KAAKC,YAAZ,MAA8B,wBAA9B;AACA,SAASC,YAAT,QAA6B,gCAA7B;;;AAGA,SAASC,QAAT,QAAyB,mBAAzB;AACA,SAASC,eAAT,QAAqD,mBAArD;;;;;;;;;;AAUA;;;;;;AAMA,WAAaC,cAAb;;;;AAISC,IAAAA,OAJT,GAIwC,MAAKA,OAJ7C;;AAMSC,IAAAA,KANT,GAMiB;AACbC,MAAAA,KAAK,EAAE,KADM,EANjB;;;AAUUC,IAAAA,KAVV;AAWUC,IAAAA,OAXV,GAWwC,IAXxC;AAYUC,IAAAA,OAZV,GAYwC,IAZxC;AAaUC,IAAAA,SAbV,GAa0E,IAb1E;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCSC,IAAAA,MAvCT,GAuCkB,YAAM;AACpB,YAAKC,eAAL;AACD,KAzCH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEUC,IAAAA,UAtEV,GAsEuB,UAACC,IAAD,EAA8B;AACjD,YAAKN,OAAL,GAAeM,IAAf;AACD,KAxEH;;AA0EUC,IAAAA,UA1EV,GA0EuB,UAACD,IAAD,EAA8B;AACjD,YAAKL,OAAL,GAAeK,IAAf;AACD,KA5EH;;AA8EUF,IAAAA,eA9EV,GA8E4B,YAAM;AAC9B,UAAI,MAAKH,OAAL,IAAgB,MAAKD,OAAzB,EAAkC;AAChC,YAAMQ,WAAW,GAAG,MAAKP,OAAL,CAAaQ,qBAAb,EAApB;AACA,YAAMC,WAAW,GAAG,MAAKV,OAAL,CAAaS,qBAAb,EAApB;AACA,YAAMX,MAAK,GAAGU,WAAW,CAACG,GAAZ,GAAkBD,WAAW,CAACC,GAA5C;AACA,cAAKC,QAAL,CAAc,EAAEd,KAAK,EAALA,MAAF,EAAd;AACD;AACF,KArFH,4DAeSe,iBAfT,GAeE,6BAA2B,CACzB,KAAKjB,OAAL,CAAakB,SAAb,CAAuB,IAAvB,EACA,KAAKX,MAAL,GACA,KAAKD,SAAL,GAAiBX,YAAY,CAACwB,WAAb,CAAyB,KAAKZ,MAA9B,CAAjB,CACD,CAnBH,QAqBSa,oBArBT,GAqBE,gCAA8B,CAC5B,KAAKpB,OAAL,CAAakB,SAAb,CAAuB,IAAvB,EACA,IAAI,KAAKZ,SAAT,EAAoB,CAClB,KAAKA,SAAL,CAAee,MAAf,GACD,CACF,CA1BH,QA4BSC,MA5BT,GA4BE,kBAA6B,mBAC3B,OACE,oBAAC,YAAD,CAAc,QAAd,QACG,UAAAnB,KAAK,EAAI,CACR,MAAI,CAACA,KAAL,GAAaA,KAAb,CACA,OAAO,MAAI,CAACoB,UAAL,EAAP,CACD,CAJH,CADF,CAQD,CArCH,QA2CUA,UA3CV,GA2CE,sBAAqB,mBACnB,OACE,6BAAK,KAAK,EAAE,EAAEC,MAAM,EAAE,KAAKC,gBAAL,EAAV,EAAZ,EAAiD,GAAG,EAAE,KAAKd,UAA3D,IACE,oBAAC,eAAD,CAAiB,QAAjB,QACG,6BAAGe,QAAH,QAAGA,QAAH,QACC,6BACE,SAAS,EAAE7B,QAAQ,CAAC8B,MAAT,EADb,EAEE,KAAK,EAAE,EACLC,KAAK,EAAEF,QAAQ,EADV,EAFT,IAME,6BACE,SAAS,EAAEhC,EAAE,CAACG,QAAQ,CAACgC,aAAT,EAAD,iBACVhC,QAAQ,CAACiC,KAAT,CAAe,MAAI,CAAC3B,KAApB,CADU,IACmB,CAAC,CAAC,MAAI,CAAC4B,KAAL,CAAWD,KADhC,MAEVjC,QAAQ,CAACmC,WAAT,CAAqB,MAAI,CAAC7B,KAA1B,CAFU,IAEyB,MAAI,CAACF,KAAL,CAAWC,KAFpC,OADf,EAKE,GAAG,EAAE,MAAI,CAACO,UALZ,IAOG,MAAI,CAACsB,KAAL,CAAWE,QAPd,CANF,CADD,EADH,CADF,CADF,CAwBD,CApEH;;AAuFUR,EAAAA,gBAvFV,GAuFE,4BAA2B;AACzB,QAAI,CAAC,KAAKrB,OAAV,EAAmB;AACjB,aAAO,MAAP;AACD;AACD,WAAO,KAAKA,OAAL,CAAaS,qBAAb,GAAqCW,MAA5C;AACD,GA5FH,yBAAoC/B,KAAK,CAACyC,SAA1C,EAAanC,c,CACGoC,mB,GAAsB,gB,CADzBpC,c,CAGGqC,W,GAActC,e","sourcesContent":["import React from 'react';\r\nimport cn from 'classnames';\r\n\r\nimport * as LayoutEvents from '../../lib/LayoutEvents';\r\nimport { ThemeContext } from '../../lib/theming/ThemeContext';\r\nimport { Theme } from '../../lib/theming/Theme';\r\n\r\nimport { jsStyles } from './SidePage.styles';\r\nimport { SidePageContext, SidePageContextType } from './SidePageContext';\r\n\r\nexport interface SidePageFooterProps {\r\n  children?: React.ReactNode | ((fixed: boolean) => React.ReactNode);\r\n  /**\r\n   * Включает серый цвет в футере\r\n   */\r\n  panel?: boolean;\r\n}\r\n\r\n/**\r\n * Футер сайдпейджа.\r\n *\r\n * @visibleName SidePage.Footer\r\n */\r\n\r\nexport class SidePageFooter extends React.Component<SidePageFooterProps> {\r\n  public static __KONTUR_REACT_UI__ = 'SidePageFooter';\r\n\r\n  public static contextType = SidePageContext;\r\n  public context: SidePageContextType = this.context;\r\n\r\n  public state = {\r\n    fixed: false,\r\n  };\r\n\r\n  private theme!: Theme;\r\n  private content: HTMLElement | null = null;\r\n  private wrapper: HTMLElement | null = null;\r\n  private layoutSub: ReturnType<typeof LayoutEvents.addListener> | null = null;\r\n\r\n  public componentDidMount() {\r\n    this.context.footerRef(this);\r\n    this.update();\r\n    this.layoutSub = LayoutEvents.addListener(this.update);\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this.context.footerRef(null);\r\n    if (this.layoutSub) {\r\n      this.layoutSub.remove();\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    return (\r\n      <ThemeContext.Consumer>\r\n        {theme => {\r\n          this.theme = theme;\r\n          return this.renderMain();\r\n        }}\r\n      </ThemeContext.Consumer>\r\n    );\r\n  }\r\n\r\n  public update = () => {\r\n    this.setProperStyles();\r\n  };\r\n\r\n  private renderMain() {\r\n    return (\r\n      <div style={{ height: this.getContentHeight() }} ref={this.refWrapper}>\r\n        <SidePageContext.Consumer>\r\n          {({ getWidth }) => (\r\n            <div\r\n              className={jsStyles.footer()}\r\n              style={{\r\n                width: getWidth(),\r\n              }}\r\n            >\r\n              <div\r\n                className={cn(jsStyles.footerContent(), {\r\n                  [jsStyles.panel(this.theme)]: !!this.props.panel,\r\n                  [jsStyles.footerFixed(this.theme)]: this.state.fixed,\r\n                })}\r\n                ref={this.refContent}\r\n              >\r\n                {this.props.children}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </SidePageContext.Consumer>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private refContent = (node: HTMLElement | null) => {\r\n    this.content = node;\r\n  };\r\n\r\n  private refWrapper = (node: HTMLElement | null) => {\r\n    this.wrapper = node;\r\n  };\r\n\r\n  private setProperStyles = () => {\r\n    if (this.wrapper && this.content) {\r\n      const wrapperRect = this.wrapper.getBoundingClientRect();\r\n      const contentRect = this.content.getBoundingClientRect();\r\n      const fixed = wrapperRect.top > contentRect.top;\r\n      this.setState({ fixed });\r\n    }\r\n  };\r\n\r\n  private getContentHeight() {\r\n    if (!this.content) {\r\n      return 'auto';\r\n    }\r\n    return this.content.getBoundingClientRect().height;\r\n  }\r\n}\r\n"]}