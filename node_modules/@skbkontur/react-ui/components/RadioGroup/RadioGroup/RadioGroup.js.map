{"version":3,"sources":["RadioGroup.tsx"],"names":["React","PropTypes","invariant","cn","getRandomID","Radio","createPropsGetter","FocusTrap","jsStyles","Prevent","RadioGroup","props","node","name","getProps","defaultProps","getValue","isControlled","value","state","activeItem","getName","handleSelect","setState","onValueChange","renderRadio","itemValue","data","index","itemProps","key","className","item","itemFirst","itemInline","inline","renderItem","ref","element","defaultValue","getChildContext","onSelect","disabled","error","warning","render","width","onMouseLeave","onMouseOver","onMouseEnter","onBlur","style","handlers","root","renderChildren","focus","radio","querySelector","items","children","mapItems","Component","__KONTUR_REACT_UI__","childContextTypes","bool","string","any","func","propTypes","oneOfType","number","_value","fn","result","entry","normalizeEntry","push","Array","isArray"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport invariant from 'invariant';\r\nimport cn from 'classnames';\r\n\r\nimport { getRandomID } from '../../lib/utils';\r\nimport { Radio } from '../Radio';\r\nimport { createPropsGetter } from '../../lib/createPropsGetter';\r\nimport { Nullable } from '../../typings/utility-types';\r\nimport { FocusTrap } from '../../internal/FocusTrap';\r\n\r\nimport { jsStyles } from './RadioGroup.styles';\r\nimport { Prevent } from './Prevent';\r\n\r\nexport interface RadioGroupProps<T = string | number> {\r\n  defaultValue?: T;\r\n  value?: T;\r\n  items?: T[] | [T, React.ReactNode][];\r\n  name?: string;\r\n  disabled?: boolean;\r\n  warning?: boolean;\r\n  error?: boolean;\r\n  inline?: boolean;\r\n  width?: React.CSSProperties['width'];\r\n  renderItem?: (itemValue: T, data: React.ReactNode) => React.ReactNode;\r\n  /** Вызывается при изменении `value` */\r\n  onValueChange?: (value: T) => void;\r\n  onBlur?: (event: FocusEvent) => void;\r\n  onMouseLeave?: () => any;\r\n  onMouseOver?: () => any;\r\n  onMouseEnter?: () => any;\r\n}\r\n\r\nexport interface RadioGroupState<T> {\r\n  activeItem?: T;\r\n}\r\n\r\nexport class RadioGroup<T> extends React.Component<RadioGroupProps<T>, RadioGroupState<T>> {\r\n  public static __KONTUR_REACT_UI__ = 'RadioGroup';\r\n\r\n  public static childContextTypes = {\r\n    error: PropTypes.bool,\r\n    name: PropTypes.string,\r\n    warning: PropTypes.bool,\r\n    disabled: PropTypes.bool,\r\n    activeItem: PropTypes.any,\r\n    onSelect: PropTypes.func,\r\n  };\r\n\r\n  public static propTypes = {\r\n    /**\r\n     * Может быть использовано, если не передан параметр `items`\r\n     *\r\n     * `children` может содержать любую разметку с компонентами Radio.\r\n     * Каждому компоненту Radio нужно указать параметр `value`, такого же типа\r\n     * как и параметр `value` самой радиогруппы.\r\n     *\r\n     * Значения активного элемента сравниваются по строгому равенству `===`\r\n     */\r\n    children: PropTypes.node,\r\n\r\n    /**\r\n     * Значение по умолчанию. Должно быть одним из значений дочерних радиокнопок\r\n     * или значей из параметра `items`\r\n     */\r\n    defaultValue: PropTypes.any,\r\n\r\n    /**\r\n     * Дизейблит все радиокнопки\r\n     */\r\n    disabled: PropTypes.bool,\r\n\r\n    /**\r\n     * Переводит все радиокнопки в состоянии ошибки\r\n     */\r\n    error: PropTypes.bool,\r\n\r\n    /**\r\n     * Выравнивает элементы в строку. Не работает с `children`\r\n     */\r\n    inline: PropTypes.bool,\r\n\r\n    /**\r\n     * Может быть использовано, если не передан параметр `children`\r\n     *\r\n     * Массив параметров радиокнопок. Может быть типа `Array<Value>` или\r\n     * `Array<[Value, Data]>`, где тип `Value` — значение радиокнопки, а `Data`\r\n     * — значение которое будет использовано вторым параметром в `renderItem`.\r\n     * Если тип `items: Array<Value>`, то он будет приведен к типу\r\n     * `Array<[Value, Value]>`\r\n     */\r\n    items: PropTypes.any,\r\n\r\n    /**\r\n     * Аттрибут name для вложенных радиокнопок. Если не указан, то сгенерируется\r\n     * случайное имя по алгоритму\r\n     * [uuid v1](https://github.com/kelektiv/node-uuid#version-1)\r\n     */\r\n    name: PropTypes.string,\r\n\r\n    /**\r\n     * Метод отрисовки контента радиокнопки. Не работает с `children`.\r\n     *\r\n     * Принимает два аргумента: `(value: Value, data: Data) => React.Node`\r\n     */\r\n    renderItem: PropTypes.func,\r\n\r\n    /**\r\n     * Значение радиогруппы. Должно быть одним из значений радиокнопок.\r\n     * Если не указано, то компонент будет работать, как неконтроллируемый\r\n     */\r\n    value: PropTypes.any,\r\n\r\n    /**\r\n     * Переводит все радиокнопки в состоянии предупреждения\r\n     */\r\n    warning: PropTypes.bool,\r\n\r\n    /**\r\n     * Ширина радиогруппы. Не работает с `children`\r\n     */\r\n    width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n\r\n    /**\r\n     * Обработчик события при переключении радиокнопок.\r\n     * Имеет тип\r\n     * `(value: Value) => any`\r\n     */\r\n    onValueChange: PropTypes.func,\r\n\r\n    onBlur: PropTypes.func,\r\n\r\n    onMouseEnter: PropTypes.func,\r\n\r\n    onMouseLeave: PropTypes.func,\r\n\r\n    onMouseOver: PropTypes.func,\r\n  };\r\n\r\n  public static defaultProps = {\r\n    renderItem,\r\n  };\r\n\r\n  public static Prevent = Prevent;\r\n\r\n  private node: Nullable<HTMLSpanElement>;\r\n  private name = getRandomID();\r\n  private getProps = createPropsGetter(RadioGroup.defaultProps);\r\n\r\n  constructor(props: RadioGroupProps<T>) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      activeItem: this.props.defaultValue,\r\n    };\r\n  }\r\n\r\n  public getChildContext() {\r\n    return {\r\n      activeItem: this.getValue(),\r\n      onSelect: this.handleSelect,\r\n      name: this.getName(),\r\n      disabled: this.props.disabled,\r\n      error: this.props.error,\r\n      warning: this.props.warning,\r\n    };\r\n  }\r\n\r\n  public render() {\r\n    const { width, onMouseLeave, onMouseOver, onMouseEnter, onBlur } = this.props;\r\n    const style = {\r\n      width: width != null ? width : 'auto',\r\n    };\r\n    const handlers = {\r\n      onMouseOver,\r\n      onMouseEnter,\r\n      onMouseLeave,\r\n    };\r\n\r\n    return (\r\n      <FocusTrap onBlur={onBlur}>\r\n        <span ref={this.ref} style={style} className={jsStyles.root()} {...handlers}>\r\n          {this.renderChildren()}\r\n        </span>\r\n      </FocusTrap>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public focus() {\r\n    const node = this.node;\r\n    if (!node) {\r\n      return;\r\n    }\r\n\r\n    let radio = node.querySelector('input[type=\"radio\"]:checked') as Nullable<HTMLInputElement>;\r\n\r\n    // If no checked radios, try get first radio\r\n    if (!radio || radio.disabled) {\r\n      radio = node.querySelector('input[type=\"radio\"]:not([disabled])') as Nullable<HTMLInputElement>;\r\n    }\r\n\r\n    if (radio) {\r\n      radio.focus();\r\n    }\r\n  }\r\n\r\n  private getValue = () => (this.isControlled() ? this.props.value : this.state.activeItem);\r\n\r\n  private getName = () => this.props.name || this.name;\r\n\r\n  private isControlled = () => this.props.value != null;\r\n\r\n  private handleSelect = (value: T) => {\r\n    if (!this.isControlled()) {\r\n      this.setState({ activeItem: value });\r\n    }\r\n    if (this.props.onValueChange) {\r\n      this.props.onValueChange(value);\r\n    }\r\n  };\r\n\r\n  private renderChildren() {\r\n    const { items, children } = this.props;\r\n    invariant((!items && children) || (items && !children), 'Either items or children must be passed, not both');\r\n    return items ? mapItems<T>(this.renderRadio, items) : children;\r\n  }\r\n\r\n  private renderRadio = (itemValue: T, data: React.ReactNode, index: number): JSX.Element => {\r\n    const itemProps = {\r\n      key: typeof itemValue === 'string' || typeof itemValue === 'number' ? itemValue : index,\r\n      className: cn({\r\n        [jsStyles.item()]: true,\r\n        [jsStyles.itemFirst()]: index === 0,\r\n        [jsStyles.itemInline()]: !!this.props.inline,\r\n      }),\r\n    };\r\n\r\n    return (\r\n      <span {...itemProps}>\r\n        <Radio value={itemValue}>{this.getProps().renderItem<T>(itemValue, data)}</Radio>\r\n      </span>\r\n    );\r\n  };\r\n\r\n  private ref = (element: HTMLSpanElement) => {\r\n    this.node = element;\r\n  };\r\n}\r\n\r\nfunction renderItem<T>(_value: T, data: React.ReactNode) {\r\n  return data;\r\n}\r\n\r\nfunction mapItems<T>(\r\n  fn: (value: T, data: React.ReactNode, index: number) => React.ReactNode,\r\n  items: T[] | [T, React.ReactNode][],\r\n) {\r\n  const result: React.ReactNode[] = [];\r\n  let index = 0;\r\n  for (const entry of items) {\r\n    const [value, data] = normalizeEntry<T>(entry);\r\n    result.push(fn(value, data, index));\r\n    ++index;\r\n  }\r\n  return result;\r\n}\r\n\r\nfunction normalizeEntry<T>(entry: T | [T, React.ReactNode]): [T, React.ReactNode] {\r\n  if (!Array.isArray(entry)) {\r\n    return [entry, entry];\r\n  }\r\n  return entry;\r\n}\r\n"]}