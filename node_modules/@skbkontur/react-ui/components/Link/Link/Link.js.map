{"version":3,"sources":["Link.tsx"],"names":["React","PropTypes","cn","createPropsGetter","tabListener","ThemeContext","isExternalLink","jsStyles","Link","state","focusedByTab","theme","getProps","defaultProps","_handleFocus","event","props","disabled","process","nextTick","isTabPressed","setState","_handleBlur","_handleClick","href","onClick","preventDefault","render","renderMain","icon","use","_button","_buttonOpened","className","style","relOrigin","rel","rest","iconElement","arrow","root","button","buttonOpened","focus","useDefault","useSuccess","useDanger","useGrayed","onFocus","onBlur","tabIndex","children","Component","__KONTUR_REACT_UI__","propTypes","bool","string","oneOfType","node","oneOf"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport cn from 'classnames';\r\n\r\nimport { createPropsGetter } from '../../lib/createPropsGetter';\r\nimport { Override } from '../../typings/utility-types';\r\nimport { tabListener } from '../../lib/events/tabListener';\r\nimport { Theme } from '../../lib/theming/Theme';\r\nimport { ThemeContext } from '../../lib/theming/ThemeContext';\r\nimport { isExternalLink } from '../../lib/utils';\r\n\r\nimport { jsStyles } from './Link.styles';\r\n\r\nexport type LinkProps = Override<\r\n  React.AnchorHTMLAttributes<HTMLAnchorElement>,\r\n  {\r\n    /** Неактивное состояние */\r\n    disabled?: boolean;\r\n    /** href */\r\n    href?: string;\r\n    /** Иконка */\r\n    icon?: React.ReactElement<any>;\r\n    /** Тип */\r\n    use?: 'default' | 'success' | 'danger' | 'grayed';\r\n    _button?: boolean;\r\n    _buttonOpened?: boolean;\r\n    tabIndex?: number;\r\n    /** onClick */\r\n    onClick?: (event?: React.MouseEvent<HTMLAnchorElement>) => void;\r\n  }\r\n>;\r\n\r\nexport interface LinkState {\r\n  focusedByTab: boolean;\r\n}\r\n\r\n/**\r\n * Стандартная ссылка.\r\n * Интерфес пропсов наследуется от `React.AnchorHTMLAttributes<HTMLAnchorElement>`.\r\n * Все свойства передаются в элемент `<a>`.\r\n * `className` и `style` не поддерживаются\r\n */\r\nexport class Link extends React.Component<LinkProps, LinkState> {\r\n  public static __KONTUR_REACT_UI__ = 'Link';\r\n\r\n  public static propTypes = {\r\n    disabled: PropTypes.bool,\r\n\r\n    href: PropTypes.string,\r\n\r\n    icon: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\r\n\r\n    use: PropTypes.oneOf(['default', 'success', 'danger', 'grayed']),\r\n  };\r\n\r\n  public static defaultProps = {\r\n    href: '',\r\n    use: 'default',\r\n  };\r\n\r\n  public state = {\r\n    focusedByTab: false,\r\n  };\r\n\r\n  private theme!: Theme;\r\n  private getProps = createPropsGetter(Link.defaultProps);\r\n\r\n  public render(): JSX.Element {\r\n    return (\r\n      <ThemeContext.Consumer>\r\n        {theme => {\r\n          this.theme = theme;\r\n          return this.renderMain();\r\n        }}\r\n      </ThemeContext.Consumer>\r\n    );\r\n  }\r\n\r\n  private renderMain() {\r\n    const {\r\n      disabled,\r\n      href,\r\n      icon,\r\n      use,\r\n      _button,\r\n      _buttonOpened,\r\n      className,\r\n      style,\r\n      rel: relOrigin,\r\n      ...rest\r\n    } = this.getProps<LinkProps, Link>();\r\n\r\n    let iconElement = null;\r\n    if (icon) {\r\n      iconElement = <span className={jsStyles.icon(this.theme)}>{icon}</span>;\r\n    }\r\n\r\n    let arrow = null;\r\n    if (_button) {\r\n      arrow = <span className={jsStyles.arrow()} />;\r\n    }\r\n\r\n    let rel = relOrigin;\r\n    if (typeof rel === 'undefined' && href) {\r\n      rel = `noopener${isExternalLink(href) ? ' noreferrer' : ''}`;\r\n    }\r\n\r\n    const props = {\r\n      className: cn({\r\n        [jsStyles.root(this.theme)]: true,\r\n        [jsStyles.disabled(this.theme)]: !!disabled,\r\n        [jsStyles.button()]: !!_button,\r\n        [jsStyles.buttonOpened()]: !!_buttonOpened,\r\n        [jsStyles.focus(this.theme)]: !disabled && this.state.focusedByTab,\r\n        [jsStyles.useDefault(this.theme)]: use === 'default',\r\n        [jsStyles.useSuccess(this.theme)]: use === 'success',\r\n        [jsStyles.useDanger(this.theme)]: use === 'danger',\r\n        [jsStyles.useGrayed(this.theme)]: use === 'grayed',\r\n      }),\r\n      href,\r\n      rel,\r\n      onClick: this._handleClick,\r\n      onFocus: this._handleFocus,\r\n      onBlur: this._handleBlur,\r\n      tabIndex: this.props.tabIndex,\r\n    };\r\n    if (disabled) {\r\n      props.tabIndex = -1;\r\n    }\r\n\r\n    return (\r\n      <a {...rest} {...props}>\r\n        {iconElement}\r\n        {this.props.children}\r\n        {arrow}\r\n      </a>\r\n    );\r\n  }\r\n\r\n  private _handleFocus = (event: React.FocusEvent<HTMLAnchorElement>) => {\r\n    if (!this.props.disabled) {\r\n      // focus event fires before keyDown eventlistener\r\n      // so we should check tabPressed in async way\r\n      process.nextTick(() => {\r\n        if (tabListener.isTabPressed) {\r\n          this.setState({ focusedByTab: true });\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  private _handleBlur = () => {\r\n    this.setState({ focusedByTab: false });\r\n  };\r\n\r\n  private _handleClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\r\n    const { href, onClick, disabled } = this.props;\r\n    if (!href) {\r\n      event.preventDefault();\r\n    }\r\n    if (onClick && !disabled) {\r\n      onClick(event);\r\n    }\r\n  };\r\n}\r\n"]}