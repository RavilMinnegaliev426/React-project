{"version":3,"sources":["Select.tsx"],"names":["React","PropTypes","ReactDOM","invariant","warning","cn","isKeyArrowDown","isKeyArrowUp","isKeyArrowVertical","isKeyEnter","isKeyEscape","isKeySpace","locale","reactGetTextContent","Button","DropdownContainer","filterProps","Input","Link","Menu","MenuItem","MenuSeparator","RenderLayer","createPropsGetter","isFunction","ThemeContext","Item","SelectLocaleHelper","jsStyles","PASS_BUTTON_PROPS","disabled","error","use","size","onMouseEnter","onMouseLeave","onMouseOver","Select","state","opened","value","props","defaultValue","theme","menu","buttonElement","getProps","defaultProps","open","setState","onOpen","close","onClose","focus","dropdownContainerGetParent","findDOMNode","focusInput","input","setTimeout","refMenu","toggle","handleKey","e","preventDefault","up","down","enter","onKeyDown","handleSearch","searchPattern","buttonRef","element","getButton","buttonParams","button","_renderButton","renderDefaultButton","Children","only","isValidElement","cloneElement","ref","onFocus","onBlur","componentDidUpdate","_prevProps","prevState","window","addEventListener","removeEventListener","render","renderMain","renderLabel","label","isPlaceholder","onClick","style","width","maxWidth","undefined","root","renderMenu","getValue","item","getItemByValue","renderValue","placeholder","params","diadocLinkIcon","renderLinkButton","buttonProps","align","_noPadding","active","_icon","Object","assign","_noRightPadding","icon","labelProps","className","labelWithLeftIcon","customUsePlaceholder","paddingRight","useIsCustom","labelText","arrowWrap","arrow","customUseArrow","linkProps","_button","_buttonOpened","search","menuAlign","disablePortal","menuWidth","maxMenuHeight","mapItems","iValue","i","comment","key","areValuesEqual","select","bind","renderItem","onValueChange","fn","items","pattern","toLowerCase","result","index","entry","normalizeEntry","filterItem","push","itemValue","Component","__KONTUR_REACT_UI__","propTypes","func","any","bool","oneOfType","array","object","number","string","node","SEP","value1","value2","Array","isArray","toString","indexOf"],"mappings":"uPAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,SAAP,MAAsB,WAAtB;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,OAAOC,EAAP,MAAe,YAAf;;AAEA;AACEC,cADF;AAEEC,YAFF;AAGEC,kBAHF;AAIEC,UAJF;AAKEC,WALF;AAMEC,UANF;AAOO,uCAPP;AAQA,SAASC,MAAT,QAAuB,6BAAvB;AACA,SAASC,mBAAT,QAAoC,+BAApC;AACA,SAASC,MAAT,QAA2D,WAA3D;AACA,SAASC,iBAAT,QAAkC,kCAAlC;AACA,SAASC,WAAT,QAA4B,uBAA5B;AACA,SAASC,KAAT,QAAsB,UAAtB;AACA,SAASC,IAAT,QAAqB,SAArB;AACA,SAASC,IAAT,QAAqB,qBAArB;AACA,SAASC,QAAT,QAAyB,aAAzB;AACA,SAASC,aAAT,QAA8B,kBAA9B;AACA,SAASC,WAAT,QAA4B,4BAA5B;AACA,SAASC,iBAAT,QAAkC,6BAAlC;;AAEA,SAASC,UAAT,QAA2B,iBAA3B;AACA,SAASC,YAAT,QAA6B,gCAA7B;;;AAGA,SAASC,IAAT,QAAqB,QAArB;AACA,SAAuBC,kBAAvB,QAAiD,UAAjD;AACA,SAASC,QAAT,QAAyB,iBAAzB;;;;;;;;;;;AAWA,IAAMC,iBAAiB,GAAG;AACxBC,EAAAA,QAAQ,EAAE,IADc;AAExBC,EAAAA,KAAK,EAAE,IAFiB;AAGxBC,EAAAA,GAAG,EAAE,IAHmB;AAIxBC,EAAAA,IAAI,EAAE,IAJkB;AAKxB7B,EAAAA,OAAO,EAAE,IALe;;AAOxB8B,EAAAA,YAAY,EAAE,IAPU;AAQxBC,EAAAA,YAAY,EAAE,IARU;AASxBC,EAAAA,WAAW,EAAE,IATW,EAA1B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwGA,WAAaC,MAAb,WADCzB,MAAM,CAAC,QAAD,EAAWe,kBAAX,CACP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CSW,IAAAA,KA/CT,GA+CsC;AAClCC,MAAAA,MAAM,EAAE,KAD0B;AAElCC,MAAAA,KAAK,EAAE,MAAKC,KAAL,CAAWC,YAFgB,EA/CtC;;;AAoDUC,IAAAA,KApDV;AAqDmB/B,IAAAA,MArDnB;AAsDUgC,IAAAA,IAtDV;AAuDUC,IAAAA,aAvDV,GAuDwD,IAvDxD;AAwDUC,IAAAA,QAxDV,GAwDqBvB,iBAAiB,CAACc,MAAM,CAACU,YAAR,CAxDtC;;;;;;;;;;;;;;;;;;;;;;;;;AAiFSC,IAAAA,IAjFT,GAiFgB,YAAM;AAClB,UAAI,CAAC,MAAKV,KAAL,CAAWC,MAAhB,EAAwB;AACtB,cAAKU,QAAL,CAAc,EAAEV,MAAM,EAAE,IAAV,EAAd;;AAEA,YAAI,MAAKE,KAAL,CAAWS,MAAf,EAAuB;AACrB,gBAAKT,KAAL,CAAWS,MAAX;AACD;AACF;AACF,KAzFH;;;;;AA8FSC,IAAAA,KA9FT,GA8FiB,YAAM;AACnB,UAAI,MAAKb,KAAL,CAAWC,MAAf,EAAuB;AACrB,cAAKU,QAAL,CAAc,EAAEV,MAAM,EAAE,KAAV,EAAd;;AAEA,YAAI,MAAKE,KAAL,CAAWW,OAAf,EAAwB;AACtB,gBAAKX,KAAL,CAAWW,OAAX;AACD;AACF;AACF,KAtGH;;;;;AA2GSC,IAAAA,KA3GT,GA2GiB,YAAM;AACnB,UAAI,MAAKR,aAAL,IAAsB,MAAKA,aAAL,CAAmBQ,KAA7C,EAAoD;AAClD,cAAKR,aAAL,CAAmBQ,KAAnB;AACD;AACF,KA/GH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuRUC,IAAAA,0BAvRV,GAuRuC,YAAM;AACzC,aAAOpD,QAAQ,CAACqD,WAAT,+BAAP;AACD,KAzRH;;AA2RUC,IAAAA,UA3RV,GA2RuB,UAACC,KAAD,EAAkB;AACrC;AACAC,MAAAA,UAAU,CAAC,oBAAMD,KAAN,oBAAMA,KAAK,CAAEJ,KAAP,EAAN,EAAD,EAAuB,CAAvB,CAAV;AACD,KA9RH;;AAgSUM,IAAAA,OAhSV,GAgSoB,UAACf,IAAD,EAAgB;AAChC,YAAKA,IAAL,GAAYA,IAAZ;AACD,KAlSH;;AAoSUgB,IAAAA,MApSV,GAoSmB,YAAM;AACrB,UAAI,MAAKtB,KAAL,CAAWC,MAAf,EAAuB;AACrB,cAAKY,KAAL;AACD,OAFD,MAEO;AACL,cAAKH,IAAL;AACD;AACF,KA1SH;;AA4SUa,IAAAA,SA5SV,GA4SsB,UAACC,CAAD,EAAyC;AAC3D,UAAI,CAAC,MAAKxB,KAAL,CAAWC,MAAhB,EAAwB;AACtB,YAAI5B,UAAU,CAACmD,CAAD,CAAV,IAAiBtD,kBAAkB,CAACsD,CAAD,CAAvC,EAA4C;AAC1CA,UAAAA,CAAC,CAACC,cAAF;AACA,gBAAKf,IAAL;AACD;AACF,OALD,MAKO;AACL,gBAAQ,IAAR;AACE,eAAKtC,WAAW,CAACoD,CAAD,CAAhB;AACE,kBAAKT,KAAL;AACA,kBAAKF,KAAL;AACA;AACF,eAAK5C,YAAY,CAACuD,CAAD,CAAjB;AACEA,YAAAA,CAAC,CAACC,cAAF;AACA,gBAAI,MAAKnB,IAAT,EAAe;AACb,oBAAKA,IAAL,CAAUoB,EAAV;AACD;AACD;AACF,eAAK1D,cAAc,CAACwD,CAAD,CAAnB;AACEA,YAAAA,CAAC,CAACC,cAAF;AACA,gBAAI,MAAKnB,IAAT,EAAe;AACb,oBAAKA,IAAL,CAAUqB,IAAV;AACD;AACD;AACF,eAAKxD,UAAU,CAACqD,CAAD,CAAf;AACEA,YAAAA,CAAC,CAACC,cAAF,GADF,CACsB;AACpB,gBAAI,MAAKnB,IAAT,EAAe;AACb,oBAAKA,IAAL,CAAUsB,KAAV,CAAgBJ,CAAhB;AACD;AACD,kBAtBJ;;AAwBD;AACD,UAAI,MAAKrB,KAAL,CAAW0B,SAAf,EAA0B;AACxB,cAAK1B,KAAL,CAAW0B,SAAX,CAAqBL,CAArB;AACD;AACF,KA/UH;;AAiVUM,IAAAA,YAjVV,GAiVyB,UAAC5B,KAAD,EAAmB;AACxC,YAAKS,QAAL,CAAc,EAAEoB,aAAa,EAAE7B,KAAjB,EAAd;AACD,KAnVH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2YU8B,IAAAA,SA3YV,GA2YsB,UAACC,OAAD,EAA2C;AAC7D,YAAK1B,aAAL,GAAqB0B,OAArB;AACD,KA7YH;;AA+YUC,IAAAA,SA/YV,GA+YsB,UAACC,YAAD,EAAgC;AAClD,UAAMC,MAAM,GAAG,MAAKjC,KAAL,CAAWkC,aAAX;AACX,YAAKlC,KAAL,CAAWkC,aAAX,CAAyBF,YAAzB,CADW;AAEX,YAAKG,mBAAL,CAAyBH,YAAzB,CAFJ;;AAIA,UAAM5B,aAAa,GAAG7C,KAAK,CAAC6E,QAAN,CAAeC,IAAf,CAAoBJ,MAApB,CAAtB;;AAEA,aAAO1E,KAAK,CAAC+E,cAAN,CAAqBlC,aAArB;AACH7C,MAAAA,KAAK,CAACgF,YAAN,CAAmBnC,aAAnB,EAAwD;AACtDoC,QAAAA,GAAG,EAAE,MAAKX,SAD4C;AAEtDY,QAAAA,OAAO,EAAE,MAAKzC,KAAL,CAAWyC,OAFkC;AAGtDC,QAAAA,MAAM,EAAE,MAAK1C,KAAL,CAAW0C,MAHmC,EAAxD,CADG;;AAMHtC,MAAAA,aANJ;AAOD,KA7ZH,oDA0DSuC,kBA1DT,GA0DE,4BAA0BC,UAA1B,EAAkEC,SAAlE,EAAkG,CAChG,IAAI,CAACA,SAAS,CAAC/C,MAAX,IAAqB,KAAKD,KAAL,CAAWC,MAApC,EAA4C,CAC1CgD,MAAM,CAACC,gBAAP,CAAwB,UAAxB,EAAoC,KAAKrC,KAAzC,EACD,CACD,IAAImC,SAAS,CAAC/C,MAAV,IAAoB,CAAC,KAAKD,KAAL,CAAWC,MAApC,EAA4C,CAC1CgD,MAAM,CAACE,mBAAP,CAA2B,UAA3B,EAAuC,KAAKtC,KAA5C,EACD,CACF,CAjEH,QAmESuC,MAnET,GAmEE,kBAAgB,mBACd,OACE,oBAAC,YAAD,CAAc,QAAd,QACG,UAAA/C,KAAK,EAAI,CACR,MAAI,CAACA,KAAL,GAAaA,KAAb,CACA,OAAO,MAAI,CAACgD,UAAL,EAAP,CACD,CAJH,CADF,CAQD,CA5EH,CA8EE;;0fA9EF,QAiHUA,UAjHV,GAiHE,sBAAqB,yBACc,KAAKC,WAAL,EADd,CACXC,KADW,qBACXA,KADW,CACJC,aADI,qBACJA,aADI,CAGnB,IAAMrB,YAA0B,GAAG,EACjClC,MAAM,EAAE,KAAKD,KAAL,CAAWC,MADc,EAEjCsD,KAAK,EAALA,KAFiC,EAGjCC,aAAa,EAAbA,aAHiC,EAIjCC,OAAO,EAAE,KAAKnC,MAJmB,EAKjCO,SAAS,EAAE,KAAKN,SALiB,EAAnC,CAQA,IAAMmC,KAAK,GAAG,EACZC,KAAK,EAAE,KAAKxD,KAAL,CAAWwD,KADN,EAEZC,QAAQ,EAAE,KAAKzD,KAAL,CAAWyD,QAAX,IAAuBC,SAFrB,EAAd,CAKA,IAAMzB,MAAM,GAAG,KAAKF,SAAL,CAAeC,YAAf,CAAf,CAEA,OACE,oBAAC,WAAD,IAAa,cAAc,EAAE,KAAKtB,KAAlC,EAAyC,cAAc,EAAE,KAAKA,KAA9D,EAAqE,MAAM,EAAE,KAAKb,KAAL,CAAWC,MAAxF,IACE,8BAAM,SAAS,EAAEX,QAAQ,CAACwE,IAAT,CAAc,KAAKzD,KAAnB,CAAjB,EAA4C,KAAK,EAAEqD,KAAnD,IACGtB,MADH,EAEG,CAAC,KAAKjC,KAAL,CAAWX,QAAZ,IAAwB,KAAKQ,KAAL,CAAWC,MAAnC,IAA6C,KAAK8D,UAAL,EAFhD,CADF,CADF,CAQD,CA3IH,QA6IUT,WA7IV,GA6IE,uBAAsB,CACpB,IAAMpD,KAAK,GAAG,KAAK8D,QAAL,EAAd,CACA,IAAMC,IAAI,GAAG,KAAKC,cAAL,CAAoBhE,KAApB,CAAb,CAEA,IAAI+D,IAAI,IAAI,IAAR,IAAgB/D,KAAK,IAAI,IAA7B,EAAmC,CACjC,OAAO,EACLqD,KAAK,EAAE,KAAK/C,QAAL,GAAgB2D,WAAhB,CAA4BjE,KAA5B,EAAmC+D,IAAnC,CADF,EAELT,aAAa,EAAE,KAFV,EAAP,CAID,CAED,OAAO,EACLD,KAAK,EAAE,kCAAO,KAAKpD,KAAL,CAAWiE,WAAX,IAA0B,KAAK9F,MAAL,CAAY8F,WAA7C,CADF,EAELZ,aAAa,EAAE,IAFV,EAAP,CAID,CA5JH,QA8JUlB,mBA9JV,GA8JE,6BAA4B+B,MAA5B,EAAkD,SAChD,IAAI,KAAKlE,KAAL,CAAWmE,cAAf,EAA+B,CAC7BxG,OAAO,CAAC,KAAD,uCAAP,CACA,OAAO,KAAKyG,gBAAL,CAAsBF,MAAtB,CAAP,CACD,CAED,IAAMG,WAAwB,gBACzB9F,WAAW,CAAC,KAAKyB,KAAN,EAAaZ,iBAAb,CADc,IAE5BkF,KAAK,EAAE,MAFqB,EAG5BjF,QAAQ,EAAE,KAAKW,KAAL,CAAWX,QAHO,EAI5BkF,UAAU,EAAE,IAJgB,EAK5Bf,KAAK,EAAE,MALqB,EAM5BF,OAAO,EAAEY,MAAM,CAACZ,OANY,EAO5B5B,SAAS,EAAEwC,MAAM,CAACxC,SAPU,EAQ5B8C,MAAM,EAAEN,MAAM,CAACpE,MARa,GAA9B,CAWA,IAAI,KAAKE,KAAL,CAAWyE,KAAf,EAAsB,CACpBC,MAAM,CAACC,MAAP,CAAcN,WAAd,EAA2B,EACzBE,UAAU,EAAE,KADa,EAEzBK,eAAe,EAAE,IAFQ,EAGzBC,IAAI,EAAE,KAAK7E,KAAL,CAAWyE,KAHQ,EAA3B,EAKD,CAED,IAAMK,UAAU,GAAG,EACjBC,SAAS,EAAEnH,EAAE,gBACVuB,QAAQ,CAACiE,KAAT,EADU,IACS,KAAKpD,KAAL,CAAWT,GAAX,KAAmB,MAD5B,MAEVJ,QAAQ,CAAC6F,iBAAT,EAFU,IAEqB,CAAC,CAAC,KAAKhF,KAAL,CAAWyE,KAFlC,MAGVtF,QAAQ,CAAC8E,WAAT,CAAqB,KAAK/D,KAA1B,CAHU,IAGyBgE,MAAM,CAACb,aAHhC,MAIVlE,QAAQ,CAAC8F,oBAAT,EAJU,IAIwBf,MAAM,CAACb,aAAP,IAAwB,KAAKrD,KAAL,CAAWT,GAAX,KAAmB,SAJnE,OADI,EAOjBgE,KAAK,EAAE,EACL2B,YAAY,EAAE,CAACb,WAAW,CAAC7E,IAAZ,KAAqB,OAArB,GAA+B,EAA/B,GAAoC,EAArC,KAA4C,KAAKQ,KAAL,CAAWyE,KAAX,GAAmB,EAAnB,GAAwB,CAApE,CADT,EAPU,EAAnB,CAYA,IAAMU,WAAW,GAAG,KAAKnF,KAAL,CAAWT,GAAX,KAAmB,SAAvC,CAEA,OACE,oBAAC,MAAD,EAAY8E,WAAZ,EACE,4BAAUS,UAAV,EACE,8BAAM,SAAS,EAAE3F,QAAQ,CAACiG,SAAT,EAAjB,IAAwClB,MAAM,CAACd,KAA/C,CADF,CADF,EAIE,6BAAK,SAAS,EAAEjE,QAAQ,CAACkG,SAAT,EAAhB,IACE,6BAAK,SAAS,EAAEzH,EAAE,CAACuB,QAAQ,CAACmG,KAAT,CAAe,KAAKpF,KAApB,CAAD,EAA6BiF,WAAW,IAAIhG,QAAQ,CAACoG,cAAT,EAA5C,CAAlB,GADF,CAJF,CADF,CAUD,CA/MH,QAiNUnB,gBAjNV,GAiNE,0BAAyBF,MAAzB,EAAgE,CAC9D,IAAMsB,SAAS,GAAG,EAChBnG,QAAQ,EAAE6E,MAAM,CAAC7E,QADD,EAEhBwF,IAAI,EAAE,KAAK7E,KAAL,CAAWmE,cAFD,EAGhBsB,OAAO,EAAE,IAHO,EAIhBC,aAAa,EAAExB,MAAM,CAACpE,MAJN,EAMhBwD,OAAO,EAAEY,MAAM,CAACZ,OANA,EAOhB5B,SAAS,EAAEwC,MAAM,CAACxC,SAPF,EAAlB,CAUA,OAAO,oBAAC,IAAD,EAAU8D,SAAV,EAAsBtB,MAAM,CAACd,KAA7B,CAAP,CACD,CA7NH,QA+NUQ,UA/NV,GA+NE,sBAAsC,mBACpC,IAAM+B,MAAM,GAAG,KAAK3F,KAAL,CAAW2F,MAAX,GACb,6BAAK,SAAS,EAAExG,QAAQ,CAACwG,MAAT,EAAhB,IACE,oBAAC,KAAD,IAAO,GAAG,EAAE,KAAK5E,UAAjB,EAA6B,aAAa,EAAE,KAAKY,YAAjD,EAA+D,KAAK,EAAC,MAArE,GADF,CADa,GAIX,IAJJ,CAMA,IAAM5B,KAAK,GAAG,KAAK8D,QAAL,EAAd,CAEA,OACE,oBAAC,iBAAD,IACE,SAAS,EAAE,KAAKhD,0BADlB,EAEE,OAAO,EAAE,CAAC,CAFZ,EAGE,KAAK,EAAE,KAAKb,KAAL,CAAW4F,SAHpB,EAIE,aAAa,EAAE,KAAK5F,KAAL,CAAW6F,aAJ5B,IAME,oBAAC,IAAD,IACE,GAAG,EAAE,KAAK3E,OADZ,EAEE,KAAK,EAAE,KAAKlB,KAAL,CAAW8F,SAFpB,EAGE,WAAW,EAAE,KAAKpF,KAHpB,EAIE,SAAS,EAAE,KAAKV,KAAL,CAAW+F,aAJxB,IAMGJ,MANH,EAOG,KAAKK,QAAL,CACC,UAACC,MAAD,EAAiBnC,IAAjB,EAAwDoC,CAAxD,EAAmEC,OAAnE,EAA0G,CACxG,IAAIpH,UAAU,CAAC+E,IAAD,CAAd,EAAsB,CACpB,IAAMhC,OAAO,GAAGgC,IAAI,EAApB,CAEA,IAAIvG,KAAK,CAAC+E,cAAN,CAAqBR,OAArB,CAAJ,EAAmC,CACjC,OAAOvE,KAAK,CAACgF,YAAN,CAAmBT,OAAnB,EAA4B,EAAEsE,GAAG,EAAEF,CAAP,EAA5B,CAAP,CACD,CAED,OAAO,IAAP,CACD,CAED,IAAI3I,KAAK,CAAC+E,cAAN,CAAqBwB,IAArB,CAAJ,EAAgC,CAC9B,OAAOvG,KAAK,CAACgF,YAAN,CAAmBuB,IAAnB,EAAyB,EAAEsC,GAAG,EAAEF,CAAP,EAAzB,CAAP,CACD,CAED,OACE,oBAAC,QAAD,IACE,GAAG,EAAEA,CADP,EAEE,KAAK,EAAE,MAAI,CAAC7F,QAAL,GAAgBgG,cAAhB,CAA+BJ,MAA/B,EAAuClG,KAAvC,IAAgD,UAAhD,GAA6D,IAFtE,EAGE,OAAO,EAAE,MAAI,CAACuG,MAAL,CAAYC,IAAZ,CAAiB,MAAjB,EAAuBN,MAAvB,CAHX,EAIE,OAAO,EAAEE,OAJX,IAMG,MAAI,CAAC9F,QAAL,GAAgBmG,UAAhB,CAA2BP,MAA3B,EAAmCnC,IAAnC,CANH,CADF,CAUD,CA1BF,CAPH,CANF,CADF,CA6CD,CArRH,QAqVUwC,MArVV,GAqVE,gBAAevG,KAAf,EAA8B,CAC5B,KAAKa,KAAL,GACA,KAAKJ,QAAL,CAAc,EAAEV,MAAM,EAAE,KAAV,EAAiBC,KAAK,EAALA,KAAjB,EAAd,EAEA,IAAI,KAAKC,KAAL,CAAWyG,aAAX,IAA4B,CAAC,KAAKpG,QAAL,GAAgBgG,cAAhB,CAA+B,KAAKxC,QAAL,EAA/B,EAAgD9D,KAAhD,CAAjC,EAAyF,CACvF,KAAKC,KAAL,CAAWyG,aAAX,CAAyB1G,KAAzB,EACD,CACF,CA5VH,QA8VU8D,QA9VV,GA8VE,oBAAmB,CACjB,IAAI,KAAK7D,KAAL,CAAWD,KAAX,KAAqB2D,SAAzB,EAAoC,CAClC,OAAO,KAAK1D,KAAL,CAAWD,KAAlB,CACD,CACD,OAAO,KAAKF,KAAL,CAAWE,KAAlB,CACD,CAnWH,QAqWUiG,QArWV,GAqWE,kBAAiBU,EAAjB,EAAuG,KAC7FC,KAD6F,GACnF,KAAK3G,KAD8E,CAC7F2G,KAD6F,CAErG,IAAI,CAACA,KAAL,EAAY,CACV,OAAO,EAAP,CACD,CACD,IAAMC,OAAO,GAAG,KAAK/G,KAAL,CAAW+B,aAAX,IAA4B,KAAK/B,KAAL,CAAW+B,aAAX,CAAyBiF,WAAzB,EAA5C,CAEA,IAAMC,MAA4B,GAAG,EAArC,CACA,IAAIC,KAAK,GAAG,CAAZ,CACA,qBAAoBJ,KAApB,kHAA2B,wJAAhBK,KAAgB,8BACMC,cAAc,CAACD,KAAD,CADpB,CAClBjH,MADkB,sBACX+D,KADW,sBACLqC,QADK,sBAGzB,IAAI,CAACS,OAAD,IAAY,KAAKvG,QAAL,GAAgB6G,UAAhB,CAA2BnH,MAA3B,EAAkC+D,KAAlC,EAAwC8C,OAAxC,CAAhB,EAAkE,CAChEE,MAAM,CAACK,IAAP,CAAYT,EAAE,CAAC3G,MAAD,EAAQ+D,KAAR,EAAciD,KAAd,EAAqBZ,QAArB,CAAd,EACA,EAAEY,KAAF,CACD,CACF,CAED,OAAOD,MAAP,CACD,CAxXH,QA0XU/C,cA1XV,GA0XE,wBAAuBhE,KAAvB,EAAiD,CAC/C,IAAIA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK2D,SAAhC,EAA2C,CACzC,OAAO,IAAP,CACD,CAED,IAAMiD,KAAK,GAAG,KAAK3G,KAAL,CAAW2G,KAAX,IAAoB,EAAlC,CAEA,sBAAoBA,KAApB,yHAA2B,oKAAhBK,KAAgB,gCACCC,cAAc,CAACD,KAAD,CADf,CAClBI,SADkB,uBACPtD,MADO,uBAGzB,IAAI,KAAKzD,QAAL,GAAgBgG,cAAhB,CAA+Be,SAA/B,EAA0CrH,KAA1C,CAAJ,EAAsD,CACpD,OAAO+D,MAAP,CACD,CACF,CACD,OAAO,IAAP,CACD,CAzYH,iBAAqDvG,KAAK,CAAC8J,SAA3D,WACgBC,mBADhB,GACsC,QADtC,UAGgBC,SAHhB,GAG4B,EACxBlB,cAAc,EAAE7I,SAAS,CAACgK,IADF,EAExBvH,YAAY,EAAEzC,SAAS,CAACiK,GAFA,EAGxB5B,aAAa,EAAErI,SAAS,CAACkK,IAHD,EAIxBrI,QAAQ,EAAE7B,SAAS,CAACkK,IAJI,EAKxBpI,KAAK,EAAE9B,SAAS,CAACkK,IALO,EAMxBR,UAAU,EAAE1J,SAAS,CAACgK,IANE,EAOxBb,KAAK,EAAEnJ,SAAS,CAACmK,SAAV,CAAoB,CAACnK,SAAS,CAACoK,KAAX,EAAkBpK,SAAS,CAACqK,MAA5B,CAApB,CAPiB,EAQxB9B,aAAa,EAAEvI,SAAS,CAACsK,MARD,EASxBrE,QAAQ,EAAEjG,SAAS,CAACmK,SAAV,CAAoB,CAACnK,SAAS,CAACsK,MAAX,EAAmBtK,SAAS,CAACuK,MAA7B,CAApB,CATc,EAUxB9D,WAAW,EAAEzG,SAAS,CAACwK,IAVC,EAWxBxB,UAAU,EAAEhJ,SAAS,CAACgK,IAXE,EAYxBxD,WAAW,EAAExG,SAAS,CAACgK,IAZC,EAaxB7B,MAAM,EAAEnI,SAAS,CAACkK,IAbM,EAcxB3H,KAAK,EAAEvC,SAAS,CAACiK,GAdO,EAexBjE,KAAK,EAAEhG,SAAS,CAACmK,SAAV,CAAoB,CAACnK,SAAS,CAACsK,MAAX,EAAmBtK,SAAS,CAACuK,MAA7B,CAApB,CAfiB,EAgBxBtB,aAAa,EAAEjJ,SAAS,CAACgK,IAhBD,EAiBxB/H,YAAY,EAAEjC,SAAS,CAACgK,IAjBA,EAkBxB9H,YAAY,EAAElC,SAAS,CAACgK,IAlBA,EAmBxB7H,WAAW,EAAEnC,SAAS,CAACgK,IAnBC,EAoBxB9F,SAAS,EAAElE,SAAS,CAACgK,IApBG,EAH5B,UA0BgBlH,YA1BhB,GA0B+B,EAC3B0D,WAAW,EAAXA,WAD2B,EAE3BwC,UAAU,EAAVA,UAF2B,EAG3BH,cAAc,EAAdA,cAH2B,EAI3Ba,UAAU,EAAVA,UAJ2B,EAK3B3H,GAAG,EAAE,SALsB,EA1B/B,UAkCgBN,IAlChB,GAkCuBA,IAlCvB,UAmCgBgJ,GAnChB,GAmCsB,oBAAM,oBAAC,aAAD,OAAN,EAnCtB,sBAqCyB,UACrBnG,OADqB,EAElB,CACHpE,SAAS,CACPH,KAAK,CAAC+E,cAAN,CAAqBR,OAArB,KAAiC,OAAOA,OAAP,KAAmB,UAD7C,EAEP,qEAFO,CAAT,CAIA,OAAOA,OAAP,CACD,CA7CH;AAgaA,SAASkC,WAAT,CAAqBjE,KAArB,EAAiC+D,IAAjC,EAA4C;AAC1C,SAAOA,IAAP;AACD;;AAED,SAAS0C,UAAT,CAAoBzG,KAApB,EAAgC+D,IAAhC,EAA2C;AACzC,SAAOA,IAAP;AACD;;AAED,SAASuC,cAAT,CAAwB6B,MAAxB,EAAqCC,MAArC,EAAkD;AAChD,SAAOD,MAAM,KAAKC,MAAlB;AACD;;AAED,SAASlB,cAAT,CAAwBD,KAAxB,EAAoC;AAClC,MAAIoB,KAAK,CAACC,OAAN,CAAcrB,KAAd,CAAJ,EAA0B;AACxB,WAAOA,KAAP;AACD,GAFD,MAEO;AACL,WAAO,CAACA,KAAD,EAAQA,KAAR,EAAetD,SAAf,CAAP;AACD;AACF;;AAED,SAASwD,UAAT,CAAoBnH,KAApB,EAAgC+D,IAAhC,EAA2C8C,OAA3C,EAA4D;AAC1D,MAAI9C,IAAI,KAAKlE,MAAM,CAACqI,GAApB,EAAyB;AACvB,WAAO,KAAP;AACD;AACD,MAAI1K,KAAK,CAAC+E,cAAN,CAAqBwB,IAArB,KAA+B/E,UAAU,CAAC+E,IAAD,CAAV,IAAoBvG,KAAK,CAAC+E,cAAN,CAAsBwB,IAAI,GAAGA,IAAI,EAAjC,CAAvD,EAA+F;AAC7FA,IAAAA,IAAI,GAAG1F,mBAAmB,CAAC0F,IAAD,CAA1B;AACD;AACD,MAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC5BA,IAAAA,IAAI,GAAGA,IAAI,CAACwE,QAAL,CAAc,EAAd,CAAP;AACD;AACD,MAAI,OAAOxE,IAAP,KAAgB,QAApB,EAA8B;AAC5B,WAAO,KAAP;AACD;AACD,SAAOA,IAAI,CAAC+C,WAAL,GAAmB0B,OAAnB,CAA2B3B,OAA3B,MAAwC,CAAC,CAAhD;AACD","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport ReactDOM from 'react-dom';\r\nimport invariant from 'invariant';\r\nimport warning from 'warning';\r\nimport cn from 'classnames';\r\n\r\nimport {\r\n  isKeyArrowDown,\r\n  isKeyArrowUp,\r\n  isKeyArrowVertical,\r\n  isKeyEnter,\r\n  isKeyEscape,\r\n  isKeySpace,\r\n} from '../../lib/events/keyboard/identifiers';\r\nimport { locale } from '../../lib/locale/decorators';\r\nimport { reactGetTextContent } from '../../lib/reactGetTextContent';\r\nimport { Button, ButtonProps, ButtonSize, ButtonUse } from '../Button';\r\nimport { DropdownContainer } from '../../internal/DropdownContainer';\r\nimport { filterProps } from '../../lib/filterProps';\r\nimport { Input } from '../Input';\r\nimport { Link } from '../Link';\r\nimport { Menu } from '../../internal/Menu';\r\nimport { MenuItem } from '../MenuItem';\r\nimport { MenuSeparator } from '../MenuSeparator';\r\nimport { RenderLayer } from '../../internal/RenderLayer';\r\nimport { createPropsGetter } from '../../lib/createPropsGetter';\r\nimport { Nullable } from '../../typings/utility-types';\r\nimport { isFunction } from '../../lib/utils';\r\nimport { ThemeContext } from '../../lib/theming/ThemeContext';\r\nimport { Theme } from '../../lib/theming/Theme';\r\n\r\nimport { Item } from './Item';\r\nimport { SelectLocale, SelectLocaleHelper } from './locale';\r\nimport { jsStyles } from './Select.styles';\r\n\r\nexport interface ButtonParams {\r\n  disabled?: boolean;\r\n  label: React.ReactNode;\r\n  onClick: () => void;\r\n  onKeyDown: (event: React.KeyboardEvent<HTMLElement>) => void;\r\n  opened: boolean;\r\n  isPlaceholder: boolean;\r\n}\r\n\r\nconst PASS_BUTTON_PROPS = {\r\n  disabled: true,\r\n  error: true,\r\n  use: true,\r\n  size: true,\r\n  warning: true,\r\n\r\n  onMouseEnter: true,\r\n  onMouseLeave: true,\r\n  onMouseOver: true,\r\n};\r\n\r\nexport interface SelectProps<TValue, TItem> {\r\n  /** @ignore */\r\n  _icon?: React.ReactElement<any>;\r\n  /** @ignore */\r\n  _renderButton?: (params: ButtonParams) => React.ReactNode;\r\n  defaultValue?: TValue;\r\n  /** @deprecated @ignore */\r\n  diadocLinkIcon?: React.ReactElement<any>;\r\n  /**\r\n   * Отключает использование портала\r\n   */\r\n  disablePortal?: boolean;\r\n  disabled?: boolean;\r\n  /**\r\n   * Визуально показать наличие ошибки.\r\n   */\r\n  error?: boolean;\r\n  filterItem?: (value: TValue, item: TItem, pattern: string) => boolean;\r\n  /**\r\n   * Набор значений. Поддерживаются любые перечисляемые типы, в том числе\r\n   * `Array`, `Map`, `Immutable.Map`.\r\n   *\r\n   * Элементы воспринимаются следующим образом: если элемент — это массив, то\r\n   * первый элемент является значением, второй — отображается в списке,\r\n   * а третий – комментарий;\r\n   * если элемент не является массивом, то он используется и для отображения,\r\n   * и для значения.\r\n   *\r\n   * Для вставки разделителя можно использовать `Select.SEP`.\r\n   *\r\n   * Вставить невыделяемый элемент со своей разметкой можно так:\r\n   * ```\r\n   * <Select ...\r\n   *   items={[Select.static(() => <div>My Element</div>)]}\r\n   * />\r\n   * ```\r\n   *\r\n   * Чтобы добавить стандартный отступ для статического элемента:\r\n   * ```\r\n   * <Select.Item>My Element</Select.Item>\r\n   * ```\r\n   */\r\n  items?: Array<[TValue, TItem, React.ReactNode?] | TItem | React.ReactElement | (() => React.ReactElement)>;\r\n  maxMenuHeight?: number;\r\n  maxWidth?: React.CSSProperties['maxWidth'];\r\n  menuAlign?: 'left' | 'right';\r\n  menuWidth?: React.CSSProperties['width'];\r\n  onValueChange?: (value: TValue) => void;\r\n  onClose?: () => void;\r\n  onMouseEnter?: (e: React.MouseEvent<HTMLElement>) => void;\r\n  onMouseLeave?: (e: React.MouseEvent<HTMLElement>) => void;\r\n  onMouseOver?: (e: React.MouseEvent<HTMLElement>) => void;\r\n  onKeyDown?: (e: React.KeyboardEvent<HTMLElement>) => void;\r\n  onOpen?: () => void;\r\n  placeholder?: React.ReactNode;\r\n  /**\r\n   * Функция для отрисовки элемента в выпадающем списке. Аргументы — *value*,\r\n   * *item*.\r\n   */\r\n  renderItem?: (value: TValue, item?: TItem) => React.ReactNode;\r\n  /**\r\n   * Функция для отрисовки выбранного элемента. Аргументы — *value*, *item*.\r\n   */\r\n  renderValue?: (value: TValue, item?: TItem) => React.ReactNode;\r\n  /**\r\n   * Функция для сравнения `value` с элементом из `items`\r\n   */\r\n  areValuesEqual?: (value1: TValue, value2: TValue) => boolean;\r\n  /**\r\n   * Показывать строку поиска в списке.\r\n   */\r\n  search?: boolean;\r\n  value?: TValue;\r\n  width?: number | string;\r\n  warning?: boolean;\r\n  use?: ButtonUse;\r\n  size?: ButtonSize;\r\n  onFocus?: React.FocusEventHandler<HTMLElement>;\r\n  onBlur?: React.FocusEventHandler<HTMLElement>;\r\n}\r\n\r\nexport interface SelectState<TValue> {\r\n  opened: boolean;\r\n  searchPattern?: string;\r\n  value: Nullable<TValue>;\r\n}\r\n\r\ninterface FocusableReactElement extends React.ReactElement<any> {\r\n  focus: (event?: any) => void;\r\n}\r\n\r\n@locale('Select', SelectLocaleHelper)\r\nexport class Select<TValue = {}, TItem = {}> extends React.Component<SelectProps<TValue, TItem>, SelectState<TValue>> {\r\n  public static __KONTUR_REACT_UI__ = 'Select';\r\n\r\n  public static propTypes = {\r\n    areValuesEqual: PropTypes.func,\r\n    defaultValue: PropTypes.any,\r\n    disablePortal: PropTypes.bool,\r\n    disabled: PropTypes.bool,\r\n    error: PropTypes.bool,\r\n    filterItem: PropTypes.func,\r\n    items: PropTypes.oneOfType([PropTypes.array, PropTypes.object]),\r\n    maxMenuHeight: PropTypes.number,\r\n    maxWidth: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n    placeholder: PropTypes.node,\r\n    renderItem: PropTypes.func,\r\n    renderValue: PropTypes.func,\r\n    search: PropTypes.bool,\r\n    value: PropTypes.any,\r\n    width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n    onValueChange: PropTypes.func,\r\n    onMouseEnter: PropTypes.func,\r\n    onMouseLeave: PropTypes.func,\r\n    onMouseOver: PropTypes.func,\r\n    onKeyDown: PropTypes.func,\r\n  };\r\n\r\n  public static defaultProps = {\r\n    renderValue,\r\n    renderItem,\r\n    areValuesEqual,\r\n    filterItem,\r\n    use: 'default',\r\n  };\r\n\r\n  public static Item = Item;\r\n  public static SEP = () => <MenuSeparator />;\r\n\r\n  public static static = (\r\n    element: React.ReactElement | (() => React.ReactElement),\r\n  ) => {\r\n    invariant(\r\n      React.isValidElement(element) || typeof element === 'function',\r\n      'Select.static(element) expects element to be a valid react element.',\r\n    );\r\n    return element;\r\n  };\r\n\r\n  public state: SelectState<TValue> = {\r\n    opened: false,\r\n    value: this.props.defaultValue,\r\n  };\r\n\r\n  private theme!: Theme;\r\n  private readonly locale!: SelectLocale;\r\n  private menu: Nullable<Menu>;\r\n  private buttonElement: FocusableReactElement | null = null;\r\n  private getProps = createPropsGetter(Select.defaultProps);\r\n\r\n  public componentDidUpdate(_prevProps: SelectProps<TValue, TItem>, prevState: SelectState<TValue>) {\r\n    if (!prevState.opened && this.state.opened) {\r\n      window.addEventListener('popstate', this.close);\r\n    }\r\n    if (prevState.opened && !this.state.opened) {\r\n      window.removeEventListener('popstate', this.close);\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <ThemeContext.Consumer>\r\n        {theme => {\r\n          this.theme = theme;\r\n          return this.renderMain();\r\n        }}\r\n      </ThemeContext.Consumer>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public open = () => {\r\n    if (!this.state.opened) {\r\n      this.setState({ opened: true });\r\n\r\n      if (this.props.onOpen) {\r\n        this.props.onOpen();\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public close = () => {\r\n    if (this.state.opened) {\r\n      this.setState({ opened: false });\r\n\r\n      if (this.props.onClose) {\r\n        this.props.onClose();\r\n      }\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public focus = () => {\r\n    if (this.buttonElement && this.buttonElement.focus) {\r\n      this.buttonElement.focus();\r\n    }\r\n  };\r\n\r\n  private renderMain() {\r\n    const { label, isPlaceholder } = this.renderLabel();\r\n\r\n    const buttonParams: ButtonParams = {\r\n      opened: this.state.opened,\r\n      label,\r\n      isPlaceholder,\r\n      onClick: this.toggle,\r\n      onKeyDown: this.handleKey,\r\n    };\r\n\r\n    const style = {\r\n      width: this.props.width,\r\n      maxWidth: this.props.maxWidth || undefined,\r\n    };\r\n\r\n    const button = this.getButton(buttonParams);\r\n\r\n    return (\r\n      <RenderLayer onClickOutside={this.close} onFocusOutside={this.close} active={this.state.opened}>\r\n        <span className={jsStyles.root(this.theme)} style={style}>\r\n          {button}\r\n          {!this.props.disabled && this.state.opened && this.renderMenu()}\r\n        </span>\r\n      </RenderLayer>\r\n    );\r\n  }\r\n\r\n  private renderLabel() {\r\n    const value = this.getValue();\r\n    const item = this.getItemByValue(value);\r\n\r\n    if (item != null || value != null) {\r\n      return {\r\n        label: this.getProps().renderValue(value, item),\r\n        isPlaceholder: false,\r\n      };\r\n    }\r\n\r\n    return {\r\n      label: <span>{this.props.placeholder || this.locale.placeholder}</span>,\r\n      isPlaceholder: true,\r\n    };\r\n  }\r\n\r\n  private renderDefaultButton(params: ButtonParams) {\r\n    if (this.props.diadocLinkIcon) {\r\n      warning(false, `diadocLinkIcon has been deprecated`);\r\n      return this.renderLinkButton(params);\r\n    }\r\n\r\n    const buttonProps: ButtonProps = {\r\n      ...filterProps(this.props, PASS_BUTTON_PROPS),\r\n      align: 'left' as React.CSSProperties['textAlign'],\r\n      disabled: this.props.disabled,\r\n      _noPadding: true,\r\n      width: '100%',\r\n      onClick: params.onClick,\r\n      onKeyDown: params.onKeyDown,\r\n      active: params.opened,\r\n    };\r\n\r\n    if (this.props._icon) {\r\n      Object.assign(buttonProps, {\r\n        _noPadding: false,\r\n        _noRightPadding: true,\r\n        icon: this.props._icon,\r\n      });\r\n    }\r\n\r\n    const labelProps = {\r\n      className: cn({\r\n        [jsStyles.label()]: this.props.use !== 'link',\r\n        [jsStyles.labelWithLeftIcon()]: !!this.props._icon,\r\n        [jsStyles.placeholder(this.theme)]: params.isPlaceholder,\r\n        [jsStyles.customUsePlaceholder()]: params.isPlaceholder && this.props.use !== 'default',\r\n      }),\r\n      style: {\r\n        paddingRight: (buttonProps.size === 'large' ? 31 : 28) + (this.props._icon ? 10 : 0),\r\n      },\r\n    };\r\n\r\n    const useIsCustom = this.props.use !== 'default';\r\n\r\n    return (\r\n      <Button {...buttonProps}>\r\n        <span {...labelProps}>\r\n          <span className={jsStyles.labelText()}>{params.label}</span>\r\n        </span>\r\n        <div className={jsStyles.arrowWrap()}>\r\n          <div className={cn(jsStyles.arrow(this.theme), useIsCustom && jsStyles.customUseArrow())} />\r\n        </div>\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  private renderLinkButton(params: ButtonParams): React.ReactNode {\r\n    const linkProps = {\r\n      disabled: params.disabled,\r\n      icon: this.props.diadocLinkIcon,\r\n      _button: true,\r\n      _buttonOpened: params.opened,\r\n\r\n      onClick: params.onClick,\r\n      onKeyDown: params.onKeyDown,\r\n    };\r\n\r\n    return <Link {...linkProps}>{params.label}</Link>;\r\n  }\r\n\r\n  private renderMenu(): React.ReactNode {\r\n    const search = this.props.search ? (\r\n      <div className={jsStyles.search()}>\r\n        <Input ref={this.focusInput} onValueChange={this.handleSearch} width=\"100%\" />\r\n      </div>\r\n    ) : null;\r\n\r\n    const value = this.getValue();\r\n\r\n    return (\r\n      <DropdownContainer\r\n        getParent={this.dropdownContainerGetParent}\r\n        offsetY={-1}\r\n        align={this.props.menuAlign}\r\n        disablePortal={this.props.disablePortal}\r\n      >\r\n        <Menu\r\n          ref={this.refMenu}\r\n          width={this.props.menuWidth}\r\n          onItemClick={this.close}\r\n          maxHeight={this.props.maxMenuHeight}\r\n        >\r\n          {search}\r\n          {this.mapItems(\r\n            (iValue: TValue, item: TItem | (() => React.ReactNode), i: number, comment: Nullable<React.ReactNode>) => {\r\n              if (isFunction(item)) {\r\n                const element = item();\r\n\r\n                if (React.isValidElement(element)) {\r\n                  return React.cloneElement(element, { key: i });\r\n                }\r\n\r\n                return null;\r\n              }\r\n\r\n              if (React.isValidElement(item)) {\r\n                return React.cloneElement(item, { key: i });\r\n              }\r\n\r\n              return (\r\n                <MenuItem\r\n                  key={i}\r\n                  state={this.getProps().areValuesEqual(iValue, value) ? 'selected' : null}\r\n                  onClick={this.select.bind(this, iValue)}\r\n                  comment={comment}\r\n                >\r\n                  {this.getProps().renderItem(iValue, item)}\r\n                </MenuItem>\r\n              );\r\n            },\r\n          )}\r\n        </Menu>\r\n      </DropdownContainer>\r\n    );\r\n  }\r\n\r\n  private dropdownContainerGetParent = () => {\r\n    return ReactDOM.findDOMNode(this);\r\n  };\r\n\r\n  private focusInput = (input: Input) => {\r\n    // fix cases when an Input is rendered in portal\r\n    setTimeout(() => input?.focus(), 0);\r\n  };\r\n\r\n  private refMenu = (menu: Menu) => {\r\n    this.menu = menu;\r\n  };\r\n\r\n  private toggle = () => {\r\n    if (this.state.opened) {\r\n      this.close();\r\n    } else {\r\n      this.open();\r\n    }\r\n  };\r\n\r\n  private handleKey = (e: React.KeyboardEvent<HTMLElement>) => {\r\n    if (!this.state.opened) {\r\n      if (isKeySpace(e) || isKeyArrowVertical(e)) {\r\n        e.preventDefault();\r\n        this.open();\r\n      }\r\n    } else {\r\n      switch (true) {\r\n        case isKeyEscape(e):\r\n          this.focus();\r\n          this.close();\r\n          break;\r\n        case isKeyArrowUp(e):\r\n          e.preventDefault();\r\n          if (this.menu) {\r\n            this.menu.up();\r\n          }\r\n          break;\r\n        case isKeyArrowDown(e):\r\n          e.preventDefault();\r\n          if (this.menu) {\r\n            this.menu.down();\r\n          }\r\n          break;\r\n        case isKeyEnter(e):\r\n          e.preventDefault(); // To prevent form submission.\r\n          if (this.menu) {\r\n            this.menu.enter(e);\r\n          }\r\n          break;\r\n      }\r\n    }\r\n    if (this.props.onKeyDown) {\r\n      this.props.onKeyDown(e);\r\n    }\r\n  };\r\n\r\n  private handleSearch = (value: string) => {\r\n    this.setState({ searchPattern: value });\r\n  };\r\n\r\n  private select(value: TValue) {\r\n    this.focus();\r\n    this.setState({ opened: false, value });\r\n\r\n    if (this.props.onValueChange && !this.getProps().areValuesEqual(this.getValue(), value)) {\r\n      this.props.onValueChange(value);\r\n    }\r\n  }\r\n\r\n  private getValue() {\r\n    if (this.props.value !== undefined) {\r\n      return this.props.value;\r\n    }\r\n    return this.state.value;\r\n  }\r\n\r\n  private mapItems(fn: (value: TValue, item: TItem, index: number, comment?: string) => React.ReactNode) {\r\n    const { items } = this.props;\r\n    if (!items) {\r\n      return [];\r\n    }\r\n    const pattern = this.state.searchPattern && this.state.searchPattern.toLowerCase();\r\n\r\n    const result: React.ReactNodeArray = [];\r\n    let index = 0;\r\n    for (const entry of items) {\r\n      const [value, item, comment] = normalizeEntry(entry as TItem);\r\n\r\n      if (!pattern || this.getProps().filterItem(value, item, pattern)) {\r\n        result.push(fn(value, item, index, comment));\r\n        ++index;\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  private getItemByValue(value?: Nullable<TValue>) {\r\n    if (value === null || value === undefined) {\r\n      return null;\r\n    }\r\n\r\n    const items = this.props.items || [];\r\n\r\n    for (const entry of items) {\r\n      const [itemValue, item] = normalizeEntry(entry);\r\n\r\n      if (this.getProps().areValuesEqual(itemValue, value)) {\r\n        return item;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  private buttonRef = (element: FocusableReactElement | null) => {\r\n    this.buttonElement = element;\r\n  };\r\n\r\n  private getButton = (buttonParams: ButtonParams) => {\r\n    const button = this.props._renderButton\r\n      ? this.props._renderButton(buttonParams)\r\n      : this.renderDefaultButton(buttonParams);\r\n\r\n    const buttonElement = React.Children.only(button);\r\n\r\n    return React.isValidElement(buttonElement)\r\n      ? React.cloneElement(buttonElement as React.ReactElement, {\r\n          ref: this.buttonRef,\r\n          onFocus: this.props.onFocus,\r\n          onBlur: this.props.onBlur,\r\n        })\r\n      : buttonElement;\r\n  };\r\n}\r\n\r\nfunction renderValue(value: any, item: any) {\r\n  return item;\r\n}\r\n\r\nfunction renderItem(value: any, item: any) {\r\n  return item;\r\n}\r\n\r\nfunction areValuesEqual(value1: any, value2: any) {\r\n  return value1 === value2;\r\n}\r\n\r\nfunction normalizeEntry(entry: any) {\r\n  if (Array.isArray(entry)) {\r\n    return entry;\r\n  } else {\r\n    return [entry, entry, undefined];\r\n  }\r\n}\r\n\r\nfunction filterItem(value: any, item: any, pattern: string) {\r\n  if (item === Select.SEP) {\r\n    return false;\r\n  }\r\n  if (React.isValidElement(item) || (isFunction(item) && React.isValidElement((item = item())))) {\r\n    item = reactGetTextContent(item);\r\n  }\r\n  if (typeof item === 'number') {\r\n    item = item.toString(10);\r\n  }\r\n  if (typeof item !== 'string') {\r\n    return false;\r\n  }\r\n  return item.toLowerCase().indexOf(pattern) !== -1;\r\n}\r\n"]}