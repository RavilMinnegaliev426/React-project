{"version":3,"sources":["MonthView.tsx"],"names":["React","useContext","cn","DateSelect","ThemeContext","ColorFunctions","jsStyles","config","CDS","MonthView","props","theme","children","height","isFirstInYear","isLastInYear","maxDate","minDate","month","top","year","onMonthSelect","onYearSelect","monthSelectRef","yearSelectRef","isTopNegative","isHeaderSticky","headerTop","Math","min","MONTH_TITLE_HEIGHT","alpha","borderBottomColor","fade","calendarMonthTitleBorderBottomColor","isYearVisible","yearTop","monthSelectDisabled","yearSelectDisabled","getMinMonth","value","i","isGreaterOrEqual","date","getMaxMonth","max","isLessOrEqual","lineHeight","monthTitle","headerSticky","headerMonth","undefined","headerYear"],"mappings":"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","sourcesContent":["import React, { useContext } from 'react';\r\nimport cn from 'classnames';\r\n\r\nimport { DateSelect } from '../DateSelect';\r\nimport { ThemeContext } from '../../lib/theming/ThemeContext';\r\nimport * as ColorFunctions from '../../lib/styles/ColorFunctions';\r\n\r\nimport { jsStyles } from './MonthView.styles';\r\nimport { config } from './config';\r\nimport * as CDS from './CalendarDateShape';\r\n\r\ninterface MonthViewProps {\r\n  children: React.ReactNode;\r\n  firstDayOffset: number;\r\n  height: number;\r\n  isFirstInYear?: boolean;\r\n  isLastInYear?: boolean;\r\n  maxDate?: CDS.CalendarDateShape;\r\n  minDate?: CDS.CalendarDateShape;\r\n  month: number;\r\n  top: number;\r\n  year: number;\r\n  onMonthSelect: (month: number) => void;\r\n  onYearSelect: (month: number) => void;\r\n  monthSelectRef: (select: DateSelect | null) => void;\r\n  yearSelectRef: (select: DateSelect | null) => void;\r\n}\r\n\r\nexport function MonthView(props: MonthViewProps) {\r\n  const theme = useContext(ThemeContext);\r\n\r\n  const {\r\n    children,\r\n    height,\r\n    isFirstInYear,\r\n    isLastInYear,\r\n    maxDate,\r\n    minDate,\r\n    month,\r\n    top,\r\n    year,\r\n    onMonthSelect,\r\n    onYearSelect,\r\n    monthSelectRef,\r\n    yearSelectRef,\r\n  } = props;\r\n\r\n  const isTopNegative = top <= 0;\r\n  const isHeaderSticky = isTopNegative && height >= -top;\r\n  const headerTop = isHeaderSticky ? Math.min(-top, height - config.MONTH_TITLE_HEIGHT) : 0;\r\n  const alpha = isHeaderSticky ? (height + top - config.MONTH_TITLE_HEIGHT) / 10 : 1;\r\n  const borderBottomColor = ColorFunctions.fade(theme.calendarMonthTitleBorderBottomColor, alpha);\r\n  const isYearVisible = isFirstInYear || isHeaderSticky;\r\n  const yearTop = isHeaderSticky && !isLastInYear ? -headerTop - top : 0;\r\n  const monthSelectDisabled = top > 40 || headerTop < 0 || headerTop >= height - config.MONTH_TITLE_HEIGHT;\r\n  const yearSelectDisabled = top > 40 || (isLastInYear && top < -height + config.MONTH_TITLE_HEIGHT);\r\n\r\n  const getMinMonth = (value: number) => {\r\n    let min = 0;\r\n    for (let i = 0; i < 12; ++i) {\r\n      if (minDate && CDS.isGreaterOrEqual({ date: 31, month: i, year: value }, minDate)) {\r\n        min = i;\r\n        break;\r\n      }\r\n    }\r\n    return min;\r\n  };\r\n\r\n  const getMaxMonth = (value: number) => {\r\n    let max = 11;\r\n    for (let i = 11; i >= 0; --i) {\r\n      if (maxDate && CDS.isLessOrEqual({ date: 1, month: i, year: value }, maxDate)) {\r\n        max = i;\r\n        break;\r\n      }\r\n    }\r\n    return max;\r\n  };\r\n\r\n  return (\r\n    <div data-tid=\"MonthView__month\" className={jsStyles.month()} style={{ top }} key={month + '-' + year}>\r\n      <div\r\n        style={{ lineHeight: `${config.MONTH_TITLE_HEIGHT}px`, top: headerTop, borderBottomColor }}\r\n        className={cn({\r\n          [jsStyles.monthTitle(theme)]: true,\r\n          [jsStyles.headerSticky(theme)]: isHeaderSticky,\r\n        })}\r\n      >\r\n        <div data-tid=\"MonthView__headerMonth\" className={jsStyles.headerMonth()}>\r\n          <DateSelect\r\n            disabled={monthSelectDisabled}\r\n            width={85}\r\n            type=\"month\"\r\n            value={month}\r\n            onValueChange={onMonthSelect}\r\n            ref={!monthSelectDisabled ? monthSelectRef : undefined}\r\n            minValue={getMinMonth(year)}\r\n            maxValue={getMaxMonth(year)}\r\n          />\r\n        </div>\r\n        {isYearVisible && (\r\n          <div data-tid=\"MonthView__headerYear\" className={jsStyles.headerYear()} style={{ top: yearTop }}>\r\n            <DateSelect\r\n              disabled={yearSelectDisabled}\r\n              width={50}\r\n              type=\"year\"\r\n              value={year}\r\n              minValue={minDate ? minDate.year : undefined}\r\n              maxValue={maxDate ? maxDate.year : undefined}\r\n              onValueChange={onYearSelect}\r\n              ref={!yearSelectDisabled ? yearSelectRef : undefined}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n"]}