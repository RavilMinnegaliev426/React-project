{"version":3,"sources":["PasswordInput.tsx"],"names":["PasswordInput","state","visible","capsLockEnabled","input","focus","blur","handleBlur","handleKeyPress","e","props","onKeyPress","detectCapsLock","getModifierState","Codes","CapsLock","setState","handleKeydown","onKeyDown","handleToggleVisibility","prevState","handleFocus","renderEye","jsStyles","iconWrapper","capsLockDetector","toggleVisibility","refInput","element","UNSAFE_componentWillMount","isIE11","window","document","msCapsLockWarningOff","render","root","renderInput","inputProps","rightIcon","React","Component","__KONTUR_REACT_UI__","propTypes","PropTypes","bool","defaultProps","size"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { isKeyCapsLock } from '../../lib/events/keyboard/identifiers';\r\nimport { KeyboardEventCodes as Codes } from '../../lib/events/keyboard/KeyboardEventCodes';\r\nimport { Input, InputProps } from '../Input';\r\nimport { Nullable } from '../../typings/utility-types';\r\nimport { EyeClosedIcon, EyeOpenedIcon } from '../../internal/icons/16px';\r\nimport { isIE11 } from '../../lib/utils';\r\n\r\nimport { jsStyles } from './PasswordInput.styles';\r\n\r\nexport type PasswordInputProps = {\r\n  detectCapsLock?: boolean;\r\n} & InputProps;\r\n\r\nexport interface PasswordInputState {\r\n  visible: boolean;\r\n  capsLockEnabled?: boolean | null;\r\n}\r\n\r\n/**\r\n * Компонент для ввода пароля\r\n */\r\nexport class PasswordInput extends React.Component<PasswordInputProps, PasswordInputState> {\r\n  public static __KONTUR_REACT_UI__ = 'PasswordInput';\r\n\r\n  public static propTypes = {\r\n    /**\r\n     * Включает CapsLock детектор\r\n     */\r\n    detectCapsLock: PropTypes.bool,\r\n  };\r\n\r\n  public static defaultProps = {\r\n    size: 'small',\r\n  };\r\n\r\n  public state: PasswordInputState = {\r\n    visible: false,\r\n    capsLockEnabled: false,\r\n  };\r\n\r\n  private input: Nullable<Input>;\r\n\r\n  public UNSAFE_componentWillMount() {\r\n    if (this.props.detectCapsLock) {\r\n      this.setState({ capsLockEnabled: null });\r\n    }\r\n\r\n    // @ts-ignore\r\n    if (isIE11 && !window.document.msCapsLockWarningOff) {\r\n      // turns off default ie capslock warning\r\n      // @ts-ignore\r\n      window.document.msCapsLockWarningOff = true;\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    return <div className={jsStyles.root()}>{this.renderInput()}</div>;\r\n  }\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public focus = () => {\r\n    if (this.input) {\r\n      this.input.focus();\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public blur = () => {\r\n    this.handleBlur();\r\n  };\r\n\r\n  private handleKeyPress = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    const { onKeyPress, detectCapsLock } = this.props;\r\n\r\n    if (onKeyPress) {\r\n      onKeyPress(e);\r\n    }\r\n\r\n    if (!detectCapsLock) {\r\n      return;\r\n    }\r\n\r\n    const capsLockEnabled = e.getModifierState(Codes.CapsLock);\r\n\r\n    this.setState({ capsLockEnabled });\r\n  };\r\n\r\n  private handleKeydown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    const {\r\n      props: { detectCapsLock, onKeyDown },\r\n      state: { capsLockEnabled },\r\n    } = this;\r\n\r\n    if (onKeyDown) {\r\n      onKeyDown(e);\r\n    }\r\n\r\n    if (!detectCapsLock) {\r\n      return;\r\n    }\r\n\r\n    if (isKeyCapsLock(e) && capsLockEnabled != null) {\r\n      this.setState({ capsLockEnabled: !capsLockEnabled });\r\n    }\r\n  };\r\n\r\n  private handleToggleVisibility = () => {\r\n    this.setState(prevState => ({ visible: !prevState.visible }), this.handleFocus);\r\n  };\r\n\r\n  private handleFocus = () => {\r\n    if (this.input) {\r\n      this.input.focus();\r\n    }\r\n  };\r\n\r\n  private handleBlur = () => {\r\n    if (this.input) {\r\n      this.input.blur();\r\n    }\r\n  };\r\n\r\n  private renderEye = () => {\r\n    const { capsLockEnabled } = this.state;\r\n\r\n    return (\r\n      <span className={jsStyles.iconWrapper()}>\r\n        {capsLockEnabled && <span className={jsStyles.capsLockDetector()} />}\r\n        <span data-tid=\"PasswordInputEyeIcon\" className={jsStyles.toggleVisibility()} onClick={this.handleToggleVisibility}>\r\n          {this.state.visible ? <EyeOpenedIcon size={14} /> : <EyeClosedIcon size={14} />}\r\n        </span>\r\n      </span>\r\n    );\r\n  };\r\n\r\n  private refInput = (element: Input) => {\r\n    this.input = element;\r\n  };\r\n\r\n  private renderInput() {\r\n    const { detectCapsLock, ...props } = this.props;\r\n    const inputProps = {\r\n      ...props,\r\n      onKeyDown: this.handleKeydown,\r\n      onKeyPress: this.handleKeyPress,\r\n      rightIcon: this.renderEye(),\r\n    };\r\n    return <Input ref={this.refInput} type={this.state.visible ? 'text' : 'password'} {...inputProps} />;\r\n  }\r\n}\r\n"]}