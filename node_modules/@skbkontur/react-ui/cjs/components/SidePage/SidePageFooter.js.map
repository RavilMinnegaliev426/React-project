{"version":3,"sources":["SidePageFooter.tsx"],"names":["SidePageFooter","context","state","fixed","theme","content","wrapper","layoutSub","update","setProperStyles","refContent","node","refWrapper","wrapperRect","getBoundingClientRect","contentRect","top","setState","componentDidMount","footerRef","LayoutEvents","addListener","componentWillUnmount","remove","render","renderMain","height","getContentHeight","getWidth","jsStyles","footer","width","footerContent","panel","props","footerFixed","children","React","Component","__KONTUR_REACT_UI__","contextType","SidePageContext"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport cn from 'classnames';\r\n\r\nimport * as LayoutEvents from '../../lib/LayoutEvents';\r\nimport { ThemeContext } from '../../lib/theming/ThemeContext';\r\nimport { Theme } from '../../lib/theming/Theme';\r\n\r\nimport { jsStyles } from './SidePage.styles';\r\nimport { SidePageContext, SidePageContextType } from './SidePageContext';\r\n\r\nexport interface SidePageFooterProps {\r\n  children?: React.ReactNode | ((fixed: boolean) => React.ReactNode);\r\n  /**\r\n   * Включает серый цвет в футере\r\n   */\r\n  panel?: boolean;\r\n}\r\n\r\n/**\r\n * Футер сайдпейджа.\r\n *\r\n * @visibleName SidePage.Footer\r\n */\r\n\r\nexport class SidePageFooter extends React.Component<SidePageFooterProps> {\r\n  public static __KONTUR_REACT_UI__ = 'SidePageFooter';\r\n\r\n  public static contextType = SidePageContext;\r\n  public context: SidePageContextType = this.context;\r\n\r\n  public state = {\r\n    fixed: false,\r\n  };\r\n\r\n  private theme!: Theme;\r\n  private content: HTMLElement | null = null;\r\n  private wrapper: HTMLElement | null = null;\r\n  private layoutSub: ReturnType<typeof LayoutEvents.addListener> | null = null;\r\n\r\n  public componentDidMount() {\r\n    this.context.footerRef(this);\r\n    this.update();\r\n    this.layoutSub = LayoutEvents.addListener(this.update);\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this.context.footerRef(null);\r\n    if (this.layoutSub) {\r\n      this.layoutSub.remove();\r\n    }\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    return (\r\n      <ThemeContext.Consumer>\r\n        {theme => {\r\n          this.theme = theme;\r\n          return this.renderMain();\r\n        }}\r\n      </ThemeContext.Consumer>\r\n    );\r\n  }\r\n\r\n  public update = () => {\r\n    this.setProperStyles();\r\n  };\r\n\r\n  private renderMain() {\r\n    return (\r\n      <div style={{ height: this.getContentHeight() }} ref={this.refWrapper}>\r\n        <SidePageContext.Consumer>\r\n          {({ getWidth }) => (\r\n            <div\r\n              className={jsStyles.footer()}\r\n              style={{\r\n                width: getWidth(),\r\n              }}\r\n            >\r\n              <div\r\n                className={cn(jsStyles.footerContent(), {\r\n                  [jsStyles.panel(this.theme)]: !!this.props.panel,\r\n                  [jsStyles.footerFixed(this.theme)]: this.state.fixed,\r\n                })}\r\n                ref={this.refContent}\r\n              >\r\n                {this.props.children}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </SidePageContext.Consumer>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private refContent = (node: HTMLElement | null) => {\r\n    this.content = node;\r\n  };\r\n\r\n  private refWrapper = (node: HTMLElement | null) => {\r\n    this.wrapper = node;\r\n  };\r\n\r\n  private setProperStyles = () => {\r\n    if (this.wrapper && this.content) {\r\n      const wrapperRect = this.wrapper.getBoundingClientRect();\r\n      const contentRect = this.content.getBoundingClientRect();\r\n      const fixed = wrapperRect.top > contentRect.top;\r\n      this.setState({ fixed });\r\n    }\r\n  };\r\n\r\n  private getContentHeight() {\r\n    if (!this.content) {\r\n      return 'auto';\r\n    }\r\n    return this.content.getBoundingClientRect().height;\r\n  }\r\n}\r\n"]}