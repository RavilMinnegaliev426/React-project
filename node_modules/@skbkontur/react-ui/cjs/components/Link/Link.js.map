{"version":3,"sources":["Link.tsx"],"names":["Link","state","focusedByTab","theme","getProps","defaultProps","_handleFocus","event","props","disabled","process","nextTick","tabListener","isTabPressed","setState","_handleBlur","_handleClick","href","onClick","preventDefault","render","renderMain","icon","use","_button","_buttonOpened","className","style","relOrigin","rel","rest","iconElement","jsStyles","arrow","root","button","buttonOpened","focus","useDefault","useSuccess","useDanger","useGrayed","onFocus","onBlur","tabIndex","children","React","Component","__KONTUR_REACT_UI__","propTypes","PropTypes","bool","string","oneOfType","node","oneOf"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport cn from 'classnames';\r\n\r\nimport { createPropsGetter } from '../../lib/createPropsGetter';\r\nimport { Override } from '../../typings/utility-types';\r\nimport { tabListener } from '../../lib/events/tabListener';\r\nimport { Theme } from '../../lib/theming/Theme';\r\nimport { ThemeContext } from '../../lib/theming/ThemeContext';\r\nimport { isExternalLink } from '../../lib/utils';\r\n\r\nimport { jsStyles } from './Link.styles';\r\n\r\nexport type LinkProps = Override<\r\n  React.AnchorHTMLAttributes<HTMLAnchorElement>,\r\n  {\r\n    /** Неактивное состояние */\r\n    disabled?: boolean;\r\n    /** href */\r\n    href?: string;\r\n    /** Иконка */\r\n    icon?: React.ReactElement<any>;\r\n    /** Тип */\r\n    use?: 'default' | 'success' | 'danger' | 'grayed';\r\n    _button?: boolean;\r\n    _buttonOpened?: boolean;\r\n    tabIndex?: number;\r\n    /** onClick */\r\n    onClick?: (event?: React.MouseEvent<HTMLAnchorElement>) => void;\r\n  }\r\n>;\r\n\r\nexport interface LinkState {\r\n  focusedByTab: boolean;\r\n}\r\n\r\n/**\r\n * Стандартная ссылка.\r\n * Интерфес пропсов наследуется от `React.AnchorHTMLAttributes<HTMLAnchorElement>`.\r\n * Все свойства передаются в элемент `<a>`.\r\n * `className` и `style` не поддерживаются\r\n */\r\nexport class Link extends React.Component<LinkProps, LinkState> {\r\n  public static __KONTUR_REACT_UI__ = 'Link';\r\n\r\n  public static propTypes = {\r\n    disabled: PropTypes.bool,\r\n\r\n    href: PropTypes.string,\r\n\r\n    icon: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\r\n\r\n    use: PropTypes.oneOf(['default', 'success', 'danger', 'grayed']),\r\n  };\r\n\r\n  public static defaultProps = {\r\n    href: '',\r\n    use: 'default',\r\n  };\r\n\r\n  public state = {\r\n    focusedByTab: false,\r\n  };\r\n\r\n  private theme!: Theme;\r\n  private getProps = createPropsGetter(Link.defaultProps);\r\n\r\n  public render(): JSX.Element {\r\n    return (\r\n      <ThemeContext.Consumer>\r\n        {theme => {\r\n          this.theme = theme;\r\n          return this.renderMain();\r\n        }}\r\n      </ThemeContext.Consumer>\r\n    );\r\n  }\r\n\r\n  private renderMain() {\r\n    const {\r\n      disabled,\r\n      href,\r\n      icon,\r\n      use,\r\n      _button,\r\n      _buttonOpened,\r\n      className,\r\n      style,\r\n      rel: relOrigin,\r\n      ...rest\r\n    } = this.getProps<LinkProps, Link>();\r\n\r\n    let iconElement = null;\r\n    if (icon) {\r\n      iconElement = <span className={jsStyles.icon(this.theme)}>{icon}</span>;\r\n    }\r\n\r\n    let arrow = null;\r\n    if (_button) {\r\n      arrow = <span className={jsStyles.arrow()} />;\r\n    }\r\n\r\n    let rel = relOrigin;\r\n    if (typeof rel === 'undefined' && href) {\r\n      rel = `noopener${isExternalLink(href) ? ' noreferrer' : ''}`;\r\n    }\r\n\r\n    const props = {\r\n      className: cn({\r\n        [jsStyles.root(this.theme)]: true,\r\n        [jsStyles.disabled(this.theme)]: !!disabled,\r\n        [jsStyles.button()]: !!_button,\r\n        [jsStyles.buttonOpened()]: !!_buttonOpened,\r\n        [jsStyles.focus(this.theme)]: !disabled && this.state.focusedByTab,\r\n        [jsStyles.useDefault(this.theme)]: use === 'default',\r\n        [jsStyles.useSuccess(this.theme)]: use === 'success',\r\n        [jsStyles.useDanger(this.theme)]: use === 'danger',\r\n        [jsStyles.useGrayed(this.theme)]: use === 'grayed',\r\n      }),\r\n      href,\r\n      rel,\r\n      onClick: this._handleClick,\r\n      onFocus: this._handleFocus,\r\n      onBlur: this._handleBlur,\r\n      tabIndex: this.props.tabIndex,\r\n    };\r\n    if (disabled) {\r\n      props.tabIndex = -1;\r\n    }\r\n\r\n    return (\r\n      <a {...rest} {...props}>\r\n        {iconElement}\r\n        {this.props.children}\r\n        {arrow}\r\n      </a>\r\n    );\r\n  }\r\n\r\n  private _handleFocus = (event: React.FocusEvent<HTMLAnchorElement>) => {\r\n    if (!this.props.disabled) {\r\n      // focus event fires before keyDown eventlistener\r\n      // so we should check tabPressed in async way\r\n      process.nextTick(() => {\r\n        if (tabListener.isTabPressed) {\r\n          this.setState({ focusedByTab: true });\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  private _handleBlur = () => {\r\n    this.setState({ focusedByTab: false });\r\n  };\r\n\r\n  private _handleClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\r\n    const { href, onClick, disabled } = this.props;\r\n    if (!href) {\r\n      event.preventDefault();\r\n    }\r\n    if (onClick && !disabled) {\r\n      onClick(event);\r\n    }\r\n  };\r\n}\r\n"]}