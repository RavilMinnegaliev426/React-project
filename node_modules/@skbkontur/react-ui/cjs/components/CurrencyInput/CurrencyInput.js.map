{"version":3,"sources":["CurrencyInput.tsx"],"names":["CurrencyInput","state","getState","props","value","fractionDigits","hideTrailingZeros","focused","input","tempSelectionForOnChange","SelectionHelper","fromPosition","focus","blur","handleMouseUp","event","selection","getInputSelection","target","normilized","CurrencyInputHelper","normalizeSelection","formatted","setState","handleKeyDown","getSelection","onKeyDown","defaultPrevented","action","CURRENCY_INPUT_ACTIONS","Ignore","Unknown","preventDefault","Submit","onSubmit","Backspace","inputValue","moveCursor","end","Delete","start","MoveCursorLeft","MoveCursorRight","Home","End","length","ExtendSelectionLeft","extendSelection","ExtendSelectionRight","FullSelection","forward","ExtendSelectionToStart","backward","ExtendSelectionToEnd","inputEnd","direction","step","position","extended","result","safeInsert","integerDigits","unsigned","signed","parsedValue","CurrencyHelper","parse","onValueChange","blink","getOnChangeDelta","oldValue","substring","substr","handleValueChange","delta","handlePaste","data","clipboardData","getData","handleCopy","formatForClipboard","setData","handleCut","handleFocus","selectionStart","selectionEnd","selectionDirection","valueLenght","onFocus","handleBlur","onBlur","refInput","element","componentDidMount","maxLength","undefined","MAX_SAFE_DIGITS","UNSAFE_componentWillReceiveProps","nextProps","componentDidUpdate","setSelectionRange","render","rest","placeholder","format","onMouseEnter","onMouseLeave","onMouseOver","React","Component","__KONTUR_REACT_UI__","propTypes","align","PropTypes","oneOf","autoFocus","bool","borderless","disabled","error","number","leftIcon","string","size","warning","width","oneOfType","func","isRequired","defaultProps","HTMLInputElement","Error"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport warning from 'warning';\r\n\r\nimport { Input, InputProps } from '../Input';\r\nimport { Nullable, Override } from '../../typings/utility-types';\r\n\r\nimport { MAX_SAFE_DIGITS } from './constants';\r\nimport { Selection, SelectionDirection, SelectionHelper } from './SelectionHelper';\r\nimport { CurrencyHelper } from './CurrencyHelper';\r\nimport { CurrencyInputHelper } from './CurrencyInputHelper';\r\nimport { CURRENCY_INPUT_ACTIONS, extractAction } from './CurrencyInputKeyboardActions';\r\n\r\nexport type CurrencyInputProps = Override<\r\n  InputProps,\r\n  {\r\n    /** Значение */\r\n    value: Nullable<number>;\r\n    /** Убрать лишние нули после запятой */\r\n    hideTrailingZeros: boolean;\r\n    /** Кол-во цифр после зяпятой */\r\n    fractionDigits?: Nullable<number>;\r\n    /** Отрицательные значения */\r\n    signed?: boolean;\r\n    /**\r\n     * Допустимое кол-во цифр целой части.\r\n     * Если передан **0**, или `fractionDigits=15`, то и в целой части допускается только **0**.\r\n     */\r\n    integerDigits?: Nullable<number>;\r\n    /** Вызывается при изменении `value` */\r\n    onValueChange: (value: Nullable<number>) => void;\r\n    /** onSubmit */\r\n    onSubmit?: () => void;\r\n  }\r\n>;\r\n\r\nexport interface CurrencyInputState {\r\n  formatted: string;\r\n  selection: Selection;\r\n  focused: boolean;\r\n}\r\n\r\n/**\r\n * Поле для денежных сумм (и других числовых значений).\r\n * Принимает любые свойства `Input`.\r\n *\r\n * Максимальная длина числа - **15 цифр** (с десятичным разделителем в любом месте).\r\n * <br/>\r\n * Если `fractionDigits=15`, то в целой части допускается **0**.\r\n */\r\nexport class CurrencyInput extends React.Component<CurrencyInputProps, CurrencyInputState> {\r\n  public static __KONTUR_REACT_UI__ = 'CurrencyInput';\r\n\r\n  public static propTypes = {\r\n    align: PropTypes.oneOf(['left', 'center', 'right']),\r\n    autoFocus: PropTypes.bool,\r\n    borderless: PropTypes.bool,\r\n    disabled: PropTypes.bool,\r\n    error: PropTypes.bool,\r\n    fractionDigits: PropTypes.number,\r\n    hideTrailingZeros: PropTypes.bool,\r\n    leftIcon: PropTypes.element,\r\n    placeholder: PropTypes.string,\r\n    signed: PropTypes.bool,\r\n    size: PropTypes.oneOf(['small', 'medium', 'large']),\r\n    value: PropTypes.number,\r\n    warning: PropTypes.bool,\r\n    width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\r\n    onBlur: PropTypes.func,\r\n    onValueChange: PropTypes.func.isRequired,\r\n    onFocus: PropTypes.func,\r\n    onMouseEnter: PropTypes.func,\r\n    onMouseLeave: PropTypes.func,\r\n    onMouseOver: PropTypes.func,\r\n    onSubmit: PropTypes.func,\r\n  };\r\n\r\n  public static defaultProps = {\r\n    align: 'right',\r\n    fractionDigits: 2,\r\n    hideTrailingZeros: false,\r\n    value: null,\r\n  };\r\n\r\n  public state: CurrencyInputState = {\r\n    ...this.getState(this.props.value, this.props.fractionDigits, this.props.hideTrailingZeros),\r\n    focused: false,\r\n  };\r\n\r\n  private input: Nullable<Input>;\r\n  private tempSelectionForOnChange: Selection = SelectionHelper.fromPosition(0);\r\n\r\n  public componentDidMount(): void {\r\n    const { maxLength, integerDigits, fractionDigits } = this.props;\r\n    warning(\r\n      maxLength === undefined,\r\n      `[CurrencyInput]: Prop 'maxLength' has been deprecated. See 'integerDigits' and 'fractionDigits'`,\r\n    );\r\n    warning(\r\n      (integerDigits || 0) + (fractionDigits || 0) <= MAX_SAFE_DIGITS,\r\n      `[CurrencyInput]: Sum of 'integerDigits' and 'fractionDigits' exceeds ${MAX_SAFE_DIGITS}.` +\r\n        `\\nSee https://tech.skbkontur.ru/react-ui/#/CurrencyInput?id=why15`,\r\n    );\r\n  }\r\n\r\n  public UNSAFE_componentWillReceiveProps(nextProps: CurrencyInputProps) {\r\n    const { value, fractionDigits, hideTrailingZeros } = nextProps;\r\n    if (value !== CurrencyHelper.parse(this.state.formatted) || fractionDigits !== this.props.fractionDigits) {\r\n      const state = this.getState(value, fractionDigits, hideTrailingZeros);\r\n      this.setState(state);\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate() {\r\n    if (this.state.focused && this.input) {\r\n      const { start, end } = this.state.selection;\r\n\r\n      this.input.setSelectionRange(start, end);\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    const { fractionDigits, signed, onSubmit, integerDigits, hideTrailingZeros, ...rest } = this.props;\r\n    const placeholder =\r\n      this.props.placeholder == null\r\n        ? CurrencyHelper.format(0, {fractionDigits, hideTrailingZeros})\r\n        : this.props.placeholder;\r\n\r\n    return (\r\n      <Input\r\n        {...rest}\r\n        value={this.state.formatted}\r\n        onBlur={this.handleBlur}\r\n        onFocus={this.handleFocus}\r\n        onMouseUp={this.handleMouseUp}\r\n        onKeyDown={this.handleKeyDown}\r\n        onValueChange={this.handleValueChange}\r\n        onPaste={this.handlePaste}\r\n        onCopy={this.handleCopy}\r\n        onCut={this.handleCut}\r\n        onMouseEnter={this.props.onMouseEnter}\r\n        onMouseLeave={this.props.onMouseLeave}\r\n        onMouseOver={this.props.onMouseOver}\r\n        ref={this.refInput}\r\n        placeholder={this.state.focused ? '' : placeholder}\r\n      />\r\n    );\r\n  }\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public focus = () => {\r\n    if (this.input) {\r\n      this.input.focus();\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public blur = () => {\r\n    if (this.input) {\r\n      this.input.blur();\r\n    }\r\n  };\r\n\r\n  private getState(value: Nullable<number>, fractionDigits: Nullable<number>, hideTrailingZeros: boolean) {\r\n    return {\r\n      formatted: CurrencyHelper.format(value, { fractionDigits, hideTrailingZeros }),\r\n      selection: SelectionHelper.fromPosition(0),\r\n    };\r\n  }\r\n\r\n  private handleMouseUp = (event: React.MouseEvent<HTMLInputElement>) => {\r\n    const selection = getInputSelection(event.target);\r\n    const normilized = CurrencyInputHelper.normalizeSelection(this.state.formatted, selection);\r\n    this.setState({ selection: normilized });\r\n  };\r\n\r\n  private handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\r\n    const selection = this.getSelection(event.target);\r\n    this.tempSelectionForOnChange = selection;\r\n\r\n    if (this.props.onKeyDown) {\r\n      this.props.onKeyDown(event);\r\n      if (event.defaultPrevented) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    const action = extractAction(event);\r\n\r\n    if (action === CURRENCY_INPUT_ACTIONS.Ignore) {\r\n      return;\r\n    }\r\n\r\n    if (action !== CURRENCY_INPUT_ACTIONS.Unknown) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    switch (action) {\r\n      case CURRENCY_INPUT_ACTIONS.Submit: {\r\n        if (this.props.onSubmit) {\r\n          this.props.onSubmit();\r\n        }\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.Backspace: {\r\n        this.inputValue(CurrencyInputHelper.moveCursor(this.state.formatted, selection, -1), selection.end, '');\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.Delete: {\r\n        this.inputValue(selection.start, CurrencyInputHelper.moveCursor(this.state.formatted, selection, +1), '');\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.MoveCursorLeft: {\r\n        this.moveCursor(selection, -1);\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.MoveCursorRight: {\r\n        this.moveCursor(selection, +1);\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.Home: {\r\n        this.setState({ selection: SelectionHelper.fromPosition(0) });\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.End: {\r\n        const end = this.state.formatted.length;\r\n        this.setState({ selection: SelectionHelper.fromPosition(end) });\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.ExtendSelectionLeft: {\r\n        this.extendSelection(selection, -1);\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.ExtendSelectionRight: {\r\n        this.extendSelection(selection, +1);\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.FullSelection: {\r\n        this.setState({\r\n          selection: SelectionHelper.forward(0, this.state.formatted.length),\r\n        });\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.ExtendSelectionToStart: {\r\n        this.setState({\r\n          selection: SelectionHelper.backward(0, selection.start),\r\n        });\r\n        return;\r\n      }\r\n      case CURRENCY_INPUT_ACTIONS.ExtendSelectionToEnd: {\r\n        const inputEnd = this.state.formatted.length;\r\n        this.setState({\r\n          selection: SelectionHelper.forward(selection.start, inputEnd),\r\n        });\r\n        return;\r\n      }\r\n    }\r\n  };\r\n\r\n  private getSelection = (input: EventTarget): Selection => {\r\n    const selection = getInputSelection(input);\r\n    return {\r\n      start: selection.start,\r\n      end: selection.end,\r\n      direction: this.state.selection.direction,\r\n    };\r\n  };\r\n\r\n  private moveCursor = (selection: Selection, step: number) => {\r\n    const position = CurrencyInputHelper.moveCursor(this.state.formatted, selection, step);\r\n    this.setState({ selection: SelectionHelper.fromPosition(position) });\r\n  };\r\n\r\n  private extendSelection = (selection: Selection, step: number) => {\r\n    const extended = CurrencyInputHelper.extendSelection(this.state.formatted, selection, step);\r\n    this.setState({ selection: extended });\r\n  };\r\n\r\n  private inputValue = (start: number, end: number, value: string) => {\r\n    const result = CurrencyInputHelper.safeInsert(this.state.formatted, start, end, value, {\r\n      integerDigits: this.props.integerDigits,\r\n      fractionDigits: this.props.fractionDigits,\r\n      unsigned: !this.props.signed,\r\n    });\r\n    if (result) {\r\n      const formatted = result.value;\r\n      const selection = SelectionHelper.fromPosition(result.position);\r\n      this.setState({ formatted, selection }, () => {\r\n        const parsedValue = CurrencyHelper.parse(formatted);\r\n        if (this.props.value !== parsedValue) {\r\n          this.props.onValueChange(parsedValue);\r\n        }\r\n      });\r\n      return true;\r\n    }\r\n\r\n    if (this.input) {\r\n      this.input.blink();\r\n    }\r\n    return false;\r\n  };\r\n\r\n  private getOnChangeDelta = (value: string) => {\r\n    const selection = this.tempSelectionForOnChange;\r\n    const oldValue = this.state.formatted;\r\n    if (selection.start !== selection.end) {\r\n      return value.substring(selection.start, value.length - (oldValue.length - selection.end));\r\n    } else if (value.length > oldValue.length) {\r\n      return value.substr(selection.start, value.length - oldValue.length);\r\n    }\r\n    return null;\r\n  };\r\n\r\n  private handleValueChange = (value: string): void => {\r\n    const selection = this.tempSelectionForOnChange;\r\n    const delta = this.getOnChangeDelta(value);\r\n    if (delta != null && !this.inputValue(selection.start, selection.end, delta)) {\r\n      this.setState({ selection });\r\n    }\r\n  };\r\n\r\n  private handlePaste = (event: React.ClipboardEvent<HTMLInputElement>) => {\r\n    const data = event.clipboardData.getData('text');\r\n    const selection = this.getSelection(event.target);\r\n    this.inputValue(selection.start, selection.end, data);\r\n    event.preventDefault();\r\n  };\r\n\r\n  private handleCopy = (event: React.ClipboardEvent<HTMLInputElement>) => {\r\n    const selection = this.getSelection(event.target);\r\n    if (selection.start !== selection.end) {\r\n      const substring = this.state.formatted.substring(selection.start, selection.end);\r\n      const data = CurrencyHelper.formatForClipboard(substring);\r\n      event.clipboardData.setData('text', data);\r\n    }\r\n    event.preventDefault();\r\n  };\r\n\r\n  private handleCut = (event: React.ClipboardEvent<HTMLInputElement>) => {\r\n    const selection = this.getSelection(event.target);\r\n    if (selection.start !== selection.end) {\r\n      const substring = this.state.formatted.substring(selection.start, selection.end);\r\n      const data = CurrencyHelper.formatForClipboard(substring);\r\n      event.clipboardData.setData('text', data);\r\n      this.inputValue(selection.start, selection.end, '');\r\n    }\r\n    event.preventDefault();\r\n  };\r\n\r\n  private handleFocus = (event: React.FocusEvent<HTMLInputElement>) => {\r\n    const { selectionStart, selectionEnd, selectionDirection } = event.target;\r\n    const valueLenght = event.target.value.length;\r\n\r\n    const selection = {\r\n      start: selectionStart !== selectionEnd ? selectionStart || 0 : selectionStart || valueLenght,\r\n      end: selectionEnd !== selectionStart ? selectionEnd || 0 : selectionEnd || valueLenght,\r\n      direction: (selectionDirection as SelectionDirection) || 'none',\r\n    };\r\n\r\n    this.setState({\r\n      focused: true,\r\n      selection,\r\n    });\r\n\r\n    if (this.props.onFocus) {\r\n      this.props.onFocus(event);\r\n    }\r\n  };\r\n\r\n  private handleBlur = (event: React.FocusEvent<HTMLInputElement>) => {\r\n    const value = CurrencyHelper.parse(this.state.formatted);\r\n\r\n    this.setState({\r\n      ...this.getState(value, this.props.fractionDigits, this.props.hideTrailingZeros),\r\n      focused: false,\r\n    });\r\n\r\n    if (this.props.onBlur) {\r\n      this.props.onBlur(event);\r\n    }\r\n  };\r\n\r\n  private refInput = (element: Nullable<Input>) => {\r\n    this.input = element;\r\n  };\r\n}\r\n\r\nfunction getInputSelection(input: EventTarget): Selection {\r\n  if (!(input instanceof HTMLInputElement)) {\r\n    throw new Error('input is not HTMLInputElement');\r\n  }\r\n  return {\r\n    start: input.selectionStart!,\r\n    end: input.selectionEnd!,\r\n    direction: input.selectionDirection as SelectionDirection,\r\n  };\r\n}\r\n"]}