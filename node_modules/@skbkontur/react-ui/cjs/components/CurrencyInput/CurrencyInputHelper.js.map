{"version":3,"sources":["CurrencyInputHelper.tsx"],"names":["CurrencyInputHelper","moveCursor","value","selection","step","start","end","CursorHelper","calculatePosition","CurrencyHelper","getInfo","cursorMap","extendSelection","info","normalizeSelection","safeInsert","input","options","length","extracted","extractValid","insert","prefix","substring","suffix","combined","isValidString","raw","toRawPosition","info2","formattedPosition","toFormattedPosition","formatted","position"],"mappings":"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","sourcesContent":["import { Nullable } from '../../typings/utility-types';\r\n\r\nimport { Selection } from './SelectionHelper';\r\nimport { CurrencyHelper } from './CurrencyHelper';\r\nimport { CursorHelper } from './CursorHelper';\r\n\r\nexport interface DecimalOptions {\r\n  integerDigits?: Nullable<number>;\r\n  fractionDigits?: Nullable<number>;\r\n  unsigned?: boolean;\r\n}\r\n\r\nexport class CurrencyInputHelper {\r\n  public static moveCursor(value: string, selection: Selection, step: number): number {\r\n    return selection.start === selection.end\r\n      ? CursorHelper.calculatePosition(CurrencyHelper.getInfo(value).cursorMap, selection.start, step)\r\n      : step < 0\r\n      ? selection.start\r\n      : selection.end;\r\n  }\r\n\r\n  public static extendSelection(value: string, selection: Selection, step: number) {\r\n    const info = CurrencyHelper.getInfo(value);\r\n    return CursorHelper.extendSelection(info.cursorMap, selection, step);\r\n  }\r\n\r\n  public static normalizeSelection(value: string, selection: Selection): Selection {\r\n    const info = CurrencyHelper.getInfo(value);\r\n    return CursorHelper.normalizeSelection(info.cursorMap, selection);\r\n  }\r\n\r\n  public static safeInsert(value: string, start: number, end: number, input: string, options: DecimalOptions) {\r\n    if (input && start === 0 && end === value.length) {\r\n      const extracted = CurrencyHelper.extractValid(input, options);\r\n      if (!extracted) {\r\n        return null;\r\n      }\r\n      return CurrencyInputHelper.insert(value, start, end, extracted);\r\n    }\r\n\r\n    const prefix = value.substring(0, start);\r\n    const suffix = value.substring(end);\r\n\r\n    const combined = prefix + input + suffix;\r\n    if (CurrencyHelper.isValidString(combined, options)) {\r\n      return CurrencyInputHelper.insert(value, start, end, input);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  public static insert(value: string, start: number, end: number, input: string) {\r\n    const prefix = value.substring(0, start);\r\n    const suffix = value.substring(end);\r\n\r\n    const info = CurrencyHelper.getInfo(value);\r\n    const raw = CursorHelper.toRawPosition(info.cursorMap, start);\r\n    const info2 = CurrencyHelper.getInfo(prefix + input + suffix);\r\n    const formattedPosition = CursorHelper.toFormattedPosition(info2.cursorMap, raw + input.length);\r\n\r\n    return { value: info2.formatted, position: formattedPosition };\r\n  }\r\n}\r\n"]}