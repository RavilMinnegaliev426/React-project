{"version":3,"sources":["Tooltip.tsx"],"names":["POPUP_MARGIN","POPUP_PIN_OFFSET","Positions","Tooltip","state","opened","focused","theme","hoverTimeout","contentElement","positions","clickedOutside","renderContent","content","props","render","refContent","jsStyles","tooltipContent","renderCloseButton","node","open","setState","close","handleMouseEnter","event","isHoverAnchor","trigger","target","clearHoverTimeout","window","setTimeout","delay","handleMouseLeave","relatedTarget","handleClick","handleClickOutsideAnchor","isClickOutsideContent","onCloseRequest","handleFocus","handleBlur","handleCloseButtonClick","stopPropagation","onCloseClick","defaultPrevented","UNSAFE_componentWillReceiveProps","nextProps","allowedPositions","pos","posChanged","allowedChanged","componentWillUnmount","renderMain","hasCross","closeButton","undefined","triggersWithoutCloseButton","includes","cross","getProps","popupProps","layerProps","active","anchorElement","children","popup","renderPopup","disableAnimations","getPositions","onOpen","index","indexOf","Error","join","slice","useWrapper","onClickOutside","onMouseEnter","onMouseLeave","onClick","onFocus","onBlur","clearTimeout","Element","React","PureComponent","__KONTUR_REACT_UI__","propTypes","propName","componentName","Array","isArray","defaultProps","Boolean","process","env","enableReactTesting","closeOnChildrenMouseLeave"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport warning from 'warning';\r\nimport isEqual from 'lodash.isequal';\r\n\r\nimport { Popup, PopupPosition, PopupProps } from '../../internal/Popup';\r\nimport { RenderLayer, RenderLayerProps } from '../../internal/RenderLayer';\r\nimport { CrossIcon } from '../../internal/icons/CrossIcon';\r\nimport { Nullable } from '../../typings/utility-types';\r\nimport { MouseEventType } from '../../typings/event-types';\r\nimport { containsTargetOrRenderContainer } from '../../lib/listenFocusOutside';\r\nimport { ThemeContext } from '../../lib/theming/ThemeContext';\r\nimport { Theme } from '../../lib/theming/Theme';\r\n\r\nimport { jsStyles } from './Tooltip.styles';\r\n\r\nconst POPUP_MARGIN = 15;\r\nconst POPUP_PIN_OFFSET = 17;\r\n\r\nconst Positions: PopupPosition[] = [\r\n  'right bottom',\r\n  'right middle',\r\n  'right top',\r\n  'top right',\r\n  'top center',\r\n  'top left',\r\n  'left top',\r\n  'left middle',\r\n  'left bottom',\r\n  'bottom left',\r\n  'bottom center',\r\n  'bottom right',\r\n];\r\n\r\nexport type TooltipTrigger =\r\n  /** Наведение на children и на тултип */\r\n  | 'hover'\r\n  /** Клик на children */\r\n  | 'click'\r\n  /** Фокус на children */\r\n  | 'focus'\r\n  /** Наведение на children и на тултип и фокус на children */\r\n  | 'hover&focus'\r\n  /** Просто открыт */\r\n  | 'opened'\r\n  /** Просто закрыт */\r\n  | 'closed'\r\n  /** Наведение ТОЛЬКО на children, а не на тултип */\r\n  | 'hoverAnchor';\r\n\r\nexport interface TooltipProps {\r\n  /**\r\n   * Относительно какого элемента позиционировать тултип\r\n   */\r\n  anchorElement?: HTMLElement;\r\n\r\n  /**\r\n   * Если не указан `anchorElement` то тултип будет позиционироваться\r\n   * относительно дочерних элементов\r\n   */\r\n  children?: React.ReactNode;\r\n\r\n  className?: string;\r\n\r\n  /**\r\n   * Показывать крестик для закрытия тултипа. По-умолчанию крестик\r\n   * показывается если проп *trigger* не `hover` и не `focus`.\r\n   */\r\n  closeButton?: boolean;\r\n\r\n  /**\r\n   * Функция, которая возвращает содержимое тултипа.\r\n   *\r\n   * Если эта функция вернула `null`, то тултип не показывается.\r\n   */\r\n  render?: Nullable<() => React.ReactNode>;\r\n\r\n  pos: PopupPosition;\r\n\r\n  /**\r\n   * Триггер открытия тултипа\r\n   * ```ts\r\n   * type TooltipTrigger =\r\n   * | 'hover'\r\n   * | 'click'\r\n   * | 'focus'\r\n   * | 'hover&focus'\r\n   * | 'opened'\r\n   * | 'closed'\r\n   * | 'hoverAnchor';\r\n   * ```\r\n   */\r\n  trigger: TooltipTrigger;\r\n\r\n  /**\r\n   * Хэндлер, вызываемый при клике по крестику\r\n   */\r\n  onCloseClick?: React.MouseEventHandler<HTMLElement>;\r\n\r\n  /**\r\n   * Хэндлер, вызываемый при клике по крестику или\r\n   * снаружи тултипа\r\n   */\r\n  onCloseRequest?: () => void;\r\n\r\n  /**\r\n   * Хэндлер, вызываемый при открытии тултипа\r\n   */\r\n  onOpen?: () => void;\r\n\r\n  /**\r\n   * Список позиций, которые тултип будет занимать.\r\n   * Если положение тултипа в определенной позиции\r\n   * будет выходить за край экрана, то будет выбрана\r\n   * следующая позиция. Обязательно должен включать\r\n   * позицию указанную в `pos`\r\n   *\r\n   * ```ts\r\n   * type PopupPosition =\r\n   *   'right bottom',\r\n   * | 'right middle',\r\n   * | 'right top',\r\n   * | 'top right',\r\n   * | 'top center',\r\n   * | 'top left',\r\n   * | 'left top',\r\n   * | 'left middle',\r\n   * | 'left bottom',\r\n   * | 'bottom left',\r\n   * | 'bottom center',\r\n   * | 'bottom right'\r\n   * ```\r\n   */\r\n  allowedPositions: PopupPosition[];\r\n\r\n  /**\r\n   * Флаг отключения анимации.\r\n   * @default false\r\n   */\r\n  disableAnimations: boolean;\r\n\r\n  /**\r\n   * Использовать обертку над children в виде <span />\r\n   * @default true\r\n   */\r\n  useWrapper: boolean;\r\n}\r\n\r\nexport interface TooltipState {\r\n  opened: boolean;\r\n  focused: boolean;\r\n}\r\n\r\nexport class Tooltip extends React.PureComponent<TooltipProps, TooltipState> {\r\n  public static __KONTUR_REACT_UI__ = 'Tooltip';\r\n\r\n  public static propTypes = {\r\n    children(props: TooltipProps, propName: keyof TooltipProps, componentName: string) {\r\n      const children = props[propName];\r\n      warning(\r\n        children || props.anchorElement,\r\n        `[${componentName}]: you must provide either 'children' or 'anchorElement' prop for ${componentName} to work properly`,\r\n      );\r\n      warning(\r\n        !(Array.isArray(children) && props.useWrapper === false),\r\n        `[${componentName}]: you provided multiple children, but useWrapper={false} - forcing wrapper <span/> for positioning to work correctly`,\r\n      );\r\n    },\r\n  };\r\n\r\n  public static defaultProps = {\r\n    pos: 'top left',\r\n    trigger: 'hover',\r\n    allowedPositions: Positions,\r\n    disableAnimations: Boolean(process.env.enableReactTesting),\r\n    useWrapper: true,\r\n    closeOnChildrenMouseLeave: false,\r\n  };\r\n\r\n  public static delay = 100;\r\n  private static triggersWithoutCloseButton: TooltipTrigger[] = ['hover', 'hoverAnchor', 'focus', 'hover&focus'];\r\n\r\n  public state: TooltipState = { opened: false, focused: false };\r\n  private theme!: Theme;\r\n  private hoverTimeout: Nullable<number> = null;\r\n  private contentElement: Nullable<HTMLElement> = null;\r\n  private positions: Nullable<PopupPosition[]> = null;\r\n  private clickedOutside = true;\r\n\r\n  public UNSAFE_componentWillReceiveProps(nextProps: TooltipProps) {\r\n    if (nextProps.trigger === 'closed') {\r\n      this.close();\r\n    }\r\n\r\n    const { allowedPositions, pos } = this.props;\r\n    const posChanged = nextProps.pos !== pos;\r\n    const allowedChanged = !isEqual(nextProps.allowedPositions, allowedPositions);\r\n\r\n    if (posChanged || allowedChanged) {\r\n      this.positions = null;\r\n    }\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this.clearHoverTimeout();\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <ThemeContext.Consumer>\r\n        {theme => {\r\n          this.theme = theme;\r\n          return this.renderMain();\r\n        }}\r\n      </ThemeContext.Consumer>\r\n    );\r\n  }\r\n\r\n  public renderContent = () => {\r\n    const content = this.props.render ? this.props.render() : null;\r\n    if (content == null) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div ref={this.refContent} className={jsStyles.tooltipContent()}>\r\n        {content}\r\n        {this.renderCloseButton()}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  public renderCloseButton() {\r\n    const hasCross =\r\n      this.props.closeButton === undefined\r\n        ? !Tooltip.triggersWithoutCloseButton.includes(this.props.trigger)\r\n        : this.props.closeButton;\r\n\r\n    if (!hasCross) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div className={jsStyles.cross(this.theme)} onClick={this.handleCloseButtonClick}>\r\n        <CrossIcon />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderMain() {\r\n    const props = this.props;\r\n    const content = this.renderContent();\r\n    const { popupProps, layerProps = { active: false } } = this.getProps();\r\n    const anchorElement = props.children || props.anchorElement;\r\n    const popup = this.renderPopup(anchorElement, popupProps, content);\r\n\r\n    return <RenderLayer {...layerProps}>{popup}</RenderLayer>;\r\n  }\r\n\r\n  private renderPopup(\r\n    anchorElement: React.ReactNode | HTMLElement,\r\n    popupProps: Partial<PopupProps>,\r\n    content: JSX.Element | null,\r\n  ) {\r\n    return (\r\n      <Popup\r\n        anchorElement={anchorElement}\r\n        hasPin\r\n        hasShadow\r\n        margin={POPUP_MARGIN}\r\n        maxWidth=\"none\"\r\n        opened={this.state.opened}\r\n        pinOffset={POPUP_PIN_OFFSET}\r\n        disableAnimations={this.props.disableAnimations}\r\n        positions={this.getPositions()}\r\n        ignoreHover={this.props.trigger === 'hoverAnchor'}\r\n        onOpen={this.props.onOpen}\r\n        {...popupProps}\r\n      >\r\n        {content}\r\n      </Popup>\r\n    );\r\n  }\r\n\r\n  private refContent = (node: HTMLElement | null) => {\r\n    this.contentElement = node;\r\n  };\r\n\r\n  private getPositions() {\r\n    if (!this.positions) {\r\n      const allowedPositions = this.props.allowedPositions;\r\n      const index = allowedPositions.indexOf(this.props.pos);\r\n      if (index === -1) {\r\n        throw new Error('Unexpected position passed to Tooltip. Expected one of: ' + allowedPositions.join(', '));\r\n      }\r\n\r\n      this.positions = [...allowedPositions.slice(index), ...allowedPositions.slice(0, index)];\r\n    }\r\n\r\n    return this.positions;\r\n  }\r\n\r\n  private getProps(): {\r\n    layerProps?: Partial<RenderLayerProps>;\r\n    popupProps: Partial<PopupProps>;\r\n  } {\r\n    const props = this.props;\r\n    const useWrapper = !!props.children && props.useWrapper;\r\n    switch (props.trigger) {\r\n      case 'opened':\r\n        return {\r\n          layerProps: {\r\n            active: true,\r\n            onClickOutside: this.handleClickOutsideAnchor,\r\n          },\r\n          popupProps: {\r\n            opened: true,\r\n            useWrapper,\r\n          },\r\n        };\r\n\r\n      case 'closed':\r\n        return {\r\n          popupProps: {\r\n            opened: false,\r\n            useWrapper,\r\n          },\r\n        };\r\n\r\n      case 'hoverAnchor':\r\n      case 'hover':\r\n        return {\r\n          popupProps: {\r\n            onMouseEnter: this.handleMouseEnter,\r\n            onMouseLeave: this.handleMouseLeave,\r\n            useWrapper,\r\n          },\r\n        };\r\n\r\n      case 'click':\r\n        return {\r\n          layerProps: {\r\n            active: this.state.opened,\r\n            onClickOutside: this.handleClickOutsideAnchor,\r\n          },\r\n          popupProps: {\r\n            onClick: this.handleClick,\r\n            useWrapper,\r\n          },\r\n        };\r\n\r\n      case 'focus':\r\n        return {\r\n          popupProps: {\r\n            onFocus: this.handleFocus,\r\n            onBlur: this.handleBlur,\r\n            useWrapper,\r\n          },\r\n        };\r\n\r\n      case 'hover&focus':\r\n        return {\r\n          layerProps: {\r\n            active: this.state.opened,\r\n            onClickOutside: this.handleClickOutsideAnchor,\r\n          },\r\n          popupProps: {\r\n            onFocus: this.handleFocus,\r\n            onBlur: this.handleBlur,\r\n            onMouseEnter: this.handleMouseEnter,\r\n            onMouseLeave: this.handleMouseLeave,\r\n            useWrapper,\r\n          },\r\n        };\r\n\r\n      default:\r\n        throw new Error('Unknown trigger specified: ' + props.trigger);\r\n    }\r\n  }\r\n\r\n  private open = () => this.setState({ opened: true });\r\n\r\n  private close = () => this.setState({ opened: false });\r\n\r\n  private clearHoverTimeout() {\r\n    if (this.hoverTimeout) {\r\n      clearTimeout(this.hoverTimeout);\r\n      this.hoverTimeout = null;\r\n    }\r\n  }\r\n\r\n  private handleMouseEnter = (event: MouseEventType) => {\r\n    const isHoverAnchor = this.props.trigger === 'hoverAnchor';\r\n    if (isHoverAnchor && event.target === this.contentElement) {\r\n      return;\r\n    }\r\n\r\n    this.clearHoverTimeout();\r\n\r\n    this.hoverTimeout = window.setTimeout(this.open, Tooltip.delay);\r\n  };\r\n\r\n  private handleMouseLeave = (event: MouseEventType) => {\r\n    if (\r\n      (this.props.trigger === 'hover&focus' && this.state.focused) ||\r\n      (this.props.trigger === 'hover' && event.relatedTarget === this.contentElement)\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.clearHoverTimeout();\r\n\r\n    if (this.props.trigger === 'hoverAnchor') {\r\n      this.close();\r\n    } else {\r\n      this.hoverTimeout = window.setTimeout(this.close, Tooltip.delay);\r\n    }\r\n  };\r\n\r\n  private handleClick = () => {\r\n    this.open();\r\n  };\r\n\r\n  private handleClickOutsideAnchor = (event: Event) => {\r\n    this.clickedOutside = this.isClickOutsideContent(event);\r\n    if (this.clickedOutside) {\r\n      if (this.props.onCloseRequest) {\r\n        this.props.onCloseRequest();\r\n      }\r\n      this.close();\r\n    }\r\n  };\r\n\r\n  private isClickOutsideContent(event: Event) {\r\n    if (this.contentElement && event.target instanceof Element) {\r\n      return !containsTargetOrRenderContainer(event.target)(this.contentElement);\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  private handleFocus = () => {\r\n    this.setState({ focused: true });\r\n    this.open();\r\n  };\r\n\r\n  private handleBlur = () => {\r\n    if (this.props.trigger === 'hover&focus' && this.clickedOutside) {\r\n      this.close();\r\n    }\r\n\r\n    if (this.props.trigger === 'focus') {\r\n      this.close();\r\n    }\r\n\r\n    this.clickedOutside = true;\r\n    this.setState({ focused: false });\r\n  };\r\n\r\n  private handleCloseButtonClick = (event: React.MouseEvent<HTMLElement>) => {\r\n    event.stopPropagation();\r\n\r\n    if (this.props.onCloseClick) {\r\n      this.props.onCloseClick(event);\r\n    }\r\n\r\n    if (event.defaultPrevented) {\r\n      return;\r\n    }\r\n\r\n    if (this.props.onCloseRequest) {\r\n      this.props.onCloseRequest();\r\n    }\r\n\r\n    this.close();\r\n  };\r\n}\r\n"]}