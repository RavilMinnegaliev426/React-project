{"version":3,"sources":["ComboBoxMenu.tsx"],"names":["ComboBoxMenu","CustomComboBoxLocaleHelper","locale","renderItem","item","index","props","onValueChange","React","isValidElement","element","Object","assign","key","onClick","cloneElement","state","render","opened","items","totalCount","loading","refMenu","renderNotFound","notFound","renderTotalCount","maxMenuHeight","requestStatus","errorNetworkButton","errorNetworkMessage","renderAddButton","length","ComboBoxRequestStatus","Failed","maxWidth","whiteSpace","repeatRequest","total","fontSize","map","Component","__KONTUR_REACT_UI__","defaultProps","undefined","Unknown"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n\r\nimport { locale } from '../../lib/locale/decorators';\r\nimport { Menu } from '../Menu';\r\nimport { MenuItem, MenuItemState } from '../../components/MenuItem';\r\nimport { Spinner } from '../../components/Spinner';\r\nimport { Nullable } from '../../typings/utility-types';\r\nimport { MenuSeparator } from '../../components/MenuSeparator';\r\n\r\nimport { ComboBoxRequestStatus } from './CustomComboBoxTypes';\r\nimport { ComboBoxLocale, CustomComboBoxLocaleHelper } from './locale';\r\n\r\nexport interface ComboBoxMenuProps<T> {\r\n  opened?: boolean;\r\n  items?: Nullable<T[]>;\r\n  totalCount?: number;\r\n  loading?: boolean;\r\n  maxMenuHeight?: number | string;\r\n  refMenu?: (menu: Nullable<Menu>) => void;\r\n  renderNotFound?: () => React.ReactNode;\r\n  renderTotalCount?: (found: number, total: number) => React.ReactNode;\r\n  renderItem: (item: T, state: MenuItemState) => React.ReactNode;\r\n  onValueChange: (value: T) => any;\r\n  renderAddButton?: () => React.ReactNode;\r\n  caption?: React.ReactNode;\r\n  repeatRequest?: () => void;\r\n  requestStatus?: ComboBoxRequestStatus;\r\n}\r\n\r\n@locale('ComboBox', CustomComboBoxLocaleHelper)\r\nexport class ComboBoxMenu<T> extends Component<ComboBoxMenuProps<T>> {\r\n  public static __KONTUR_REACT_UI__ = 'ComboBoxMenu';\r\n\r\n  public static defaultProps = {\r\n    repeatRequest: () => undefined,\r\n    requestStatus: ComboBoxRequestStatus.Unknown,\r\n  };\r\n\r\n  private readonly locale!: ComboBoxLocale;\r\n\r\n  public render() {\r\n    const {\r\n      opened,\r\n      items,\r\n      totalCount,\r\n      loading,\r\n      refMenu,\r\n      renderNotFound = () => notFound,\r\n      renderTotalCount,\r\n      maxMenuHeight,\r\n      requestStatus,\r\n    } = this.props;\r\n\r\n    const { notFound, errorNetworkButton, errorNetworkMessage } = this.locale;\r\n\r\n    if (!opened) {\r\n      return null;\r\n    }\r\n\r\n    let renderAddButton = null;\r\n    if (this.props.renderAddButton) {\r\n      renderAddButton = this.props.renderAddButton();\r\n    }\r\n\r\n    if (loading && (!items || !items.length)) {\r\n      return (\r\n        <Menu ref={refMenu}>\r\n          <MenuItem disabled>\r\n            <Spinner type=\"mini\" dimmed />\r\n          </MenuItem>\r\n        </Menu>\r\n      );\r\n    }\r\n\r\n    if (items === null && requestStatus === ComboBoxRequestStatus.Failed) {\r\n      return (\r\n        <Menu ref={refMenu} maxHeight={maxMenuHeight}>\r\n          <MenuItem disabled key=\"message\">\r\n            <div style={{ maxWidth: 300, whiteSpace: 'normal' }}>{errorNetworkMessage}</div>\r\n          </MenuItem>\r\n          <MenuItem link onClick={this.props.repeatRequest} key=\"retry\">\r\n            {errorNetworkButton}\r\n          </MenuItem>\r\n        </Menu>\r\n      );\r\n    }\r\n\r\n    if ((items == null || items.length === 0) && renderNotFound) {\r\n      return (\r\n        <Menu ref={refMenu}>\r\n          {renderAddButton ? renderAddButton : <MenuItem disabled>{renderNotFound()}</MenuItem>}\r\n        </Menu>\r\n      );\r\n    }\r\n\r\n    let total = null;\r\n    if (items && renderTotalCount && totalCount && items.length < totalCount) {\r\n      total = (\r\n        <MenuItem disabled key=\"total\">\r\n          <div style={{ fontSize: 12 }}>{renderTotalCount(items.length, totalCount)}</div>\r\n        </MenuItem>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <Menu data-tid=\"ComboBoxMenu__items\" ref={refMenu} maxHeight={maxMenuHeight}>\r\n        {items && items.map(this.renderItem)}\r\n        {total}\r\n        {renderAddButton && [<MenuSeparator key=\"separator\" />, renderAddButton]}\r\n      </Menu>\r\n    );\r\n  }\r\n\r\n  private renderItem = (item: T, index: number): React.ReactNode => {\r\n    // NOTE this is undesireable feature, better\r\n    // to remove it from further versions\r\n    const { renderItem, onValueChange } = this.props;\r\n    if (typeof item === 'function' || React.isValidElement(item)) {\r\n      // @ts-ignore\r\n      const element = typeof item === 'function' ? item() : item;\r\n      const props = Object.assign(\r\n        {\r\n          key: index,\r\n          onClick: () => onValueChange(element.props),\r\n        },\r\n        element.props,\r\n      );\r\n      return React.cloneElement(element, props);\r\n    }\r\n\r\n    return (\r\n      <MenuItem data-tid=\"ComboBoxMenu__item\" onClick={() => onValueChange(item)} key={index}>\r\n        {state => renderItem(item, state)}\r\n      </MenuItem>\r\n    );\r\n  };\r\n}\r\n"]}