{"version":3,"sources":["MonthView.tsx"],"names":["MonthView","props","theme","ThemeContext","children","height","isFirstInYear","isLastInYear","maxDate","minDate","month","top","year","onMonthSelect","onYearSelect","monthSelectRef","yearSelectRef","isTopNegative","isHeaderSticky","headerTop","Math","min","config","MONTH_TITLE_HEIGHT","alpha","borderBottomColor","ColorFunctions","fade","calendarMonthTitleBorderBottomColor","isYearVisible","yearTop","monthSelectDisabled","yearSelectDisabled","getMinMonth","value","i","CDS","isGreaterOrEqual","date","getMaxMonth","max","isLessOrEqual","jsStyles","lineHeight","monthTitle","headerSticky","headerMonth","undefined","headerYear"],"mappings":"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","sourcesContent":["import React, { useContext } from 'react';\r\nimport cn from 'classnames';\r\n\r\nimport { DateSelect } from '../DateSelect';\r\nimport { ThemeContext } from '../../lib/theming/ThemeContext';\r\nimport * as ColorFunctions from '../../lib/styles/ColorFunctions';\r\n\r\nimport { jsStyles } from './MonthView.styles';\r\nimport { config } from './config';\r\nimport * as CDS from './CalendarDateShape';\r\n\r\ninterface MonthViewProps {\r\n  children: React.ReactNode;\r\n  firstDayOffset: number;\r\n  height: number;\r\n  isFirstInYear?: boolean;\r\n  isLastInYear?: boolean;\r\n  maxDate?: CDS.CalendarDateShape;\r\n  minDate?: CDS.CalendarDateShape;\r\n  month: number;\r\n  top: number;\r\n  year: number;\r\n  onMonthSelect: (month: number) => void;\r\n  onYearSelect: (month: number) => void;\r\n  monthSelectRef: (select: DateSelect | null) => void;\r\n  yearSelectRef: (select: DateSelect | null) => void;\r\n}\r\n\r\nexport function MonthView(props: MonthViewProps) {\r\n  const theme = useContext(ThemeContext);\r\n\r\n  const {\r\n    children,\r\n    height,\r\n    isFirstInYear,\r\n    isLastInYear,\r\n    maxDate,\r\n    minDate,\r\n    month,\r\n    top,\r\n    year,\r\n    onMonthSelect,\r\n    onYearSelect,\r\n    monthSelectRef,\r\n    yearSelectRef,\r\n  } = props;\r\n\r\n  const isTopNegative = top <= 0;\r\n  const isHeaderSticky = isTopNegative && height >= -top;\r\n  const headerTop = isHeaderSticky ? Math.min(-top, height - config.MONTH_TITLE_HEIGHT) : 0;\r\n  const alpha = isHeaderSticky ? (height + top - config.MONTH_TITLE_HEIGHT) / 10 : 1;\r\n  const borderBottomColor = ColorFunctions.fade(theme.calendarMonthTitleBorderBottomColor, alpha);\r\n  const isYearVisible = isFirstInYear || isHeaderSticky;\r\n  const yearTop = isHeaderSticky && !isLastInYear ? -headerTop - top : 0;\r\n  const monthSelectDisabled = top > 40 || headerTop < 0 || headerTop >= height - config.MONTH_TITLE_HEIGHT;\r\n  const yearSelectDisabled = top > 40 || (isLastInYear && top < -height + config.MONTH_TITLE_HEIGHT);\r\n\r\n  const getMinMonth = (value: number) => {\r\n    let min = 0;\r\n    for (let i = 0; i < 12; ++i) {\r\n      if (minDate && CDS.isGreaterOrEqual({ date: 31, month: i, year: value }, minDate)) {\r\n        min = i;\r\n        break;\r\n      }\r\n    }\r\n    return min;\r\n  };\r\n\r\n  const getMaxMonth = (value: number) => {\r\n    let max = 11;\r\n    for (let i = 11; i >= 0; --i) {\r\n      if (maxDate && CDS.isLessOrEqual({ date: 1, month: i, year: value }, maxDate)) {\r\n        max = i;\r\n        break;\r\n      }\r\n    }\r\n    return max;\r\n  };\r\n\r\n  return (\r\n    <div data-tid=\"MonthView__month\" className={jsStyles.month()} style={{ top }} key={month + '-' + year}>\r\n      <div\r\n        style={{ lineHeight: `${config.MONTH_TITLE_HEIGHT}px`, top: headerTop, borderBottomColor }}\r\n        className={cn({\r\n          [jsStyles.monthTitle(theme)]: true,\r\n          [jsStyles.headerSticky(theme)]: isHeaderSticky,\r\n        })}\r\n      >\r\n        <div data-tid=\"MonthView__headerMonth\" className={jsStyles.headerMonth()}>\r\n          <DateSelect\r\n            disabled={monthSelectDisabled}\r\n            width={85}\r\n            type=\"month\"\r\n            value={month}\r\n            onValueChange={onMonthSelect}\r\n            ref={!monthSelectDisabled ? monthSelectRef : undefined}\r\n            minValue={getMinMonth(year)}\r\n            maxValue={getMaxMonth(year)}\r\n          />\r\n        </div>\r\n        {isYearVisible && (\r\n          <div data-tid=\"MonthView__headerYear\" className={jsStyles.headerYear()} style={{ top: yearTop }}>\r\n            <DateSelect\r\n              disabled={yearSelectDisabled}\r\n              width={50}\r\n              type=\"year\"\r\n              value={year}\r\n              minValue={minDate ? minDate.year : undefined}\r\n              maxValue={maxDate ? maxDate.year : undefined}\r\n              onValueChange={onYearSelect}\r\n              ref={!yearSelectDisabled ? yearSelectRef : undefined}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n"]}