{"version":3,"sources":["InputLikeText.tsx"],"names":["InputLikeText","state","blinking","focused","theme","node","hiddenInput","lastSelectedInnerNode","frozen","frozenBlur","dragging","focusTimeout","blinkTimeout","selectInnerNode","start","end","setTimeout","clearInterval","window","isIE11","isEdge","focus","renderLeftIcon","renderIcon","props","leftIcon","jsInputStyles","renderRightIcon","rightIcon","icon","className","Function","useDefaultColor","renderPrefix","prefix","renderSuffix","suffix","renderLeftSide","sideContainer","renderRightSide","renderPlaceholder","children","placeholder","handleDocumentMouseDown","e","target","Node","contains","defrost","handleDocumentKeyDown","handleMouseDown","handleKeyDown","disabled","onKeyDown","handleMouseDragStart","document","documentElement","classList","add","jsStyles","userSelectNone","onMouseDragStart","handleMouseDragEnd","onMouseDragEnd","remove","handleFocus","body","setState","onFocus","handleBlur","stopPropagation","onBlur","hiddenInputRef","el","innerRef","getSizeClassName","size","sizeLarge","sizeLargeFallback","sizeMedium","sizeMediumFallback","sizeSmall","sizeSmallFallback","blur","blink","getNode","componentDidMount","MouseDrag","listen","addEventListener","componentWillUnmount","clearTimeout","stop","removeEventListener","render","renderMain","tabIndex","align","borderless","width","error","warning","onValueChange","value","rest","leftSide","rightSide","root","withoutLeftSide","focusFallback","warningFallback","errorFallback","wrapperClass","wrapper","userSelectContain","textAlign","undefined","input","React","Component","__KONTUR_REACT_UI__","defaultProps"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport cn from 'classnames';\r\n\r\nimport { isKeyTab, isShortcutPaste } from '../../lib/events/keyboard/identifiers';\r\nimport { MouseDrag, MouseDragEventHandler } from '../../lib/events/MouseDrag';\r\nimport { isEdge, isIE11 } from '../../lib/utils';\r\nimport { Nullable } from '../../typings/utility-types';\r\nimport { removeAllSelections, selectNodeContents } from '../../components/DateInput/helpers/SelectionHelpers';\r\nimport { InputProps, InputIconType, InputState } from '../../components/Input';\r\nimport { jsStyles as jsInputStyles } from '../../components/Input/Input.styles';\r\nimport { ThemeContext } from '../../lib/theming/ThemeContext';\r\nimport { Theme } from '../../lib/theming/Theme';\r\n\r\nimport { jsStyles } from './InputLikeText.styles';\r\nimport { HiddenInput } from './HiddenInput';\r\n\r\nexport interface InputLikeTextProps extends InputProps {\r\n  children?: React.ReactNode;\r\n  innerRef?: (el: HTMLElement | null) => void;\r\n  onFocus?: React.FocusEventHandler<HTMLElement>;\r\n  onBlur?: React.FocusEventHandler<HTMLElement>;\r\n  onMouseDragStart?: MouseDragEventHandler;\r\n  onMouseDragEnd?: MouseDragEventHandler;\r\n}\r\n\r\nexport type InputLikeTextState = Omit<InputState, 'polyfillPlaceholder'>;\r\n\r\nexport class InputLikeText extends React.Component<InputLikeTextProps, InputLikeTextState> {\r\n  public static __KONTUR_REACT_UI__ = 'InputLikeText';\r\n\r\n  public static defaultProps = { size: 'small' };\r\n\r\n  public state = { blinking: false, focused: false };\r\n\r\n  private theme!: Theme;\r\n  private node: HTMLElement | null = null;\r\n  private hiddenInput: HTMLInputElement | null = null;\r\n  private lastSelectedInnerNode: [HTMLElement, number, number] | null = null;\r\n  private frozen = false;\r\n  private frozenBlur = false;\r\n  private dragging = false;\r\n  private focusTimeout: Nullable<number>;\r\n  private blinkTimeout: Nullable<number>;\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public focus() {\r\n    if (this.node) {\r\n      this.node.focus();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public blur() {\r\n    if (this.node) {\r\n      this.node.blur();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @public\r\n   */\r\n  public blink() {\r\n    if (this.props.disabled) {\r\n      return;\r\n    }\r\n    this.setState({ blinking: true }, () => {\r\n      this.blinkTimeout = window.setTimeout(() => this.setState({ blinking: false }), 150);\r\n    });\r\n  }\r\n\r\n  public getNode(): HTMLElement | null {\r\n    return this.node;\r\n  }\r\n\r\n  public selectInnerNode = (node: HTMLElement | null, start = 0, end = 1) => {\r\n    if (this.dragging || !node) {\r\n      return;\r\n    }\r\n    this.frozen = true;\r\n    this.frozenBlur = true;\r\n\r\n    this.lastSelectedInnerNode = [node, start, end];\r\n    setTimeout(() => selectNodeContents(node, start, end), 0);\r\n    if (this.focusTimeout) {\r\n      clearInterval(this.focusTimeout);\r\n    }\r\n    this.focusTimeout = window.setTimeout(() => (isIE11 || isEdge) && this.node && this.node.focus(), 0);\r\n  };\r\n\r\n  public componentDidMount() {\r\n    if (this.node) {\r\n      MouseDrag.listen(this.node)\r\n        .onMouseDragStart(this.handleMouseDragStart)\r\n        .onMouseDragEnd(this.handleMouseDragEnd);\r\n    }\r\n    document.addEventListener('mousedown', this.handleDocumentMouseDown);\r\n    document.addEventListener('keydown', this.handleDocumentKeyDown);\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    if (this.blinkTimeout) {\r\n      clearTimeout(this.blinkTimeout);\r\n    }\r\n    MouseDrag.stop(this.node);\r\n    document.removeEventListener('mousedown', this.handleDocumentMouseDown);\r\n    document.removeEventListener('keydown', this.handleDocumentKeyDown);\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <ThemeContext.Consumer>\r\n        {theme => {\r\n          this.theme = theme;\r\n          return this.renderMain();\r\n        }}\r\n      </ThemeContext.Consumer>\r\n    );\r\n  }\r\n\r\n  private renderMain() {\r\n    const {\r\n      innerRef,\r\n      tabIndex,\r\n      placeholder,\r\n      align,\r\n      borderless,\r\n      width,\r\n      children,\r\n      error,\r\n      warning,\r\n      onValueChange,\r\n      disabled,\r\n      prefix,\r\n      suffix,\r\n      leftIcon,\r\n      rightIcon,\r\n      value,\r\n      onMouseDragStart,\r\n      onMouseDragEnd,\r\n      ...rest\r\n    } = this.props;\r\n\r\n    const { focused, blinking } = this.state;\r\n\r\n    const leftSide = this.renderLeftSide();\r\n    const rightSide = this.renderRightSide();\r\n\r\n    const className = cn(jsStyles.root(), jsInputStyles.root(this.theme), this.getSizeClassName(), {\r\n      [jsInputStyles.borderless()]: !!borderless,\r\n      [jsStyles.withoutLeftSide()]: !leftSide,\r\n      [jsInputStyles.focus(this.theme)]: focused,\r\n      [jsInputStyles.blink(this.theme)]: blinking,\r\n      [jsInputStyles.warning(this.theme)]: !!warning,\r\n      [jsInputStyles.error(this.theme)]: !!error,\r\n      [jsInputStyles.disabled(this.theme)]: !!disabled,\r\n      [jsInputStyles.focusFallback(this.theme)]: focused && (isIE11 || isEdge),\r\n      [jsInputStyles.warningFallback(this.theme)]: !!warning && (isIE11 || isEdge),\r\n      [jsInputStyles.errorFallback(this.theme)]: !!error && (isIE11 || isEdge),\r\n    });\r\n\r\n    const wrapperClass = cn(jsInputStyles.wrapper(), {\r\n      [jsStyles.userSelectContain()]: focused,\r\n    });\r\n\r\n    return (\r\n      <span\r\n        {...rest}\r\n        className={className}\r\n        style={{ width, textAlign: align }}\r\n        tabIndex={disabled ? undefined : 0}\r\n        onFocus={this.handleFocus}\r\n        onBlur={this.handleBlur}\r\n        ref={this.innerRef}\r\n        onKeyDown={this.handleKeyDown}\r\n        onMouseDown={this.handleMouseDown}\r\n      >\r\n        <input type=\"hidden\" value={value} />\r\n        {leftSide}\r\n        <span className={wrapperClass}>\r\n          <span data-tid=\"InputLikeText__input\" className={cn(jsStyles.input(), jsInputStyles.input(this.theme))}>\r\n            {children}\r\n          </span>\r\n          {this.renderPlaceholder()}\r\n        </span>\r\n        {rightSide}\r\n        {isIE11 && focused && <HiddenInput nodeRef={this.hiddenInputRef} />}\r\n      </span>\r\n    );\r\n  }\r\n\r\n  private renderLeftIcon = () => {\r\n    return this.renderIcon(this.props.leftIcon, jsInputStyles.leftIcon());\r\n  };\r\n\r\n  private renderRightIcon = () => {\r\n    return this.renderIcon(this.props.rightIcon, jsInputStyles.rightIcon());\r\n  };\r\n\r\n  private renderIcon = (icon: InputIconType, className: string): JSX.Element | null => {\r\n    if (!icon) {\r\n      return null;\r\n    }\r\n\r\n    if (icon instanceof Function) {\r\n      return <span className={className}>{icon()}</span>;\r\n    }\r\n\r\n    return <span className={cn(className, jsInputStyles.useDefaultColor(this.theme))}>{icon}</span>;\r\n  };\r\n\r\n  private renderPrefix = (): JSX.Element | null => {\r\n    const { prefix } = this.props;\r\n\r\n    if (!prefix) {\r\n      return null;\r\n    }\r\n\r\n    return <span className={jsInputStyles.prefix(this.theme)}>{prefix}</span>;\r\n  };\r\n\r\n  private renderSuffix = (): JSX.Element | null => {\r\n    const { suffix } = this.props;\r\n\r\n    if (!suffix) {\r\n      return null;\r\n    }\r\n\r\n    return <span className={jsInputStyles.suffix(this.theme)}>{suffix}</span>;\r\n  };\r\n\r\n  private renderLeftSide = (): JSX.Element | null => {\r\n    const leftIcon = this.renderLeftIcon();\r\n    const prefix = this.renderPrefix();\r\n\r\n    if (!leftIcon && !prefix) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <span className={jsInputStyles.sideContainer()}>\r\n        {leftIcon}\r\n        {prefix}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  private renderRightSide = (): JSX.Element | null => {\r\n    const rightIcon = this.renderRightIcon();\r\n    const suffix = this.renderSuffix();\r\n\r\n    if (!rightIcon && !suffix) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <span className={jsInputStyles.sideContainer()}>\r\n        {rightIcon}\r\n        {suffix}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  private renderPlaceholder = (): JSX.Element | null => {\r\n    const { children, placeholder } = this.props;\r\n\r\n    if (!children && placeholder) {\r\n      return <span className={jsInputStyles.placeholder(this.theme)}>{placeholder}</span>;\r\n    }\r\n    return null;\r\n  };\r\n\r\n  private handleDocumentMouseDown = (e: MouseEvent) => {\r\n    if (this.state.focused && this.node && e.target instanceof Node && !this.node.contains(e.target)) {\r\n      this.defrost();\r\n    }\r\n  };\r\n\r\n  private handleDocumentKeyDown = (e: KeyboardEvent) => {\r\n    if (this.state.focused && isKeyTab(e)) {\r\n      this.defrost();\r\n    }\r\n  };\r\n\r\n  private handleMouseDown = (e: React.MouseEvent<HTMLElement>) => {\r\n    this.frozen = true;\r\n  };\r\n\r\n  private handleKeyDown = (e: React.KeyboardEvent<HTMLElement>) => {\r\n    if (this.props.disabled) {\r\n      return;\r\n    }\r\n\r\n    if (isIE11 && isShortcutPaste(e) && this.hiddenInput) {\r\n      this.frozen = true;\r\n      setTimeout(() => {\r\n        if (this.lastSelectedInnerNode) {\r\n          this.selectInnerNode(...this.lastSelectedInnerNode);\r\n        }\r\n        if (this.node) {\r\n          this.node.focus();\r\n        }\r\n      }, 0);\r\n\r\n      this.hiddenInput.focus();\r\n    }\r\n\r\n    if (this.props.onKeyDown) {\r\n      this.props.onKeyDown(e as React.KeyboardEvent<HTMLInputElement>);\r\n    }\r\n  };\r\n\r\n  private handleMouseDragStart: MouseDragEventHandler = e => {\r\n    this.dragging = true;\r\n    document.documentElement.classList.add(jsStyles.userSelectNone());\r\n\r\n    if (this.props.onMouseDragStart) {\r\n      this.props.onMouseDragStart(e);\r\n    }\r\n  };\r\n\r\n  private handleMouseDragEnd: MouseDragEventHandler = e => {\r\n    // Дожидаемся onMouseUp\r\n    setTimeout(() => {\r\n      this.dragging = false;\r\n\r\n      if (this.props.onMouseDragEnd) {\r\n        this.props.onMouseDragEnd(e);\r\n      }\r\n    }, 0);\r\n\r\n    document.documentElement.classList.remove(jsStyles.userSelectNone());\r\n  };\r\n\r\n  private handleFocus = (e: React.FocusEvent<HTMLElement>) => {\r\n    if (this.props.disabled) {\r\n      if (isIE11) {\r\n        selectNodeContents(document.body, 0, 0);\r\n      }\r\n      return;\r\n    }\r\n\r\n    if ((isIE11 || isEdge) && this.frozen) {\r\n      this.frozen = false;\r\n      if (this.state.focused) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    this.setState({ focused: true });\r\n\r\n    if (this.props.onFocus) {\r\n      this.props.onFocus(e);\r\n    }\r\n  };\r\n\r\n  private handleBlur = (e: React.FocusEvent<HTMLElement>) => {\r\n    if (this.props.disabled) {\r\n      e.stopPropagation();\r\n      return;\r\n    }\r\n\r\n    if ((isIE11 || isEdge) && this.frozenBlur) {\r\n      this.frozenBlur = false;\r\n      return;\r\n    }\r\n    if ((isIE11 || isEdge) && this.frozen) {\r\n      return;\r\n    }\r\n\r\n    removeAllSelections();\r\n\r\n    this.setState({ focused: false });\r\n\r\n    if (this.props.onBlur) {\r\n      this.props.onBlur(e);\r\n    }\r\n  };\r\n\r\n  private hiddenInputRef = (el: HTMLInputElement | null) => {\r\n    this.hiddenInput = el;\r\n  };\r\n\r\n  private innerRef = (el: HTMLElement | null) => {\r\n    if (this.props.innerRef) {\r\n      this.props.innerRef(el);\r\n    }\r\n    this.node = el;\r\n  };\r\n\r\n  private defrost = (): void => {\r\n    this.frozen = false;\r\n    this.frozenBlur = false;\r\n  };\r\n\r\n  private getSizeClassName = () => {\r\n    switch (this.props.size) {\r\n      case 'large':\r\n        return {\r\n          [jsInputStyles.sizeLarge(this.theme)]: true,\r\n          [jsInputStyles.sizeLargeFallback(this.theme)]: isIE11 || isEdge,\r\n        };\r\n      case 'medium':\r\n        return {\r\n          [jsInputStyles.sizeMedium(this.theme)]: true,\r\n          [jsInputStyles.sizeMediumFallback(this.theme)]: isIE11 || isEdge,\r\n        };\r\n      case 'small':\r\n      default:\r\n        return {\r\n          [jsInputStyles.sizeSmall(this.theme)]: true,\r\n          [jsInputStyles.sizeSmallFallback(this.theme)]: isIE11 || isEdge,\r\n        };\r\n    }\r\n  };\r\n}\r\n"]}