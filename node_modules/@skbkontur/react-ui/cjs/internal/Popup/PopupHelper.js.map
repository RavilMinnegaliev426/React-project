{"version":3,"sources":["PopupHelper.tsx"],"names":["getPositionObject","position","x","split","direction","align","getElementAbsoluteRect","element","rect","_getElementRelativeRect","convertRectToAbsolute","isAbsoluteRectFullyVisible","coordinates","popupRect","windowRelativeRect","_getWindowRelativeRect","windowAbsoluteRect","absoluteRect","top","left","height","width","_rectContainsRect","canBecomeFullyVisible","positionName","availableScrollDistances","getBoundingClientRect","right","bottom","_getViewProperty","clientWidth","window","innerWidth","clientHeight","innerHeight","offset","_getAbsoluteOffset","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","outerRect","innerRect","getProperty","views","document","documentElement","body","map","find","Boolean","PopupHelper","isFullyVisible"],"mappings":"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","sourcesContent":["import { PopupPosition } from './Popup';\r\n\r\nexport interface Rect {\r\n  top: number;\r\n  left: number;\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nexport interface Offset {\r\n  top: number;\r\n  left: number;\r\n}\r\n\r\nexport interface PositionObject {\r\n  direction: string;\r\n  align: string;\r\n}\r\n\r\nfunction getPositionObject(position: string): PositionObject {\r\n  const x = position.split(' ');\r\n\r\n  return {\r\n    direction: x[0],\r\n    align: x[1],\r\n  };\r\n}\r\n\r\nfunction getElementAbsoluteRect(element: HTMLElement): Rect {\r\n  const rect = _getElementRelativeRect(element);\r\n  return convertRectToAbsolute(rect);\r\n}\r\n\r\nfunction isAbsoluteRectFullyVisible(coordinates: Offset, popupRect: Rect): boolean {\r\n  const windowRelativeRect = _getWindowRelativeRect();\r\n  const windowAbsoluteRect = convertRectToAbsolute(windowRelativeRect);\r\n  const absoluteRect = {\r\n    top: coordinates.top,\r\n    left: coordinates.left,\r\n    height: popupRect.height,\r\n    width: popupRect.width,\r\n  };\r\n\r\n  return _rectContainsRect(windowAbsoluteRect, absoluteRect);\r\n}\r\n\r\nfunction canBecomeFullyVisible(positionName: PopupPosition, coordinates: Offset) {\r\n  const position = getPositionObject(positionName);\r\n\r\n  if (position.direction === 'top') {\r\n    const availableScrollDistances = convertRectToAbsolute(_getWindowRelativeRect());\r\n    return coordinates.top + availableScrollDistances.top >= 0;\r\n  }\r\n\r\n  if (position.direction === 'left') {\r\n    const availableScrollDistances = convertRectToAbsolute(_getWindowRelativeRect());\r\n    return coordinates.left + availableScrollDistances.left >= 0;\r\n  }\r\n\r\n  // NOTE: for bottom/right cases browser will always expand document size\r\n  return true;\r\n}\r\n\r\nfunction _getElementRelativeRect(element: HTMLElement) {\r\n  const rect = element.getBoundingClientRect();\r\n\r\n  return {\r\n    top: rect.top,\r\n    left: rect.left,\r\n    width: rect.right - rect.left,\r\n    height: rect.bottom - rect.top,\r\n  };\r\n}\r\n\r\nfunction _getWindowRelativeRect(): Rect {\r\n  return {\r\n    top: 0,\r\n    left: 0,\r\n    width: _getViewProperty(x => x.clientWidth) || window.innerWidth,\r\n    height: _getViewProperty(x => x.clientHeight) || window.innerHeight,\r\n  };\r\n}\r\n\r\nfunction convertRectToAbsolute(rect: Rect): Rect {\r\n  const offset = _getAbsoluteOffset();\r\n\r\n  return {\r\n    top: rect.top + offset.top,\r\n    left: rect.left + offset.left,\r\n    width: rect.width,\r\n    height: rect.height,\r\n  };\r\n}\r\n\r\nfunction _getAbsoluteOffset(): Offset {\r\n  const scrollTop = window.pageYOffset || _getViewProperty(x => x.scrollTop);\r\n  const scrollLeft = window.pageXOffset || _getViewProperty(x => x.scrollLeft);\r\n\r\n  const clientTop = _getViewProperty(x => x.clientTop);\r\n  const clientLeft = _getViewProperty(x => x.clientLeft);\r\n\r\n  const top = scrollTop - clientTop;\r\n  const left = scrollLeft - clientLeft;\r\n\r\n  return {\r\n    top,\r\n    left,\r\n  };\r\n}\r\n\r\nfunction _rectContainsRect(outerRect: Rect, innerRect: Rect): boolean {\r\n  return (\r\n    innerRect.top > outerRect.top &&\r\n    innerRect.top + innerRect.height < outerRect.top + outerRect.height &&\r\n    innerRect.left > outerRect.left &&\r\n    innerRect.left + innerRect.width < outerRect.left + outerRect.width\r\n  );\r\n}\r\n\r\nfunction _getViewProperty(getProperty: (e: HTMLElement) => number): number {\r\n  const views = [document.documentElement, document.body];\r\n  return views.map(x => x && getProperty(x)).find(Boolean) || 0;\r\n}\r\n\r\nexport const PopupHelper = {\r\n  getPositionObject,\r\n  getElementAbsoluteRect,\r\n  isFullyVisible: isAbsoluteRectFullyVisible,\r\n  canBecomeFullyVisible,\r\n};\r\n"]}